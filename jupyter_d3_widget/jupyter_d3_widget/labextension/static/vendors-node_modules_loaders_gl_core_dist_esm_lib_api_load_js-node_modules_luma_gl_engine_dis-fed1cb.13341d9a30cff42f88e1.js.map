{"version":3,"file":"vendors-node_modules_loaders_gl_core_dist_esm_lib_api_load_js-node_modules_luma_gl_engine_dis-fed1cb.13341d9a30cff42f88e1.js","mappings":"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AIg4D,6CAAJ,CAASh4D,IAAT,EAAe9C,IAAf,CAAnB;AACD;AACF;;AACD,WAAO,KAAKgiD,KAAL,CAAWl/C,IAAX,CAAP;AACD;;AA7EwB;;;;;;;;;;;;;;;;;ACiBZ,SAASwM,iBAAT,GAAqC;AAClD,MAAIkH,SAAJ;;AAEA,MAAI,OAAO/I,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAACgJ,WAA5C,EAAyD;AACvDD,IAAAA,SAAS,GAAG/I,MAAM,CAACgJ,WAAP,CAAmBC,GAAnB,EAAZ;AACD,GAFD,MAEO,IAAI,OAAO3I,OAAP,KAAmB,WAAnB,IAAkCA,OAAO,CAAC6I,MAA9C,EAAsD;AAC3D,UAAMD,SAAS,GAAG5I,OAAO,CAAC6I,MAAR,EAAlB;AACAJ,IAAAA,SAAS,GAAGG,SAAS,CAAC,CAAD,CAAT,GAAe,IAAf,GAAsBA,SAAS,CAAC,CAAD,CAAT,GAAe,GAAjD;AACD,GAHM,MAGA;AACLH,IAAAA,SAAS,GAAGK,IAAI,CAACH,GAAL,EAAZ;AACD;;AAED,SAAOF,SAAP;AACD;;;;;;;;;;;ACjCD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,MAAM;AACN;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sCAAsC;;AAEtC;AACA;AACA;;AAEA,4BAA4B;AAC5B;AACA;AACA;AACA,6BAA6B","sources":["webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/iterators/make-iterator/make-array-buffer-iterator.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/iterators/make-iterator/make-blob-iterator.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/iterators/make-iterator/make-iterator.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/iterators/make-iterator/make-stream-iterator.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/iterators/make-iterator/make-string-iterator.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/javascript-utils/is-type.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/api/load.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/api/parse.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/api/register-loaders.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/api/select-loader.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/fetch/fetch-file.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/loader-utils/get-data.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/loader-utils/get-fetch-function.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/loader-utils/loader-context.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/loader-utils/loggers.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/loader-utils/normalize-loader.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/loader-utils/option-defaults.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/loader-utils/option-utils.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/utils/log.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/utils/mime-type-utils.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/utils/resource-utils.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/utils/response-utils.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/src/lib/utils/url-utils.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/env/src/lib/globals.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/env/src/lib/is-browser.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/env/src/lib/is-electron.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/env/src/utils/globals.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/log/src/log.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/log/src/utils/assert.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/log/src/utils/autobind.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/log/src/utils/color.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/log/src/utils/formatters.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/log/src/utils/hi-res-timestamp.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/core/node_modules/@probe.gl/log/src/utils/local-storage.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/binary-utils/array-buffer-utils.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/binary-utils/memory-conversion-utils.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/env-utils/assert.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/env-utils/globals.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/iterators/async-iteration.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/node/buffer.browser.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/path-utils/file-aliases.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/path-utils/get-cwd.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/path-utils/path.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/loader-utils/src/lib/worker-loader-utils/parse-with-worker.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/env-utils/assert.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/env-utils/globals.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/env-utils/version.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/node/worker_threads-browser.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/worker-api/get-worker-url.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/worker-api/validate-worker-version.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/worker-farm/worker-farm.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/worker-farm/worker-job.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/worker-farm/worker-pool.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/worker-farm/worker-thread.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/worker-utils/get-loadable-worker-url.ts","webpack://jupyter_d3_widget/./node_modules/@loaders.gl/worker-utils/src/lib/worker-utils/get-transfer-list.ts","webpack://jupyter_d3_widget/./node_modules/@luma.gl/engine/src/geometry/geometry.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/engine/src/lib/model-utils.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/engine/src/lib/model.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/engine/src/lib/program-manager.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/context/context.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/index.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/polyfill/get-parameter-polyfill.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/polyfill/polyfill-context.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/polyfill/polyfill-table.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/polyfill/polyfill-vertex-array-object.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/state-tracker/track-context-state.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/state-tracker/unified-parameter-api.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/state-tracker/webgl-parameter-tables.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/utils/assert.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/utils/device-pixels.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/utils/log.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/utils/utils.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/gltools/src/utils/webgl-checks.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/lib/assemble-shaders.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/lib/constants.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/lib/filters/prop-types.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/lib/inject-shader.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/lib/platform-defines.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/lib/resolve-modules.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/lib/shader-module.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/lib/transpile-shader.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/modules/module-injectors.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/utils/assert.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/utils/is-old-ie.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/shadertools/src/utils/webgl-info.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/accessor.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/buffer.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/clear.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/copy-and-blit.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/framebuffer.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/program-configuration.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/program.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/renderbuffer-formats.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/renderbuffer.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/resource.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/shader.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/texture-2d.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/texture-3d.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/texture-cube.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/texture-formats.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/texture.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/transform-feedback.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/uniforms.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/vertex-array-object.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/classes/vertex-array.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/debug/debug-program-configuration.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/debug/debug-uniforms.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/debug/debug-vertex-array.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/features/features.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/features/webgl-features-table.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/glsl-utils/format-glsl-error.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/glsl-utils/get-shader-name.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/glsl-utils/get-shader-type-name.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/init.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/utils/array-utils-flat.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/utils/assert.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/utils/check-props.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/utils/format-value.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/utils/load-file.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/utils/stub-methods.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/utils/utils.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/webgl-utils/attribute-utils.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/webgl-utils/constants-to-keys.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/webgl-utils/format-utils.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/webgl-utils/texture-utils.js","webpack://jupyter_d3_widget/./node_modules/@luma.gl/webgl/src/webgl-utils/typed-array-utils.js","webpack://jupyter_d3_widget/./node_modules/@math.gl/core/src/lib/assert.ts","webpack://jupyter_d3_widget/./node_modules/@math.gl/core/src/lib/common.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/env/src/lib/get-browser.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/env/src/lib/globals.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/env/src/lib/is-browser.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/env/src/lib/is-electron.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/env/src/utils/globals.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/log/src/log.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/log/src/utils/assert.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/log/src/utils/autobind.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/log/src/utils/color.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/log/src/utils/formatters.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/log/src/utils/hi-res-timestamp.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/log/src/utils/local-storage.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/stats/src/index.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/stats/src/lib/stat.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/stats/src/lib/stats.ts","webpack://jupyter_d3_widget/./node_modules/@probe.gl/stats/src/utils/hi-res-timestamp.ts","webpack://jupyter_d3_widget/./node_modules/process/browser.js"],"sourcesContent":["import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 256 * 1024;\n\n/**\n * Returns an iterator that breaks a big ArrayBuffer into chunks and yields them one-by-one\n * @param blob ArrayBuffer to iterate over\n * @param options\n * @param options.chunkSize\n */\nexport function* makeArrayBufferIterator(\n  arrayBuffer: ArrayBuffer,\n  options: IteratorOptions = {}\n): Iterable<ArrayBuffer> {\n  const {chunkSize = DEFAULT_CHUNK_SIZE} = options;\n\n  let byteOffset = 0;\n\n  while (byteOffset < arrayBuffer.byteLength) {\n    // Create a chunk of the right size\n    const chunkByteLength = Math.min(arrayBuffer.byteLength - byteOffset, chunkSize);\n    const chunk = new ArrayBuffer(chunkByteLength);\n\n    // Copy data from the big chunk\n    const sourceArray = new Uint8Array(arrayBuffer, byteOffset, chunkByteLength);\n    const chunkArray = new Uint8Array(chunk);\n    chunkArray.set(sourceArray);\n\n    // yield the chunk\n    byteOffset += chunkByteLength;\n    yield chunk;\n  }\n}\n","import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 1024 * 1024; // 1MB  biggest value that keeps UI responsive\n\n/**\n * Returns an iterator that breaks a big Blob into chunks and yields them one-by-one\n * @param blob Blob or File object\n * @param options\n * @param options.chunkSize\n */\nexport async function* makeBlobIterator(\n  blob: Blob,\n  options?: IteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  const chunkSize = options?.chunkSize || DEFAULT_CHUNK_SIZE;\n\n  let offset = 0;\n  while (offset < blob.size) {\n    const end = offset + chunkSize;\n\n    const chunk = await blob.slice(offset, end).arrayBuffer();\n\n    offset = end;\n    yield chunk;\n  }\n}\n","import type {ReadStream} from 'fs';\n\nimport {makeStringIterator} from './make-string-iterator';\nimport {makeArrayBufferIterator} from './make-array-buffer-iterator';\nimport {makeBlobIterator} from './make-blob-iterator';\nimport type {StreamIteratorOptions} from './make-stream-iterator';\nimport {makeStreamIterator} from './make-stream-iterator';\nimport {isBlob, isReadableStream, isResponse} from '../../javascript-utils/is-type';\n\n/**\n * @param [options.chunkSize]\n */\nexport type IteratorOptions = StreamIteratorOptions & {\n  chunkSize?: number;\n};\n\n/**\n * Returns an iterator that breaks its input into chunks and yields them one-by-one.\n * @param data\n * @param options\n * @returns\n * This function can e.g. be used to enable data sources that can only be read atomically\n * (such as `Blob` and `File` via `FileReader`) to still be parsed in batches.\n */\nexport function makeIterator(\n  data: ArrayBuffer | string | Blob | Response | ReadableStream | ReadStream,\n  options?: IteratorOptions\n): AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer> {\n  if (typeof data === 'string') {\n    // Note: Converts string chunks to binary\n    return makeStringIterator(data, options);\n  }\n  if (data instanceof ArrayBuffer) {\n    return makeArrayBufferIterator(data, options);\n  }\n  if (isBlob(data)) {\n    return makeBlobIterator(data as Blob, options);\n  }\n  if (isReadableStream(data)) {\n    return makeStreamIterator(data as ReadableStream, options);\n  }\n  if (isResponse(data)) {\n    const response = data as Response;\n    return makeStreamIterator(response.body as ReadableStream, options);\n  }\n  throw new Error('makeIterator');\n}\n","import type {Readable} from 'stream';\nimport {isBrowser, toArrayBuffer} from '@loaders.gl/loader-utils';\n\nexport type StreamIteratorOptions = {\n  _streamReadAhead?: boolean;\n};\n\n/**\n * Returns an async iterable that reads from a stream (works in both Node.js and browsers)\n * @param stream stream to iterator over\n */\nexport function makeStreamIterator(\n  stream: ReadableStream | Readable,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  return isBrowser\n    ? makeBrowserStreamIterator(stream as ReadableStream, options)\n    : makeNodeStreamIterator(stream as Readable, options);\n}\n\n/**\n * Returns an async iterable that reads from a DOM (browser) stream\n * @param stream stream to iterate from\n * @see https://jakearchibald.com/2017/async-iterators-and-generators/#making-streams-iterate\n */\nasync function* makeBrowserStreamIterator(\n  stream: ReadableStream,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  // WhatWG: stream is supposed to have a `getIterator` method\n  // if (typeof stream.getIterator === 'function') {\n  //   return stream.getIterator();\n  // }\n  // if (typeof stream[Symbol.asyncIterator] === 'function') {\n  //   return makeToArrayBufferIterator(stream);\n  // }\n\n  // In the browser, we first need to get a lock on the stream\n  const reader = stream.getReader();\n\n  let nextBatchPromise: Promise<{done?: boolean; value?: Uint8Array}> | undefined;\n\n  try {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      const currentBatchPromise = nextBatchPromise || reader.read();\n      // Issue a read for an additional batch, while we await the next batch\n      // Idea is to make fetching happen in parallel with processing / parsing\n      if (options?._streamReadAhead) {\n        nextBatchPromise = reader.read();\n      }\n      // Read from the stream\n      // value is a Uint8Array\n      const {done, value} = await currentBatchPromise;\n      // Exit if we're done\n      if (done) {\n        return;\n      }\n      // Else yield the chunk\n      yield toArrayBuffer(value);\n    }\n  } catch (error) {\n    // TODO - examples makes it look like this should always be called,\n    // but that generates exceptions so only call it if we do not reach the end\n    reader.releaseLock();\n  }\n}\n\n/**\n * Returns an async iterable that reads from a DOM (browser) stream\n * @param stream stream to iterate from\n * @note Requires Node.js >= 10\n */\nasync function* makeNodeStreamIterator(\n  stream: Readable,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  // Hacky test for node version to ensure we don't call bad polyfills\n  // NODE 10+: stream is an asyncIterator\n  for await (const chunk of stream) {\n    yield toArrayBuffer(chunk); // Coerce each chunk to ArrayBuffer\n  }\n}\n/* TODO - remove NODE < 10\n * @see https://github.com/bustle/streaming-iterables, MIT license\n *\n  if (typeof stream[Symbol.asyncIterator] === 'function') {\n    return;\n  }\n\n  // TODO - check if is this ever used in Node 10+?\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    const data = stream.read();\n    if (data !== null) {\n      yield toArrayBuffer(data);\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n    if (stream._readableState?.ended) {\n      return;\n    }\n    await onceReadable(stream);\n  }\n\nasync function onceReadable(stream: Readable): Promise<any> {\n  return new Promise((resolve) => {\n    stream.once('readable', resolve);\n  });\n}\n  */\n","import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 256 * 1024;\n\n/**\n * Returns an iterator that breaks a big string into chunks and yields them one-by-one as ArrayBuffers\n * @param blob string to iterate over\n * @param options\n * @param options.chunkSize\n */\nexport function* makeStringIterator(\n  string: string,\n  options?: IteratorOptions\n): Iterable<ArrayBuffer> {\n  const chunkSize = options?.chunkSize || DEFAULT_CHUNK_SIZE;\n\n  let offset = 0;\n  const textEncoder = new TextEncoder();\n  while (offset < string.length) {\n    // Create a chunk of the right size\n    const chunkLength = Math.min(string.length - offset, chunkSize);\n    const chunk = string.slice(offset, offset + chunkLength);\n    offset += chunkLength;\n\n    // yield an ArrayBuffer chunk\n    yield textEncoder.encode(chunk);\n  }\n}\n","import type {Readable} from 'stream';\n\n/** A DOM or Node readable stream */\nexport type ReadableStreamType = ReadableStream | Readable;\n\nconst isBoolean: (x: any) => boolean = (x) => typeof x === 'boolean';\nconst isFunction: (x: any) => boolean = (x) => typeof x === 'function';\n\nexport const isObject: (x: any) => boolean = (x) => x !== null && typeof x === 'object';\nexport const isPureObject: (x: any) => boolean = (x) =>\n  isObject(x) && x.constructor === {}.constructor;\nexport const isPromise: (x: any) => boolean = (x) => isObject(x) && isFunction(x.then);\n\nexport const isIterable: (x: any) => boolean = (x) => x && typeof x[Symbol.iterator] === 'function';\nexport const isAsyncIterable: (x: any) => boolean = (x) =>\n  x && typeof x[Symbol.asyncIterator] === 'function';\nexport const isIterator: (x: any) => boolean = (x) => x && isFunction(x.next);\n\nexport const isResponse: (x: any) => boolean = (x) =>\n  (typeof Response !== 'undefined' && x instanceof Response) ||\n  (x && x.arrayBuffer && x.text && x.json);\n\nexport const isFile: (x: any) => boolean = (x) => typeof File !== 'undefined' && x instanceof File;\nexport const isBlob: (x: any) => boolean = (x) => typeof Blob !== 'undefined' && x instanceof Blob;\n\n/** Check for Node.js `Buffer` without triggering bundler to include buffer polyfill */\nexport const isBuffer: (x: any) => boolean = (x) => x && typeof x === 'object' && x.isBuffer;\n\nexport const isWritableDOMStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.abort) && isFunction(x.getWriter);\n\nexport const isReadableDOMStream: (x: any) => boolean = (x) =>\n  (typeof ReadableStream !== 'undefined' && x instanceof ReadableStream) ||\n  (isObject(x) && isFunction(x.tee) && isFunction(x.cancel) && isFunction(x.getReader));\n// Not implemented in Firefox: && isFunction(x.pipeTo)\n\nexport const isWritableNodeStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.end) && isFunction(x.write) && isBoolean(x.writable);\nexport const isReadableNodeStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.read) && isFunction(x.pipe) && isBoolean(x.readable);\nexport const isReadableStream: (x: any) => boolean = (x) =>\n  isReadableDOMStream(x) || isReadableNodeStream(x);\nexport const isWritableStream: (x: any) => boolean = (x) =>\n  isWritableDOMStream(x) || isWritableNodeStream(x);\n","import type {DataType, Loader, LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isBlob} from '../../javascript-utils/is-type';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {getFetchFunction} from '../loader-utils/get-fetch-function';\n\nimport {parse} from './parse';\n\n/**\n * Parses `data` using a specified loader\n * Note: Load does duplicate a lot of parse.\n * it can also call fetchFile on string urls, which `parse` won't do.\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\n// implementation signature\nexport async function load(\n  url: string | DataType,\n  loaders?: Loader | Loader[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<any> {\n  // Signature: load(url, options)\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders as LoaderOptions;\n    loaders = undefined;\n  }\n\n  // Select fetch function\n  const fetch = getFetchFunction(options);\n\n  // at this point, `url` could be already loaded binary data\n  let data = url;\n  // url is a string, fetch the url\n  if (typeof url === 'string') {\n    data = await fetch(url);\n    // URL is Blob or File, fetchFile handles it (alt: we could generate ObjectURL here)\n  }\n\n  if (isBlob(url)) {\n    // The fetch response object will contain blob.name\n    // @ts-expect-error TODO - This may not work for overridden fetch functions\n    data = await fetch(url);\n  }\n\n  // Data is loaded (at least we have a `Response` object) so time to hand over to `parse`\n  return await parse(data, loaders as Loader[], options);\n}\n","import type {DataType, Loader, LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {assert, validateWorkerVersion} from '@loaders.gl/worker-utils';\nimport {parseWithWorker, canParseWithWorker} from '@loaders.gl/loader-utils';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {isResponse} from '../../javascript-utils/is-type';\nimport {normalizeOptions} from '../loader-utils/option-utils';\nimport {getArrayBufferOrStringFromData} from '../loader-utils/get-data';\nimport {getLoaderContext, getLoadersFromContext} from '../loader-utils/loader-context';\nimport {getResourceUrl} from '../utils/resource-utils';\nimport {selectLoader} from './select-loader';\n\n/**\n * Parses `data` using a specified loader\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\nexport async function parse(\n  data: DataType | Promise<DataType>,\n  loaders?: Loader | Loader[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<any> {\n  assert(!context || typeof context === 'object'); // parse no longer accepts final url\n\n  // Signature: parse(data, options, context | url)\n  // Uses registered loaders\n  if (loaders && !Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders as LoaderOptions;\n    loaders = undefined;\n  }\n\n  data = await data; // Resolve any promise\n  options = options || {};\n\n  // Extract a url for auto detection\n  const url = getResourceUrl(data);\n\n  // Chooses a loader (and normalizes it)\n  // Also use any loaders in the context, new loaders take priority\n  const typedLoaders = loaders as Loader | Loader[] | undefined;\n  const candidateLoaders = getLoadersFromContext(typedLoaders, context);\n  // todo hacky type cast\n  const loader = await selectLoader(data as ArrayBuffer, candidateLoaders, options);\n  // Note: if no loader was found, if so just return null\n  if (!loader) {\n    return null;\n  }\n\n  // Normalize options\n  options = normalizeOptions(options, loader, candidateLoaders, url);\n\n  // Get a context (if already present, will be unchanged)\n  context = getLoaderContext({url, parse, loaders: candidateLoaders}, options, context || null);\n\n  return await parseWithLoader(loader, data, options, context);\n}\n\n// TODO: support progress and abort\n// TODO - should accept loader.parseAsyncIterator and concatenate.\nasync function parseWithLoader(loader, data, options, context) {\n  validateWorkerVersion(loader);\n\n  if (isResponse(data)) {\n    // Serialize to support passing the response to web worker\n    const response = data as Response;\n    const {ok, redirected, status, statusText, type, url} = response;\n    const headers = Object.fromEntries(response.headers.entries());\n    context.response = {headers, ok, redirected, status, statusText, type, url};\n  }\n\n  data = await getArrayBufferOrStringFromData(data, loader, options);\n\n  // First check for synchronous text parser, wrap results in promises\n  if (loader.parseTextSync && typeof data === 'string') {\n    options.dataType = 'text';\n    return loader.parseTextSync(data, options, context, loader);\n  }\n\n  // If we have a workerUrl and the loader can parse the given options efficiently in a worker\n  if (canParseWithWorker(loader, options)) {\n    return await parseWithWorker(loader, data, options, context, parse);\n  }\n\n  // Check for asynchronous parser\n  if (loader.parseText && typeof data === 'string') {\n    return await loader.parseText(data, options, context, loader);\n  }\n\n  if (loader.parse) {\n    return await loader.parse(data, options, context, loader);\n  }\n\n  // This should not happen, all sync loaders should also offer `parse` function\n  assert(!loader.parseSync);\n\n  // TBD - If asynchronous parser not available, return null\n  throw new Error(`${loader.id} loader - no parser found and worker is disabled`);\n}\n","import {Loader} from '@loaders.gl/loader-utils';\nimport {normalizeLoader} from '../loader-utils/normalize-loader';\nimport {getGlobalLoaderState} from '../loader-utils/option-utils';\n\n// Store global registered loaders on the global object to increase chances of cross loaders-version interoperability\n// This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\nconst getGlobalLoaderRegistry = () => {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = state.loaderRegistry || [];\n  return state.loaderRegistry;\n};\n\n/** Register a list of global loaders */\nexport function registerLoaders(loaders: Loader[] | Loader) {\n  const loaderRegistry = getGlobalLoaderRegistry();\n\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n\n  for (const loader of loaders) {\n    const normalizedLoader = normalizeLoader(loader);\n    if (!loaderRegistry.find((registeredLoader) => normalizedLoader === registeredLoader)) {\n      // add to the beginning of the loaderRegistry, so the last registeredLoader get picked\n      loaderRegistry.unshift(normalizedLoader);\n    }\n  }\n}\n\nexport function getRegisteredLoaders(): Loader[] {\n  return getGlobalLoaderRegistry();\n}\n\n/** @deprecated For testing only  */\nexport function _unregisterLoaders() {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = [];\n}\n","import type {LoaderContext, LoaderOptions, Loader} from '@loaders.gl/loader-utils';\nimport {compareArrayBuffers, path} from '@loaders.gl/loader-utils';\nimport {normalizeLoader} from '../loader-utils/normalize-loader';\nimport {log} from '../utils/log';\nimport {getResourceUrl, getResourceMIMEType} from '../utils/resource-utils';\nimport {getRegisteredLoaders} from './register-loaders';\nimport {isBlob} from '../../javascript-utils/is-type';\nimport {stripQueryString} from '../utils/url-utils';\n\nconst EXT_PATTERN = /\\.([^.]+)$/;\n\n// TODO - Need a variant that peeks at streams for parseInBatches\n// TODO - Detect multiple matching loaders? Use heuristics to grade matches?\n// TODO - Allow apps to pass context to disambiguate between multiple matches (e.g. multiple .json formats)?\n\n/**\n * Find a loader that matches file extension and/or initial file content\n * Search the loaders array argument for a loader that matches url extension or initial data\n * Returns: a normalized loader\n * @param data data to assist\n * @param loaders\n * @param options\n * @param context used internally, applications should not provide this parameter\n */\nexport async function selectLoader(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[] | Loader = [],\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<Loader | null> {\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  // First make a sync attempt, disabling exceptions\n  let loader = selectLoaderSync(data, loaders, {...options, nothrow: true}, context);\n  if (loader) {\n    return loader;\n  }\n\n  // For Blobs and Files, try to asynchronously read a small initial slice and test again with that\n  // to see if we can detect by initial content\n  if (isBlob(data)) {\n    data = await (data as Blob).slice(0, 10).arrayBuffer();\n    loader = selectLoaderSync(data, loaders, options, context);\n  }\n\n  // no loader available\n  if (!loader && !options?.nothrow) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n\n  return loader;\n}\n\n/**\n * Find a loader that matches file extension and/or initial file content\n * Search the loaders array argument for a loader that matches url extension or initial data\n * Returns: a normalized loader\n * @param data data to assist\n * @param loaders\n * @param options\n * @param context used internally, applications should not provide this parameter\n */\nexport function selectLoaderSync(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[] | Loader = [],\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Loader | null {\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  // eslint-disable-next-line complexity\n  // if only a single loader was provided (not as array), force its use\n  // TODO - Should this behavior be kept and documented?\n  if (loaders && !Array.isArray(loaders)) {\n    // TODO - remove support for legacy loaders\n    return normalizeLoader(loaders);\n  }\n\n  // Build list of candidate loaders that will be searched in order for a match\n  let candidateLoaders: Loader[] = [];\n  // First search supplied loaders\n  if (loaders) {\n    candidateLoaders = candidateLoaders.concat(loaders);\n  }\n  // Then fall back to registered loaders\n  if (!options?.ignoreRegisteredLoaders) {\n    candidateLoaders.push(...getRegisteredLoaders());\n  }\n\n  // TODO - remove support for legacy loaders\n  normalizeLoaders(candidateLoaders);\n\n  const loader = selectLoaderInternal(data, candidateLoaders, options, context);\n\n  // no loader available\n  if (!loader && !options?.nothrow) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n\n  return loader;\n}\n\n/** Implements loaders selection logic */\n// eslint-disable-next-line complexity\nfunction selectLoaderInternal(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[],\n  options?: LoaderOptions,\n  context?: LoaderContext\n) {\n  const url = getResourceUrl(data);\n  const type = getResourceMIMEType(data);\n\n  const testUrl = stripQueryString(url) || context?.url;\n\n  let loader: Loader | null = null;\n  let reason: string = '';\n\n  // if options.mimeType is supplied, it takes precedence\n  if (options?.mimeType) {\n    loader = findLoaderByMIMEType(loaders, options?.mimeType);\n    reason = `match forced by supplied MIME type ${options?.mimeType}`;\n  }\n\n  // Look up loader by url\n  loader = loader || findLoaderByUrl(loaders, testUrl);\n  reason = reason || (loader ? `matched url ${testUrl}` : '');\n\n  // Look up loader by mime type\n  loader = loader || findLoaderByMIMEType(loaders, type);\n  reason = reason || (loader ? `matched MIME type ${type}` : '');\n\n  // Look for loader via initial bytes (Note: not always accessible (e.g. Response, stream, async iterator)\n  loader = loader || findLoaderByInitialBytes(loaders, data);\n  reason = reason || (loader ? `matched initial data ${getFirstCharacters(data)}` : '');\n\n  // Look up loader by fallback mime type\n  loader = loader || findLoaderByMIMEType(loaders, options?.fallbackMimeType);\n  reason = reason || (loader ? `matched fallback MIME type ${type}` : '');\n\n  if (reason) {\n    log.log(1, `selectLoader selected ${loader?.name}: ${reason}.`);\n  }\n\n  return loader;\n}\n\n/** Check HTTP Response */\nfunction validHTTPResponse(data: any): boolean {\n  // HANDLE HTTP status\n  if (data instanceof Response) {\n    // 204 - NO CONTENT. This handles cases where e.g. a tile server responds with 204 for a missing tile\n    if (data.status === 204) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/** Generate a helpful message to help explain why loader selection failed. */\nfunction getNoValidLoaderMessage(data): string {\n  const url = getResourceUrl(data);\n  const type = getResourceMIMEType(data);\n\n  let message = 'No valid loader found (';\n  message += url ? `${path.filename(url)}, ` : 'no url provided, ';\n  message += `MIME type: ${type ? `\"${type}\"` : 'not provided'}, `;\n  // First characters are only accessible when called on data (string or arrayBuffer).\n  const firstCharacters: string = data ? getFirstCharacters(data) : '';\n  message += firstCharacters ? ` first bytes: \"${firstCharacters}\"` : 'first bytes: not available';\n  message += ')';\n  return message;\n}\n\nfunction normalizeLoaders(loaders: Loader[]): void {\n  for (const loader of loaders) {\n    normalizeLoader(loader);\n  }\n}\n\n// TODO - Would be nice to support http://example.com/file.glb?parameter=1\n// E.g: x = new URL('http://example.com/file.glb?load=1'; x.pathname\nfunction findLoaderByUrl(loaders: Loader[], url?: string): Loader | null {\n  // Get extension\n  const match = url && EXT_PATTERN.exec(url);\n  const extension = match && match[1];\n  return extension ? findLoaderByExtension(loaders, extension) : null;\n}\n\nfunction findLoaderByExtension(loaders: Loader[], extension: string): Loader | null {\n  extension = extension.toLowerCase();\n\n  for (const loader of loaders) {\n    for (const loaderExtension of loader.extensions) {\n      if (loaderExtension.toLowerCase() === extension) {\n        return loader;\n      }\n    }\n  }\n  return null;\n}\n\nfunction findLoaderByMIMEType(loaders, mimeType) {\n  for (const loader of loaders) {\n    if (loader.mimeTypes && loader.mimeTypes.includes(mimeType)) {\n      return loader;\n    }\n\n    // Support referring to loaders using the \"unregistered tree\"\n    // https://en.wikipedia.org/wiki/Media_type#Unregistered_tree\n    if (mimeType === `application/x.${loader.id}`) {\n      return loader;\n    }\n  }\n  return null;\n}\n\nfunction findLoaderByInitialBytes(loaders, data) {\n  if (!data) {\n    return null;\n  }\n\n  for (const loader of loaders) {\n    if (typeof data === 'string') {\n      if (testDataAgainstText(data, loader)) {\n        return loader;\n      }\n    } else if (ArrayBuffer.isView(data)) {\n      // Typed Arrays can have offsets into underlying buffer\n      if (testDataAgainstBinary(data.buffer, data.byteOffset, loader)) {\n        return loader;\n      }\n    } else if (data instanceof ArrayBuffer) {\n      const byteOffset = 0;\n      if (testDataAgainstBinary(data, byteOffset, loader)) {\n        return loader;\n      }\n    }\n    // TODO Handle streaming case (requires creating a new AsyncIterator)\n  }\n  return null;\n}\n\nfunction testDataAgainstText(data, loader) {\n  if (loader.testText) {\n    return loader.testText(data);\n  }\n\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some((test) => data.startsWith(test));\n}\n\nfunction testDataAgainstBinary(data, byteOffset, loader) {\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some((test) => testBinary(data, byteOffset, loader, test));\n}\n\nfunction testBinary(data, byteOffset, loader, test) {\n  if (test instanceof ArrayBuffer) {\n    return compareArrayBuffers(test, data, test.byteLength);\n  }\n  switch (typeof test) {\n    case 'function':\n      return test(data, loader);\n\n    case 'string':\n      // Magic bytes check: If `test` is a string, check if binary data starts with that strings\n      const magic = getMagicString(data, byteOffset, test.length);\n      return test === magic;\n\n    default:\n      return false;\n  }\n}\n\nfunction getFirstCharacters(data, length: number = 5) {\n  if (typeof data === 'string') {\n    return data.slice(0, length);\n  } else if (ArrayBuffer.isView(data)) {\n    // Typed Arrays can have offsets into underlying buffer\n    return getMagicString(data.buffer, data.byteOffset, length);\n  } else if (data instanceof ArrayBuffer) {\n    const byteOffset = 0;\n    return getMagicString(data, byteOffset, length);\n  }\n  return '';\n}\n\nfunction getMagicString(arrayBuffer, byteOffset, length) {\n  if (arrayBuffer.byteLength < byteOffset + length) {\n    return '';\n  }\n  const dataView = new DataView(arrayBuffer);\n  let magic = '';\n  for (let i = 0; i < length; i++) {\n    magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n  }\n  return magic;\n}\n","import {resolvePath} from '@loaders.gl/loader-utils';\nimport {makeResponse} from '../utils/response-utils';\n// import {getErrorMessageFromResponse} from './fetch-error-message';\n\n/**\n * fetch compatible function\n * Reads file data from:\n * - http/http urls\n * - data urls\n * - File/Blob objects\n * Leverages `@loaders.gl/polyfills` for Node.js support\n * Respects pathPrefix and file aliases\n */\nexport async function fetchFile(\n  url: string | Blob,\n  options?: RequestInit & {fetch?: RequestInit | Function}\n): Promise<Response> {\n  if (typeof url === 'string') {\n    url = resolvePath(url);\n\n    let fetchOptions: RequestInit = options as RequestInit;\n    if (options?.fetch && typeof options?.fetch !== 'function') {\n      fetchOptions = options.fetch;\n    }\n\n    return await fetch(url, fetchOptions);\n  }\n\n  return await makeResponse(url);\n}\n","import type {\n  DataType,\n  SyncDataType,\n  BatchableDataType,\n  Loader,\n  LoaderOptions\n} from '@loaders.gl/loader-utils';\nimport {concatenateArrayBuffersAsync} from '@loaders.gl/loader-utils';\nimport {\n  isResponse,\n  isReadableStream,\n  isAsyncIterable,\n  isIterable,\n  isIterator,\n  isBlob,\n  isBuffer\n} from '../../javascript-utils/is-type';\nimport {makeIterator} from '../../iterators/make-iterator/make-iterator';\nimport {checkResponse, makeResponse} from '../utils/response-utils';\n\nconst ERR_DATA = 'Cannot convert supplied data type';\n\n// eslint-disable-next-line complexity\nexport function getArrayBufferOrStringFromDataSync(\n  data: SyncDataType,\n  loader: Loader,\n  options: LoaderOptions\n): ArrayBuffer | string {\n  if (loader.text && typeof data === 'string') {\n    return data;\n  }\n\n  if (isBuffer(data)) {\n    // @ts-ignore\n    data = data.buffer;\n  }\n\n  if (data instanceof ArrayBuffer) {\n    const arrayBuffer = data;\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(arrayBuffer);\n    }\n    return arrayBuffer;\n  }\n\n  // We may need to handle offsets\n  if (ArrayBuffer.isView(data)) {\n    // TextDecoder is invoked on typed arrays and will handle offsets\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(data);\n    }\n\n    let arrayBuffer = data.buffer;\n\n    // Since we are returning the underlying arrayBuffer, we must create a new copy\n    // if this typed array / Buffer is a partial view into the ArryayBuffer\n    // TODO - this is a potentially unnecessary copy\n    const byteLength = data.byteLength || data.length;\n    if (data.byteOffset !== 0 || byteLength !== arrayBuffer.byteLength) {\n      // console.warn(`loaders.gl copying arraybuffer of length ${byteLength}`);\n      arrayBuffer = arrayBuffer.slice(data.byteOffset, data.byteOffset + byteLength);\n    }\n    return arrayBuffer;\n  }\n\n  throw new Error(ERR_DATA);\n}\n\n// Convert async iterator to a promise\nexport async function getArrayBufferOrStringFromData(\n  data: DataType,\n  loader: Loader,\n  options: LoaderOptions\n): Promise<ArrayBuffer | string> {\n  const isArrayBuffer = data instanceof ArrayBuffer || ArrayBuffer.isView(data);\n  if (typeof data === 'string' || isArrayBuffer) {\n    return getArrayBufferOrStringFromDataSync(data as string | ArrayBuffer, loader, options);\n  }\n\n  // Blobs and files are FileReader compatible\n  if (isBlob(data)) {\n    data = await makeResponse(data);\n  }\n\n  if (isResponse(data)) {\n    const response = data as Response;\n    await checkResponse(response);\n    return loader.binary ? await response.arrayBuffer() : await response.text();\n  }\n\n  if (isReadableStream(data)) {\n    // @ts-expect-error TS2559 options type\n    data = makeIterator(data as ReadableStream, options);\n  }\n\n  if (isIterable(data) || isAsyncIterable(data)) {\n    // Assume arrayBuffer iterator - attempt to concatenate\n    return concatenateArrayBuffersAsync(data as AsyncIterable<ArrayBuffer>);\n  }\n\n  throw new Error(ERR_DATA);\n}\n\nexport async function getAsyncIterableFromData(\n  data: BatchableDataType,\n  options: LoaderOptions\n): Promise<AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>> {\n  if (isIterator(data)) {\n    return data as AsyncIterable<ArrayBuffer>;\n  }\n\n  if (isResponse(data)) {\n    const response = data as Response;\n    // Note Since this function is not async, we currently can't load error message, just status\n    await checkResponse(response);\n    // TODO - bug in polyfill, body can be a Promise under Node.js\n    // eslint-disable-next-line @typescript-eslint/await-thenable\n    const body = await response.body;\n    // TODO - body can be null?\n    return makeIterator(body as ReadableStream<Uint8Array>, options as any);\n  }\n\n  if (isBlob(data) || isReadableStream(data)) {\n    return makeIterator(data as Blob | ReadableStream, options as any);\n  }\n\n  if (isAsyncIterable(data)) {\n    return data[Symbol.asyncIterator]();\n  }\n\n  return getIterableFromData(data);\n}\n\nexport async function getReadableStream(data: BatchableDataType): Promise<ReadableStream> {\n  if (isReadableStream(data)) {\n    return data as ReadableStream;\n  }\n  if (isResponse(data)) {\n    // @ts-ignore\n    return data.body;\n  }\n  const response = await makeResponse(data);\n  // @ts-ignore\n  return response.body;\n}\n\n// HELPERS\n\nfunction getIterableFromData(data) {\n  // generate an iterator that emits a single chunk\n  if (ArrayBuffer.isView(data)) {\n    return (function* oneChunk() {\n      yield data.buffer;\n    })();\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return (function* oneChunk() {\n      yield data;\n    })();\n  }\n\n  if (isIterator(data)) {\n    return data;\n  }\n\n  if (isIterable(data)) {\n    return data[Symbol.iterator]();\n  }\n\n  throw new Error(ERR_DATA);\n}\n","// loaders.gl, MIT license\n\nimport type {LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isObject} from '../../javascript-utils/is-type';\nimport {fetchFile} from '../fetch/fetch-file';\nimport {getGlobalLoaderOptions} from './option-utils';\n\n/**\n * Gets the current fetch function from options and context\n * @param options\n * @param context\n */\nexport function getFetchFunction(\n  options?: LoaderOptions,\n  context?: Omit<LoaderContext, 'fetch'> & Partial<Pick<LoaderContext, 'fetch'>>\n) {\n  const globalOptions = getGlobalLoaderOptions();\n\n  const fetchOptions = options || globalOptions;\n\n  // options.fetch can be a function\n  if (typeof fetchOptions.fetch === 'function') {\n    return fetchOptions.fetch;\n  }\n\n  // options.fetch can be an options object\n  if (isObject(fetchOptions.fetch)) {\n    return (url) => fetchFile(url, fetchOptions as RequestInit);\n  }\n\n  // else refer to context (from parent loader) if available\n  if (context?.fetch) {\n    return context?.fetch;\n  }\n\n  // else return the default fetch function\n  return fetchFile;\n}\n","import type {Loader, LoaderOptions, LoaderContext} from '@loaders.gl/loader-utils';\nimport {getFetchFunction} from './get-fetch-function';\nimport {extractQueryString, stripQueryString} from '../utils/url-utils';\nimport {path} from '@loaders.gl/loader-utils';\n\n/**\n * \"sub\" loaders invoked by other loaders get a \"context\" injected on `this`\n * The context will inject core methods like `parse` and contain information\n * about loaders and options passed in to the top-level `parse` call.\n *\n * @param context\n * @param options\n * @param previousContext\n */\nexport function getLoaderContext(\n  context: Omit<LoaderContext, 'fetch'> & Partial<Pick<LoaderContext, 'fetch'>>,\n  options: LoaderOptions,\n  parentContext: LoaderContext | null\n): LoaderContext {\n  // For recursive calls, we already have a context\n  // TODO - add any additional loaders to context?\n  if (parentContext) {\n    return parentContext;\n  }\n\n  const newContext: LoaderContext = {\n    fetch: getFetchFunction(options, context),\n    ...context\n  };\n\n  // Parse URLs so that subloaders can easily generate correct strings\n  if (newContext.url) {\n    const baseUrl = stripQueryString(newContext.url);\n    newContext.baseUrl = baseUrl;\n    newContext.queryString = extractQueryString(newContext.url);\n    newContext.filename = path.filename(baseUrl);\n    newContext.baseUrl = path.dirname(baseUrl);\n  }\n\n  // Recursive loading does not use single loader\n  if (!Array.isArray(newContext.loaders)) {\n    newContext.loaders = null;\n  }\n\n  return newContext;\n}\n\n// eslint-disable-next-line complexity\nexport function getLoadersFromContext(\n  loaders: Loader[] | Loader | undefined,\n  context?: LoaderContext\n) {\n  // A single non-array loader is force selected, but only on top-level (context === null)\n  if (!context && loaders && !Array.isArray(loaders)) {\n    return loaders;\n  }\n\n  // Create a merged list\n  let candidateLoaders;\n  if (loaders) {\n    candidateLoaders = Array.isArray(loaders) ? loaders : [loaders];\n  }\n  if (context && context.loaders) {\n    const contextLoaders = Array.isArray(context.loaders) ? context.loaders : [context.loaders];\n    candidateLoaders = candidateLoaders ? [...candidateLoaders, ...contextLoaders] : contextLoaders;\n  }\n  // If no loaders, return null to look in globally registered loaders\n  return candidateLoaders && candidateLoaders.length ? candidateLoaders : null;\n}\n","// probe.gl Log compatible loggers\nimport {Log} from '@probe.gl/log';\n\nexport const probeLog = new Log({id: 'loaders.gl'});\n\n// Logs nothing\nexport class NullLog {\n  log() {\n    return () => {};\n  }\n  info() {\n    return () => {};\n  }\n  warn() {\n    return () => {};\n  }\n  error() {\n    return () => {};\n  }\n}\n\n// Logs to console\nexport class ConsoleLog {\n  console;\n\n  constructor() {\n    this.console = console; // eslint-disable-line\n  }\n  log(...args) {\n    return this.console.log.bind(this.console, ...args);\n  }\n  info(...args) {\n    return this.console.info.bind(this.console, ...args);\n  }\n  warn(...args) {\n    return this.console.warn.bind(this.console, ...args);\n  }\n  error(...args) {\n    return this.console.error.bind(this.console, ...args);\n  }\n}\n","import type {Loader} from '@loaders.gl/loader-utils';\nimport {assert} from '@loaders.gl/loader-utils';\n\nexport function isLoaderObject(loader?: any): boolean {\n  if (!loader) {\n    return false;\n  }\n\n  if (Array.isArray(loader)) {\n    loader = loader[0];\n  }\n\n  const hasExtensions = Array.isArray(loader?.extensions);\n\n  /* Now handled by types and worker loaders do not have these\n  let hasParser =\n    loader.parseTextSync ||\n    loader.parseSync ||\n    loader.parse ||\n    loader.parseStream || // TODO Remove, Replace with parseInBatches\n    loader.parseInBatches;\n  */\n\n  return hasExtensions;\n}\n\nexport function normalizeLoader(loader: Loader): Loader {\n  // This error is fairly easy to trigger by mixing up import statements etc\n  // So we make an exception and add a developer error message for this case\n  // To help new users from getting stuck here\n  assert(loader, 'null loader');\n  assert(isLoaderObject(loader), 'invalid loader');\n\n  // NORMALIZE [LOADER, OPTIONS] => LOADER\n\n  // If [loader, options], create a new loaders object with options merged in\n  let options;\n  if (Array.isArray(loader)) {\n    options = loader[1];\n    loader = loader[0];\n    loader = {\n      ...loader,\n      options: {...loader.options, ...options}\n    };\n  }\n\n  // NORMALIZE text and binary flags\n  // Ensure at least one of text/binary flags are properly set\n\n  // @ts-expect-error\n  if (loader?.parseTextSync || loader?.parseText) {\n    loader.text = true;\n  }\n\n  if (!loader.text) {\n    loader.binary = true;\n  }\n\n  return loader;\n}\n","import type {LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isBrowser} from '@loaders.gl/loader-utils';\nimport {ConsoleLog} from './loggers';\n\nexport const DEFAULT_LOADER_OPTIONS: LoaderOptions = {\n  // baseUri\n  fetch: null,\n  mimeType: undefined,\n  nothrow: false,\n  log: new ConsoleLog(), // A probe.gl compatible (`log.log()()` syntax) that just logs to console\n\n  CDN: 'https://unpkg.com/@loaders.gl',\n  worker: true, // By default, use worker if provided by loader.\n  maxConcurrency: 3, // How many worker instances should be created for each loader.\n  maxMobileConcurrency: 1, // How many worker instances should be created for each loader on mobile devices.\n  reuseWorkers: isBrowser, // By default reuse workers in browser (Node.js refuses to terminate if browsers are running)\n  _nodeWorkers: false, // By default do not support node workers\n  _workerType: '', // 'test' to use locally generated workers\n\n  limit: 0,\n  _limitMB: 0,\n  batchSize: 'auto',\n  batchDebounceMs: 0,\n  metadata: false, // TODO - currently only implemented for parseInBatches, adds initial metadata batch,\n  transforms: []\n};\n\nexport const REMOVED_LOADER_OPTIONS = {\n  throws: 'nothrow',\n  dataType: '(no longer used)',\n  uri: 'baseUri',\n  // Warn if fetch options are used on top-level\n  method: 'fetch.method',\n  headers: 'fetch.headers',\n  body: 'fetch.body',\n  mode: 'fetch.mode',\n  credentials: 'fetch.credentials',\n  cache: 'fetch.cache',\n  redirect: 'fetch.redirect',\n  referrer: 'fetch.referrer',\n  referrerPolicy: 'fetch.referrerPolicy',\n  integrity: 'fetch.integrity',\n  keepalive: 'fetch.keepalive',\n  signal: 'fetch.signal'\n};\n","// loaders.gl, MIT license\n\nimport type {Loader, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isPureObject, isObject} from '../../javascript-utils/is-type';\nimport {probeLog, NullLog} from './loggers';\nimport {DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS} from './option-defaults';\n\n/**\n * Global state for loaders.gl. Stored on `global.loaders._state`\n */\ntype GlobalLoaderState = {\n  loaderRegistry: Loader[];\n  globalOptions: LoaderOptions;\n};\n\n/**\n * Helper for safely accessing global loaders.gl variables\n * Wraps initialization of global variable in function to defeat overly aggressive tree-shakers\n */\nexport function getGlobalLoaderState(): GlobalLoaderState {\n  // @ts-ignore\n  globalThis.loaders = globalThis.loaders || {};\n  // @ts-ignore\n  const {loaders} = globalThis;\n\n  // Add _state object to keep separate from modules added to globalThis.loaders\n  loaders._state = loaders._state || {};\n  return loaders._state;\n}\n\n/**\n * Store global loader options on the global object to increase chances of cross loaders-version interoperability\n * NOTE: This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\n * @returns global loader options merged with default loader options\n */\nexport const getGlobalLoaderOptions = (): LoaderOptions => {\n  const state = getGlobalLoaderState();\n  // Ensure all default loader options from this library are mentioned\n  state.globalOptions = state.globalOptions || {...DEFAULT_LOADER_OPTIONS};\n  return state.globalOptions;\n};\n\n/**\n * Set global loader options\n * @param options\n */\nexport function setGlobalOptions(options: LoaderOptions): void {\n  const state = getGlobalLoaderState();\n  const globalOptions = getGlobalLoaderOptions();\n  state.globalOptions = normalizeOptionsInternal(globalOptions, options);\n}\n\n/**\n * Merges options with global opts and loader defaults, also injects baseUri\n * @param options\n * @param loader\n * @param loaders\n * @param url\n */\nexport function normalizeOptions(\n  options: LoaderOptions,\n  loader: Loader,\n  loaders?: Loader[],\n  url?: string\n): LoaderOptions {\n  loaders = loaders || [];\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n\n  validateOptions(options, loaders);\n  return normalizeOptionsInternal(loader, options, url);\n}\n\n// VALIDATE OPTIONS\n\n/**\n * Warn for unsupported options\n * @param options\n * @param loaders\n */\nfunction validateOptions(options: LoaderOptions, loaders: Loader[]) {\n  // Check top level options\n  validateOptionsObject(options, null, DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS, loaders);\n  for (const loader of loaders) {\n    // Get the scoped, loader specific options from the user supplied options\n    const idOptions = (options && options[loader.id]) || {};\n\n    // Get scoped, loader specific default and deprecated options from the selected loader\n    const loaderOptions = (loader.options && loader.options[loader.id]) || {};\n    const deprecatedOptions =\n      (loader.deprecatedOptions && loader.deprecatedOptions[loader.id]) || {};\n\n    // Validate loader specific options\n    validateOptionsObject(idOptions, loader.id, loaderOptions, deprecatedOptions, loaders);\n  }\n}\n\n// eslint-disable-next-line max-params, complexity\nfunction validateOptionsObject(\n  options,\n  id: string | null,\n  defaultOptions,\n  deprecatedOptions,\n  loaders: Loader[]\n) {\n  const loaderName = id || 'Top level';\n  const prefix = id ? `${id}.` : '';\n\n  for (const key in options) {\n    // If top level option value is an object it could options for a loader, so ignore\n    const isSubOptions = !id && isObject(options[key]);\n    const isBaseUriOption = key === 'baseUri' && !id;\n    const isWorkerUrlOption = key === 'workerUrl' && id;\n    // <loader>.workerUrl requires special handling as it is now auto-generated and no longer specified as a default option.\n    if (!(key in defaultOptions) && !isBaseUriOption && !isWorkerUrlOption) {\n      // Issue deprecation warnings\n      if (key in deprecatedOptions) {\n        probeLog.warn(\n          `${loaderName} loader option \\'${prefix}${key}\\' no longer supported, use \\'${deprecatedOptions[key]}\\'`\n        )();\n      } else if (!isSubOptions) {\n        const suggestion = findSimilarOption(key, loaders);\n        probeLog.warn(\n          `${loaderName} loader option \\'${prefix}${key}\\' not recognized. ${suggestion}`\n        )();\n      }\n    }\n  }\n}\n\nfunction findSimilarOption(optionKey, loaders) {\n  const lowerCaseOptionKey = optionKey.toLowerCase();\n  let bestSuggestion = '';\n  for (const loader of loaders) {\n    for (const key in loader.options) {\n      if (optionKey === key) {\n        return `Did you mean \\'${loader.id}.${key}\\'?`;\n      }\n      const lowerCaseKey = key.toLowerCase();\n      const isPartialMatch =\n        lowerCaseOptionKey.startsWith(lowerCaseKey) || lowerCaseKey.startsWith(lowerCaseOptionKey);\n      if (isPartialMatch) {\n        bestSuggestion = bestSuggestion || `Did you mean \\'${loader.id}.${key}\\'?`;\n      }\n    }\n  }\n  return bestSuggestion;\n}\n\nfunction normalizeOptionsInternal(loader, options, url?: string) {\n  const loaderDefaultOptions = loader.options || {};\n\n  const mergedOptions = {...loaderDefaultOptions};\n\n  addUrlOptions(mergedOptions, url);\n\n  // LOGGING: options.log can be set to `null` to defeat logging\n  if (mergedOptions.log === null) {\n    mergedOptions.log = new NullLog();\n  }\n\n  mergeNestedFields(mergedOptions, getGlobalLoaderOptions());\n  mergeNestedFields(mergedOptions, options);\n\n  return mergedOptions;\n}\n\n// Merge nested options objects\nfunction mergeNestedFields(mergedOptions, options) {\n  for (const key in options) {\n    // Check for nested options\n    // object in options => either no key in defaultOptions or object in defaultOptions\n    if (key in options) {\n      const value = options[key];\n      if (isPureObject(value) && isPureObject(mergedOptions[key])) {\n        mergedOptions[key] = {\n          ...mergedOptions[key],\n          ...options[key]\n        };\n      } else {\n        mergedOptions[key] = options[key];\n      }\n    }\n    // else: No need to merge nested opts, and the initial merge already copied over the nested options\n  }\n}\n\n/**\n * Harvest information from the url\n * @deprecated This is mainly there to support a hack in the GLTFLoader\n * TODO - baseUri should be a directory, i.e. remove file component from baseUri\n * TODO - extract extension?\n * TODO - extract query parameters?\n * TODO - should these be injected on context instead of options?\n */\nfunction addUrlOptions(options, url?: string) {\n  if (url && !('baseUri' in options)) {\n    options.baseUri = url;\n  }\n}\n","// loaders.gl, MIT license\nimport {Log} from '@probe.gl/log';\n\nexport const log = new Log({id: 'loaders.gl'});\n","// TODO - build/integrate proper MIME type parsing\n// https://mimesniff.spec.whatwg.org/\n\nconst DATA_URL_PATTERN = /^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/;\nconst MIME_TYPE_PATTERN = /^([-\\w.]+\\/[-\\w.+]+)/;\n\n/**\n * Remove extra data like `charset` from MIME types\n * @param mimeString\n * @returns A clean MIME type, or an empty string\n *\n * @todo - handle more advanced MIMETYpes, multiple types\n * @todo - extract charset etc\n */\nexport function parseMIMEType(mimeString: string): string {\n  // If resource is a data url, extract any embedded mime type\n  const matches = MIME_TYPE_PATTERN.exec(mimeString);\n  if (matches) {\n    return matches[1];\n  }\n  return mimeString;\n}\n\n/**\n * Extract MIME type from data URL\n *\n * @param mimeString\n * @returns A clean MIME type, or an empty string\n *\n * @todo - handle more advanced MIMETYpes, multiple types\n * @todo - extract charset etc\n */\nexport function parseMIMETypeFromURL(url: string): string {\n  // If resource is a data URL, extract any embedded mime type\n  const matches = DATA_URL_PATTERN.exec(url);\n  if (matches) {\n    return matches[1];\n  }\n  return '';\n}\n","// loaders.gl, MIT license\n\nimport {isResponse, isBlob} from '../../javascript-utils/is-type';\nimport {parseMIMEType, parseMIMETypeFromURL} from './mime-type-utils';\nimport {stripQueryString} from './url-utils';\n\n/**\n * A loadable resource. Includes:\n * `Response`, `Blob` (`File` is a subclass), string URLs and data URLs\n */\nexport type Resource = Response | Blob | string;\n\n/**\n * Returns the URL associated with this resource.\n * The returned value may include a query string and need further processing.\n * If it cannot determine url, the corresponding value will be an empty string\n *\n * @todo string parameters are assumed to be URLs\n */\nexport function getResourceUrl(resource: unknown): string {\n  // If resource is a `Response`, it contains the information directly as a field\n  if (isResponse(resource)) {\n    const response = resource as Response;\n    return response.url;\n  }\n\n  // If the resource is a Blob or a File (subclass of Blob)\n  if (isBlob(resource)) {\n    const blob = resource as Blob;\n    // File objects have a \"name\" property. Blob objects don't have any\n    // url (name) information\n    return blob.name || '';\n  }\n\n  if (typeof resource === 'string') {\n    return resource;\n  }\n\n  // Unknown\n  return '';\n}\n\n/**\n * Returns the URL associated with this resource.\n * The returned value may include a query string and need further processing.\n * If it cannot determine url, the corresponding value will be an empty string\n *\n * @todo string parameters are assumed to be URLs\n */\nexport function getResourceMIMEType(resource: unknown): string {\n  // If resource is a response, it contains the information directly\n  if (isResponse(resource)) {\n    const response = resource as Response;\n    const contentTypeHeader = response.headers.get('content-type') || '';\n    const noQueryUrl = stripQueryString(response.url);\n    return parseMIMEType(contentTypeHeader) || parseMIMETypeFromURL(noQueryUrl);\n  }\n\n  // If the resource is a Blob or a File (subclass of Blob)\n  if (isBlob(resource)) {\n    const blob = resource as Blob;\n    return blob.type || '';\n  }\n\n  if (typeof resource === 'string') {\n    return parseMIMETypeFromURL(resource);\n  }\n\n  // Unknown\n  return '';\n}\n\n/**\n  * Returns (approximate) content length for a resource if it can be determined.\n  * Returns -1 if content length cannot be determined.\n  * @param resource\n\n  * @note string parameters are NOT assumed to be URLs\n  */\nexport function getResourceContentLength(resource: unknown): number {\n  if (isResponse(resource)) {\n    const response = resource as Response;\n    return response.headers['content-length'] || -1;\n  }\n  if (isBlob(resource)) {\n    const blob = resource as Blob;\n    return blob.size;\n  }\n  if (typeof resource === 'string') {\n    // TODO - handle data URL?\n    return resource.length;\n  }\n  if (resource instanceof ArrayBuffer) {\n    return resource.byteLength;\n  }\n  if (ArrayBuffer.isView(resource)) {\n    return resource.byteLength;\n  }\n  return -1;\n}\n","import {isResponse} from '../../javascript-utils/is-type';\nimport {getResourceContentLength, getResourceUrl, getResourceMIMEType} from './resource-utils';\n\n/**\n * Returns a Response object\n * Adds content-length header when possible\n *\n * @param resource\n */\nexport async function makeResponse(resource: any): Promise<Response> {\n  if (isResponse(resource)) {\n    return resource;\n  }\n\n  // Add content-length header if possible\n  const headers: {[header: string]: string} = {};\n\n  const contentLength = getResourceContentLength(resource);\n  if (contentLength >= 0) {\n    headers['content-length'] = String(contentLength);\n  }\n\n  // `new Response(File)` does not preserve content-type and URL\n  // so we add them here\n  const url = getResourceUrl(resource);\n  const type = getResourceMIMEType(resource);\n  if (type) {\n    headers['content-type'] = type;\n  }\n\n  // Add a custom header with initial bytes if available\n  const initialDataUrl = await getInitialDataUrl(resource);\n  if (initialDataUrl) {\n    headers['x-first-bytes'] = initialDataUrl;\n  }\n\n  // TODO - is this the best way of handling strings?\n  // Maybe package as data URL instead?\n  if (typeof resource === 'string') {\n    // Convert to ArrayBuffer to avoid Response treating it as a URL\n    resource = new TextEncoder().encode(resource);\n  }\n\n  // Attempt to create a Response from the resource, adding headers and setting url\n  const response = new Response(resource, {headers});\n  // We can't control `Response.url` via constructor, use a property override to record URL.\n  Object.defineProperty(response, 'url', {value: url});\n  return response;\n}\n\n/**\n * Checks response status (async) and throws a helpful error message if status is not OK.\n * @param response\n */\nexport async function checkResponse(response: Response): Promise<void> {\n  if (!response.ok) {\n    const message = await getResponseError(response);\n    throw new Error(message);\n  }\n}\n\n/**\n * Checks response status (sync) and throws a helpful error message if status is not OK.\n * @param response\n */\nexport function checkResponseSync(response: Response): void {\n  if (!response.ok) {\n    let message = `${response.status} ${response.statusText}`;\n    message = message.length > 60 ? `${message.slice(0, 60)}...` : message;\n    throw new Error(message);\n  }\n}\n\n// HELPERS\n\nasync function getResponseError(response): Promise<string> {\n  let message = `Failed to fetch resource ${response.url} (${response.status}): `;\n  try {\n    const contentType = response.headers.get('Content-Type');\n    let text = response.statusText;\n    if (contentType.includes('application/json')) {\n      text += ` ${await response.text()}`;\n    }\n    message += text;\n    message = message.length > 60 ? `${message.slice(0, 60)}...` : message;\n  } catch (error) {\n    // eslint forbids return in a finally statement, so we just catch here\n  }\n  return message;\n}\n\nasync function getInitialDataUrl(resource): Promise<string | null> {\n  const INITIAL_DATA_LENGTH = 5;\n  if (typeof resource === 'string') {\n    return `data:,${resource.slice(0, INITIAL_DATA_LENGTH)}`;\n  }\n  if (resource instanceof Blob) {\n    const blobSlice = resource.slice(0, 5);\n    return await new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.onload = (event) => resolve(event?.target?.result as string);\n      reader.readAsDataURL(blobSlice);\n    });\n  }\n  if (resource instanceof ArrayBuffer) {\n    const slice = resource.slice(0, INITIAL_DATA_LENGTH);\n    const base64 = arrayBufferToBase64(slice);\n    return `data:base64,${base64}`;\n  }\n  return null;\n}\n\n// https://stackoverflow.com/questions/9267899/arraybuffer-to-base64-encoded-string\nfunction arrayBufferToBase64(buffer) {\n  let binary = '';\n  const bytes = new Uint8Array(buffer);\n  for (let i = 0; i < bytes.byteLength; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return btoa(binary);\n}\n","// loaders.gl, MIT license\n\nconst QUERY_STRING_PATTERN = /\\?.*/;\n\nexport function extractQueryString(url): string {\n  const matches = url.match(QUERY_STRING_PATTERN);\n  return matches && matches[0];\n}\n\nexport function stripQueryString(url): string {\n  return url.replace(QUERY_STRING_PATTERN, '');\n}\n","// Do not name these variables the same as the global objects - will break bundling\nconst global_ = globalThis;\n// eslint-disable-next-line consistent-this\nconst self_ = globalThis.self || globalThis.window || globalThis.global;\nconst window_ = (globalThis.window || globalThis.self || globalThis.global) as unknown as Window;\nconst document_ = globalThis.document || ({} as Document);\nconst process_ = globalThis.process || {};\nconst console_ = globalThis.console;\nconst navigator_ = globalThis.navigator || ({} as Navigator);\n\nexport {\n  global_ as global,\n  self_ as self,\n  window_ as window,\n  document_ as document,\n  process_ as process,\n  console_ as console,\n  navigator_ as navigator\n};\n","// This function is needed in initialization stages,\n// make sure it can be imported in isolation\n\nimport isElectron from './is-electron';\n\nexport default function isBrowser(): boolean {\n  // Check if in browser by duck-typing Node context\n  const isNode =\n    // @ts-expect-error\n    typeof process === 'object' && String(process) === '[object process]' && !process.browser;\n\n  return !isNode || isElectron();\n}\n\n// document does not exist on worker thread\nexport function isBrowserMainThread(): boolean {\n  return isBrowser() && typeof document !== 'undefined';\n}\n","// based on https://github.com/cheton/is-electron\n// https://github.com/electron/electron/issues/2288\n/* eslint-disable complexity */\nexport default function isElectron(mockUserAgent?: string): boolean {\n  // Renderer process\n  if (\n    typeof window !== 'undefined' &&\n    typeof window.process === 'object' &&\n    // @ts-expect-error\n    window.process.type === 'renderer'\n  ) {\n    return true;\n  }\n  // Main process\n  if (\n    typeof process !== 'undefined' &&\n    typeof process.versions === 'object' &&\n    // eslint-disable-next-line\n    Boolean(process.versions['electron'])\n  ) {\n    return true;\n  }\n  // Detect the user agent when the `nodeIntegration` option is set to true\n  const realUserAgent =\n    typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n  return false;\n}\n","import checkIfBrowser from '../lib/is-browser';\n\nexport {self, window, global, document, process, console} from '../lib/globals';\n\n// Extract injected version from package.json (injected by babel plugin)\n// @ts-expect-error\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\n\nexport const isBrowser = checkIfBrowser();\n","// probe.gl, MIT license\n\n/* eslint-disable no-console */\nimport {VERSION, isBrowser} from '@probe.gl/env';\nimport {LocalStorage} from './utils/local-storage';\nimport {formatImage, formatTime, leftPad} from './utils/formatters';\nimport {addColor} from './utils/color';\nimport {autobind} from './utils/autobind';\nimport assert from './utils/assert';\nimport {getHiResTimestamp} from './utils/hi-res-timestamp';\n\n/** \"Global\" log configuration settings */\ntype LogConfiguration = {\n  enabled?: boolean;\n  level?: number;\n  [key: string]: unknown;\n};\n\n/** Options when logging a message */\ntype LogOptions = {\n  method?: Function;\n  time?: boolean;\n  total?: number;\n  delta?: number;\n  tag?: string;\n  message?: string;\n  once?: boolean;\n  nothrottle?: boolean;\n  args?: any;\n};\n\ntype LogFunction = () => void;\n\ntype Table = Record<string, any>;\n\n// Instrumentation in other packages may override console methods, so preserve them here\nconst originalConsole = {\n  debug: isBrowser() ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\n\nconst DEFAULT_LOG_CONFIGURATION: Required<LogConfiguration> = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {} // eslint-disable-line @typescript-eslint/no-empty-function\n\nconst cache = {};\nconst ONCE = {once: true};\n\n/** A console wrapper */\n\nexport class Log {\n  static VERSION = VERSION;\n\n  id: string;\n  VERSION: string = VERSION;\n  _startTs: number = getHiResTimestamp();\n  _deltaTs: number = getHiResTimestamp();\n  _storage: LocalStorage<LogConfiguration>;\n  userData = {};\n\n  // TODO - fix support from throttling groups\n  LOG_THROTTLE_TIMEOUT: number = 0; // Time before throttled messages are logged again\n\n  constructor({id} = {id: ''}) {\n    this.id = id;\n    this.userData = {};\n    this._storage = new LocalStorage<LogConfiguration>(\n      `__probe-${this.id}__`,\n      DEFAULT_LOG_CONFIGURATION\n    );\n\n    this.timeStamp(`${this.id} started`);\n\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel: number) {\n    this.setLevel(newLevel);\n  }\n\n  get level(): number {\n    return this.getLevel();\n  }\n\n  isEnabled(): boolean {\n    return this._storage.config.enabled;\n  }\n\n  getLevel(): number {\n    return this._storage.config.level;\n  }\n\n  /** @return milliseconds, with fractions */\n  getTotal(): number {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  /** @return milliseconds, with fractions */\n  getDelta(): number {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  /** @deprecated use logLevel */\n  set priority(newPriority: number) {\n    this.level = newPriority;\n  }\n\n  /** @deprecated use logLevel */\n  get priority(): number {\n    return this.level;\n  }\n\n  /** @deprecated use logLevel */\n  getPriority(): number {\n    return this.level;\n  }\n\n  // Configure\n\n  enable(enabled: boolean = true): this {\n    this._storage.setConfiguration({enabled});\n    return this;\n  }\n\n  setLevel(level: number): this {\n    this._storage.setConfiguration({level});\n    return this;\n  }\n\n  /** return the current status of the setting */\n  get(setting: string): any {\n    return this._storage.config[setting];\n  }\n\n  // update the status of the setting\n  set(setting: string, value: any): void {\n    this._storage.setConfiguration({[setting]: value});\n  }\n\n  /** Logs the current settings as a table */\n  settings(): void {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  // Unconditional logging\n\n  assert(condition: unknown, message?: string): asserts condition {\n    assert(condition, message);\n  }\n\n  /** Warn, but only once, no console flooding */\n  warn(message: string, ...args: unknown[]): LogFunction;\n  warn(message: string): LogFunction {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  /** Print an error */\n  error(message: string, ...args: unknown[]): LogFunction;\n  error(message: string): LogFunction {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  /** Print a deprecation warning */\n  deprecated(oldUsage: string, newUsage: string): LogFunction {\n    return this.warn(`\\`${oldUsage}\\` is deprecated and will be removed \\\nin a later version. Use \\`${newUsage}\\` instead`);\n  }\n\n  /** Print a removal warning */\n  removed(oldUsage: string, newUsage: string): LogFunction {\n    return this.error(`\\`${oldUsage}\\` has been removed. Use \\`${newUsage}\\` instead`);\n  }\n\n  // Conditional logging\n\n  /** Log to a group */\n  probe(logLevel, message?, ...args: unknown[]): LogFunction;\n  probe(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  /** Log a debug message */\n  log(logLevel, message?, ...args: unknown[]): LogFunction;\n  log(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  /** Log a normal message */\n  info(logLevel, message?, ...args: unknown[]): LogFunction;\n  info(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  /** Log a normal message, but only once, no console flooding */\n  once(logLevel, message?, ...args: unknown[]): LogFunction;\n  once(logLevel, message?) {\n    return this._getLogFunction(\n      logLevel,\n      message,\n      originalConsole.debug || originalConsole.info,\n      arguments,\n      ONCE\n    );\n  }\n\n  /** Logs an object as a table */\n  table(logLevel, table?, columns?): LogFunction {\n    if (table) {\n      return this._getLogFunction(\n        logLevel,\n        table,\n        console.table || noop,\n        (columns && [columns]) as unknown as IArguments,\n        {\n          tag: getTableHeader(table)\n        }\n      );\n    }\n    return noop;\n  }\n\n  /** logs an image under Chrome */\n  image({\n    logLevel,\n    priority,\n    image,\n    message = '',\n    scale = 1\n  }: {\n    logLevel?: number;\n    priority?: number;\n    image: any;\n    message?: string;\n    scale?: number;\n  }): LogFunction {\n    if (!this._shouldLog(logLevel || priority)) {\n      return noop;\n    }\n    return isBrowser()\n      ? logImageInBrowser({image, message, scale})\n      : logImageInNode({image, message, scale});\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(\n      logLevel,\n      message,\n      console.timeEnd ? console.timeEnd : console.info\n    );\n  }\n\n  timeStamp(logLevel, message?) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message, opts = {collapsed: false}) {\n    const options = normalizeArguments({logLevel, message, opts});\n    const {collapsed} = opts;\n    // @ts-expect-error\n    options.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n\n    return this._getLogFunction(options);\n  }\n\n  groupCollapsed(logLevel, message, opts = {}) {\n    return this.group(logLevel, message, Object.assign({}, opts, {collapsed: true}));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  // EXPERIMENTAL\n\n  withGroup(logLevel: number, message: string, func: Function): void {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace(): void {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  // PRIVATE METHODS\n\n  /** Deduces log level from a variety of arguments */\n  _shouldLog(logLevel: unknown): boolean {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(\n    logLevel: unknown,\n    message?: unknown,\n    method?: Function,\n    args?: IArguments,\n    opts?: LogOptions\n  ): LogFunction {\n    if (this._shouldLog(logLevel)) {\n      // normalized opts + timings\n      opts = normalizeArguments({logLevel, message, args, opts});\n      method = method || opts.method;\n      assert(method);\n\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      // reset delta timer\n      this._deltaTs = getHiResTimestamp();\n\n      const tag = opts.tag || opts.message;\n\n      if (opts.once && tag) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      // TODO - Make throttling work with groups\n      // if (opts.nothrottle || !throttle(tag, this.LOG_THROTTLE_TIMEOUT)) {\n      //   return noop;\n      // }\n\n      message = decorateMessage(this.id, opts.message, opts);\n\n      // Bind console function so that it can be called after being returned\n      return method.bind(console, message, ...opts.args);\n    }\n    return noop;\n  }\n}\n\n/**\n * Get logLevel from first argument:\n * - log(logLevel, message, args) => logLevel\n * - log(message, args) => 0\n * - log({logLevel, ...}, message, args) => logLevel\n * - log({logLevel, message, args}) => logLevel\n */\nfunction normalizeLogLevel(logLevel: unknown): number {\n  if (!logLevel) {\n    return 0;\n  }\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      // Backward compatibility\n      // TODO - deprecate `priority`\n      // @ts-expect-error\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n  // 'log level must be a number'\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n\n  return resolvedLevel;\n}\n\n/**\n * \"Normalizes\" the various argument patterns into an object with known types\n * - log(logLevel, message, args) => {logLevel, message, args}\n * - log(message, args) => {logLevel: 0, message, args}\n * - log({logLevel, ...}, message, args) => {logLevel, message, args}\n * - log({logLevel, message, args}) => {logLevel, message, args}\n */\nexport function normalizeArguments(opts: {\n  logLevel;\n  message;\n  collapsed?: boolean;\n  args?: IArguments | undefined;\n  opts?;\n}): {\n  logLevel: number;\n  message: string;\n  args: any[];\n} {\n  const {logLevel, message} = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n\n  // We use `arguments` instead of rest parameters (...args) because IE\n  // does not support the syntax. Rest parameters is transpiled to code with\n  // perf impact. Doing it here instead avoids constructing args when logging is\n  // disabled.\n  // TODO - remove when/if IE support is dropped\n  const args: any[] = opts.args ? Array.from(opts.args) : [];\n  // args should only contain arguments that appear after `message`\n  // eslint-disable-next-line no-empty\n  while (args.length && args.shift() !== message) {}\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  // Resolve functions into strings by calling them\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n  const messageType = typeof opts.message;\n  // 'log message must be a string' or object\n  assert(messageType === 'string' || messageType === 'object');\n\n  // original opts + normalized opts + opts arg + fixed up message\n  return Object.assign(opts, {args}, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? `${id}: ${time}  ${message}` : `${id}: ${message}`;\n    message = addColor(message, opts.color, opts.background);\n  }\n  return message;\n}\n\n/** @deprecated Function removed */\nfunction logImageInNode({image, message = '', scale = 1}) {\n  console.warn('removed');\n  return noop;\n}\n\nfunction logImageInBrowser({image, message = '', scale = 1}) {\n  if (typeof image === 'string') {\n    const img = new Image();\n    img.onload = () => {\n      const args = formatImage(img, message, scale);\n      console.log(...args);\n    };\n    img.src = image;\n    return noop;\n  }\n  const element = image.nodeName || '';\n  if (element.toLowerCase() === 'img') {\n    console.log(...formatImage(image, message, scale));\n    return noop;\n  }\n  if (element.toLowerCase() === 'canvas') {\n    const img = new Image();\n    img.onload = () => console.log(...formatImage(img, message, scale));\n    img.src = image.toDataURL();\n    return noop;\n  }\n  return noop;\n}\n\nfunction getTableHeader(table: Table): string {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n  return 'empty';\n}\n","export default function assert(condition: unknown, message?: string): asserts condition {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n","// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/**\n * Binds the \"this\" argument of all functions on a class instance to the instance\n * @param obj - class instance (typically a react component)\n */\nexport function autobind(obj: object, predefined = ['constructor']): void {\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n\n  const object = obj as Record<string, unknown>;\n  for (const key of propNames) {\n    const value = object[key];\n    if (typeof value === 'function') {\n      if (!predefined.find(name => key === name)) {\n        object[key] = value.bind(obj);\n      }\n    }\n  }\n}\n","import {isBrowser} from '@probe.gl/env';\n\nexport enum COLOR {\n  BLACK = 30,\n  RED = 31,\n  GREEN = 32,\n  YELLOW = 33,\n  BLUE = 34,\n  MAGENTA = 35,\n  CYAN = 36,\n  WHITE = 37,\n\n  BRIGHT_BLACK = 90,\n  BRIGHT_RED = 91,\n  BRIGHT_GREEN = 92,\n  BRIGHT_YELLOW = 93,\n  BRIGHT_BLUE = 94,\n  BRIGHT_MAGENTA = 95,\n  BRIGHT_CYAN = 96,\n  BRIGHT_WHITE = 97\n}\n\nconst BACKGROUND_INCREMENT = 10;\n\nfunction getColor(color: string | COLOR): number {\n  if (typeof color !== 'string') {\n    return color;\n  }\n  color = color.toUpperCase();\n  return COLOR[color] || COLOR.WHITE;\n}\n\nexport function addColor(\n  string: string,\n  color: string | COLOR,\n  background?: string | COLOR\n): string {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      const colorCode = getColor(color);\n      string = `\\u001b[${colorCode}m${string}\\u001b[39m`;\n    }\n    if (background) {\n      // background colors values are +10\n      const colorCode = getColor(background);\n      string = `\\u001b[${colorCode + BACKGROUND_INCREMENT}m${string}\\u001b[49m`;\n    }\n  }\n  return string;\n}\n","// probe.gl, MIT license\n\nexport type FormatValueOptions = {\n  isInteger?: boolean;\n  maxElts?: number;\n  size?: number;\n};\n\n/**\n * Format time\n */\nexport function formatTime(ms: number): string {\n  let formatted;\n  if (ms < 10) {\n    formatted = `${ms.toFixed(2)}ms`;\n  } else if (ms < 100) {\n    formatted = `${ms.toFixed(1)}ms`;\n  } else if (ms < 1000) {\n    formatted = `${ms.toFixed(0)}ms`;\n  } else {\n    formatted = `${(ms / 1000).toFixed(2)}s`;\n  }\n  return formatted;\n}\n\nexport function leftPad(string: string, length: number = 8): string {\n  const padLength = Math.max(length - string.length, 0);\n  return `${' '.repeat(padLength)}${string}`;\n}\n\nexport function rightPad(string: string, length: number = 8): string {\n  const padLength = Math.max(length - string.length, 0);\n  return `${string}${' '.repeat(padLength)}`;\n}\n\nexport function formatValue(v: unknown, options: FormatValueOptions = {}): string {\n  const EPSILON = 1e-16;\n  const {isInteger = false} = options;\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, options);\n  }\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n  // @ts-expect-error\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n  if (isInteger) {\n    // @ts-expect-error\n    return v.toFixed(0);\n  }\n  // @ts-expect-error\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    // @ts-expect-error\n    return v.toFixed(0);\n  }\n  // @ts-expect-error\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\n/** Helper to formatValue */\nfunction formatArrayValue(v: any, options: FormatValueOptions) {\n  const {maxElts = 16, size = 1} = options;\n  let string = '[';\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += `,${i % size === 0 ? ' ' : ''}`;\n    }\n    string += formatValue(v[i], options);\n  }\n  const terminator = v.length > maxElts ? '...' : ']';\n  return `${string}${terminator}`;\n}\n\n/**\n * Log an image to the console (uses browser specific console formatting styles)\n * Inspired by https://github.com/hughsk/console-image (MIT license)\n */\nexport function formatImage(image: any, message: string, scale: number, maxWidth: number = 600) {\n  const imageUrl = image.src.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n\n  if (image.width > maxWidth) {\n    scale = Math.min(scale, maxWidth / image.width);\n  }\n\n  const width = image.width * scale;\n  const height = image.height * scale;\n\n  const style = [\n    'font-size:1px;',\n    `padding:${Math.floor(height / 2)}px ${Math.floor(width / 2)}px;`,\n    `line-height:${height}px;`,\n    `background:url(${imageUrl});`,\n    `background-size:${width}px ${height}px;`,\n    'color:transparent;'\n  ].join('');\n\n  return [`${message} %c+`, style];\n}\n","// probe.gl, MIT license\n\nimport {window, process, isBrowser} from '@probe.gl/env';\n\n/** Get best timer available. */\nexport function getHiResTimestamp() {\n  let timestamp;\n  if (isBrowser() && window.performance) {\n    timestamp = window?.performance?.now?.();\n  } else if ('hrtime' in process) {\n    // @ts-ignore\n    const timeParts = process?.hrtime?.();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n","// probe.gl, MIT license\n\nexport type StorageType = 'sessionStorage' | 'localStorage';\n\nfunction getStorage(type: StorageType): Storage | null {\n  try {\n    const storage: Storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\n// Store keys in local storage via simple interface\nexport class LocalStorage<Configuration extends {}> {\n  storage: Storage | null;\n  id: string;\n  config: Required<Configuration>;\n\n  constructor(\n    id: string,\n    defaultConfig: Required<Configuration>,\n    type: StorageType = 'sessionStorage'\n  ) {\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = defaultConfig;\n    this._loadConfiguration();\n  }\n\n  getConfiguration(): Required<Configuration> {\n    return this.config;\n  }\n\n  setConfiguration(configuration: Configuration): void {\n    Object.assign(this.config, configuration);\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n  }\n\n  // Get config from persistent store, if available\n  _loadConfiguration() {\n    let configuration = {};\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n    Object.assign(this.config, configuration);\n    return this;\n  }\n}\n","import {TypedArray} from '../../types';\n\n/**\n * compare two binary arrays for equality\n * @param a\n * @param b\n * @param byteLength\n */\nexport function compareArrayBuffers(\n  arrayBuffer1: ArrayBuffer,\n  arrayBuffer2: ArrayBuffer,\n  byteLength?: number\n): boolean {\n  byteLength = byteLength || arrayBuffer1.byteLength;\n  if (arrayBuffer1.byteLength < byteLength || arrayBuffer2.byteLength < byteLength) {\n    return false;\n  }\n  const array1 = new Uint8Array(arrayBuffer1);\n  const array2 = new Uint8Array(arrayBuffer2);\n  for (let i = 0; i < array1.length; ++i) {\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Concatenate a sequence of ArrayBuffers\n * @return A concatenated ArrayBuffer\n */\nexport function concatenateArrayBuffers(...sources: (ArrayBuffer | Uint8Array)[]): ArrayBuffer {\n  // Make sure all inputs are wrapped in typed arrays\n  const sourceArrays = sources.map((source2) =>\n    source2 instanceof ArrayBuffer ? new Uint8Array(source2) : source2\n  );\n\n  // Get length of all inputs\n  const byteLength = sourceArrays.reduce((length, typedArray) => length + typedArray.byteLength, 0);\n\n  // Allocate array with space for all inputs\n  const result = new Uint8Array(byteLength);\n\n  // Copy the subarrays\n  let offset = 0;\n  for (const sourceArray of sourceArrays) {\n    result.set(sourceArray, offset);\n    offset += sourceArray.byteLength;\n  }\n\n  // We work with ArrayBuffers, discard the typed array wrapper\n  return result.buffer;\n}\n\n/**\n * Concatenate arbitrary count of typed arrays\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays\n * @param - list of arrays. All arrays should be the same type\n * @return A concatenated TypedArray\n */\nexport function concatenateTypedArrays<T>(...typedArrays: T[]): T {\n  // @ts-ignore\n  const arrays = typedArrays as TypedArray[];\n  // @ts-ignore\n  const TypedArrayConstructor = (arrays && arrays.length > 1 && arrays[0].constructor) || null;\n  if (!TypedArrayConstructor) {\n    throw new Error(\n      '\"concatenateTypedArrays\" - incorrect quantity of arguments or arguments have incompatible data types'\n    );\n  }\n\n  const sumLength = arrays.reduce((acc, value) => acc + value.length, 0);\n  // @ts-ignore typescript does not like dynamic constructors\n  const result = new TypedArrayConstructor(sumLength);\n  let offset = 0;\n  for (const array of arrays) {\n    result.set(array, offset);\n    offset += array.length;\n  }\n  return result;\n}\n\n/**\n * Copy a view of an ArrayBuffer into new ArrayBuffer with byteOffset = 0\n * @param arrayBuffer\n * @param byteOffset\n * @param byteLength\n */\nexport function sliceArrayBuffer(\n  arrayBuffer: ArrayBuffer,\n  byteOffset: number,\n  byteLength?: number\n): ArrayBuffer {\n  const subArray =\n    byteLength !== undefined\n      ? new Uint8Array(arrayBuffer).subarray(byteOffset, byteOffset + byteLength)\n      : new Uint8Array(arrayBuffer).subarray(byteOffset);\n  const arrayCopy = new Uint8Array(subArray);\n  return arrayCopy.buffer;\n}\n","// loaders.gl, MIT license\n\nimport * as node from '../node/buffer';\n\n/**\n * Check for Node.js `Buffer` (without triggering bundler to include Buffer polyfill on browser)\n */\nexport function isBuffer(value: any): boolean {\n  return value && typeof value === 'object' && value.isBuffer;\n}\n\n/**\n * Converts to Node.js `Buffer` (without triggering bundler to include Buffer polyfill on browser)\n * @todo better data type\n */\nexport function toBuffer(data: any): Buffer {\n  return node.toBuffer ? node.toBuffer(data) : data;\n}\n\n/**\n * Convert an object to an array buffer\n */\nexport function toArrayBuffer(data: unknown): ArrayBuffer {\n  // Note: Should be called first, Buffers can trigger other detections below\n  if (isBuffer(data)) {\n    return node.toArrayBuffer(data);\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return data;\n  }\n\n  // Careful - Node Buffers look like Uint8Arrays (keep after isBuffer)\n  if (ArrayBuffer.isView(data)) {\n    if (data.byteOffset === 0 && data.byteLength === data.buffer.byteLength) {\n      return data.buffer;\n    }\n    return data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\n  }\n\n  if (typeof data === 'string') {\n    const text = data;\n    const uint8Array = new TextEncoder().encode(text);\n    return uint8Array.buffer;\n  }\n\n  // HACK to support Blob polyfill\n  if (data && typeof data === 'object' && (data as any)._toArrayBuffer) {\n    return (data as any)._toArrayBuffer();\n  }\n\n  throw new Error('toArrayBuffer');\n}\n","/**\n * Throws an `Error` with the optional `message` if `condition` is falsy\n * @note Replacement for the external assert method to reduce bundle size\n */\nexport function assert(condition: any, message?: string): void {\n  if (!condition) {\n    throw new Error(message || 'loader assertion failed.');\n  }\n}\n","// Purpose: include this in your module to avoid\n// dependencies on micro modules like 'global' and 'is-browser';\n\n/* eslint-disable no-restricted-globals */\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\n\ntype obj = {[key: string]: any};\nconst self_: obj = globals.self || globals.window || globals.global || {};\nconst window_: obj = globals.window || globals.self || globals.global || {};\nconst global_: obj = globals.global || globals.self || globals.window || {};\nconst document_: obj = globals.document || {};\n\nexport {self_ as self, window_ as window, global_ as global, document_ as document};\n\n/** true if running in a browser */\nexport const isBrowser: boolean =\n  // @ts-ignore process does not exist on browser\n  Boolean(typeof process !== 'object' || String(process) !== '[object process]' || process.browser);\n\n/** true if running in a worker thread */\nexport const isWorker: boolean = typeof importScripts === 'function';\n\n// Extract node major version\nconst matches =\n  typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n/** Major Node version (as a number) */\nexport const nodeVersion: number = (matches && parseFloat(matches[1])) || 0;\n","import {concatenateArrayBuffers} from '../binary-utils/array-buffer-utils';\n\n// GENERAL UTILITIES\n\n/**\n * Iterate over async iterator, without resetting iterator if end is not reached\n * - forEach intentionally does not reset iterator if exiting loop prematurely\n *   so that iteration can continue in a second loop\n * - It is recommended to use a standard for-await as last loop to ensure\n *   iterator gets properly reset\n *\n * TODO - optimize using sync iteration if argument is an Iterable?\n *\n * @param iterator\n * @param visitor\n */\nexport async function forEach(iterator, visitor) {\n  // eslint-disable-next-line\n  while (true) {\n    const {done, value} = await iterator.next();\n    if (done) {\n      iterator.return();\n      return;\n    }\n    const cancel = visitor(value);\n    if (cancel) {\n      return;\n    }\n  }\n}\n\n// Breaking big data into iterable chunks, concatenating iterable chunks into big data objects\n\n/**\n * Concatenates all data chunks yielded by an (async) iterator\n * This function can e.g. be used to enable atomic parsers to work on (async) iterator inputs\n */\n\nexport async function concatenateArrayBuffersAsync(\n  asyncIterator: AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>\n): Promise<ArrayBuffer> {\n  const arrayBuffers: ArrayBuffer[] = [];\n  for await (const chunk of asyncIterator) {\n    arrayBuffers.push(chunk);\n  }\n  return concatenateArrayBuffers(...arrayBuffers);\n}\n\nexport async function concatenateStringsAsync(\n  asyncIterator: AsyncIterable<string> | Iterable<string>\n): Promise<string> {\n  const strings: string[] = [];\n  for await (const chunk of asyncIterator) {\n    strings.push(chunk);\n  }\n  return strings.join('');\n}\n","// loaders.gl, MIT license\n\n// Isolates Buffer references to ensure they are only bundled under Node.js (avoids big webpack polyfill)\n// this file is selected by the package.json \"browser\" field).\n\n/**\n * Convert Buffer to ArrayBuffer\n * Converts Node.js `Buffer` to `ArrayBuffer` (without triggering bundler to include Buffer polyfill on browser)\n * @todo better data type\n */\nexport function toArrayBuffer(buffer) {\n  return buffer;\n}\n\n/**\n * Convert (copy) ArrayBuffer to Buffer\n */\nexport function toBuffer(binaryData: ArrayBuffer | ArrayBuffer | Buffer): Buffer {\n  throw new Error('Buffer not supported in browser');\n}\n","// Simple file alias mechanisms for tests.\n\nlet pathPrefix = '';\nconst fileAliases: {[aliasPath: string]: string} = {};\n\n/*\n * Set a relative path prefix\n */\nexport function setPathPrefix(prefix: string): void {\n  pathPrefix = prefix;\n}\n\n/*\n * Get the relative path prefix\n */\nexport function getPathPrefix(): string {\n  return pathPrefix;\n}\n\n/**\n *\n * @param aliases\n *\n * Note: addAliases are an experimental export, they are only for testing of loaders.gl loaders\n * not intended as a generic aliasing mechanism\n */\nexport function addAliases(aliases: {[aliasPath: string]: string}): void {\n  Object.assign(fileAliases, aliases);\n}\n\n/**\n * Resolves aliases and adds path-prefix to paths\n */\nexport function resolvePath(filename: string): string {\n  for (const alias in fileAliases) {\n    if (filename.startsWith(alias)) {\n      const replacement = fileAliases[alias];\n      filename = filename.replace(alias, replacement);\n    }\n  }\n  if (!filename.startsWith('http://') && !filename.startsWith('https://')) {\n    filename = `${pathPrefix}${filename}`;\n  }\n  return filename;\n}\n","// loaders.gl MIT license\n\nexport function getCWD() {\n  if (typeof process !== 'undefined' && typeof process.cwd !== 'undefined') {\n    return process.cwd();\n  }\n  const pathname = window.location?.pathname;\n  return pathname?.slice(0, pathname.lastIndexOf('/') + 1) || '';\n}\n","// Beginning of a minimal implementation of the Node.js path API, that doesn't pull in big polyfills.\n\nimport {getCWD} from './get-cwd';\n\n/**\n * Replacement for Node.js path.filename\n * @param url\n */\nexport function filename(url: string): string {\n  const slashIndex = url ? url.lastIndexOf('/') : -1;\n  return slashIndex >= 0 ? url.substr(slashIndex + 1) : '';\n}\n\n/**\n * Replacement for Node.js path.dirname\n * @param url\n */\nexport function dirname(url: string): string {\n  const slashIndex = url ? url.lastIndexOf('/') : -1;\n  return slashIndex >= 0 ? url.substr(0, slashIndex) : '';\n}\n\n/**\n * Replacement for Node.js path.join\n * @param parts\n */\nexport function join(...parts: string[]): string {\n  const separator = '/';\n  parts = parts.map((part, index) => {\n    if (index) {\n      part = part.replace(new RegExp(`^${separator}`), '');\n    }\n    if (index !== parts.length - 1) {\n      part = part.replace(new RegExp(`${separator}$`), '');\n    }\n    return part;\n  });\n  return parts.join(separator);\n}\n\n/* eslint-disable no-continue */\n\n/**\n * https://nodejs.org/api/path.html#path_path_resolve_paths\n * @param paths A sequence of paths or path segments.\n * @return resolved path\n * Forked from BTOdell/path-resolve under MIT license\n * @see https://github.com/BTOdell/path-resolve/blob/master/LICENSE\n */\nexport function resolve(...components: string[]): string {\n  const paths: string[] = [];\n  for (let _i = 0; _i < components.length; _i++) {\n    paths[_i] = components[_i];\n  }\n  let resolvedPath = '';\n  let resolvedAbsolute = false;\n  let cwd: string | undefined;\n  for (let i = paths.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    let path: string | undefined;\n    if (i >= 0) {\n      path = paths[i];\n    } else {\n      if (cwd === undefined) {\n        cwd = getCWD();\n      }\n      path = cwd;\n    }\n    // Skip empty entries\n    if (path.length === 0) {\n      continue;\n    }\n    resolvedPath = `${path}/${resolvedPath}`;\n    resolvedAbsolute = path.charCodeAt(0) === SLASH;\n  }\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n  // Normalize the path (removes leading slash)\n  resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n  if (resolvedAbsolute) {\n    return `/${resolvedPath}`;\n  } else if (resolvedPath.length > 0) {\n    return resolvedPath;\n  }\n  return '.';\n}\n\nconst SLASH = 47;\nconst DOT = 46;\n\n/**\n * Resolves . and .. elements in a path with directory names\n * Forked from BTOdell/path-resolve under MIT license\n * @see https://github.com/BTOdell/path-resolve/blob/master/LICENSE\n */\n/* eslint-disable max-depth */\n// eslint-disable-next-line complexity, max-statements\nfunction normalizeStringPosix(path: string, allowAboveRoot: boolean): string {\n  let res = '';\n  let lastSlash = -1;\n  let dots = 0;\n  let code: number | undefined;\n  let isAboveRoot = false;\n\n  for (let i = 0; i <= path.length; ++i) {\n    if (i < path.length) {\n      code = path.charCodeAt(i);\n    } else if (code === SLASH) {\n      break;\n    } else {\n      code = SLASH;\n    }\n    if (code === SLASH) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (\n          res.length < 2 ||\n          !isAboveRoot ||\n          res.charCodeAt(res.length - 1) !== DOT ||\n          res.charCodeAt(res.length - 2) !== DOT\n        ) {\n          if (res.length > 2) {\n            const start = res.length - 1;\n            let j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === SLASH) {\n                break;\n              }\n            }\n            if (j !== start) {\n              res = j === -1 ? '' : res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              isAboveRoot = false;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            isAboveRoot = false;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0) {\n            res += '/..';\n          } else {\n            res = '..';\n          }\n          isAboveRoot = true;\n        }\n      } else {\n        const slice = path.slice(lastSlash + 1, i);\n        if (res.length > 0) {\n          res += `/${slice}`;\n        } else {\n          res = slice;\n        }\n        isAboveRoot = false;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === DOT && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n","import {\n  WorkerJob,\n  WorkerMessageType,\n  WorkerMessagePayload,\n  isBrowser\n} from '@loaders.gl/worker-utils';\nimport type {Loader, LoaderOptions, LoaderContext} from '../../types';\nimport {WorkerFarm, getWorkerURL} from '@loaders.gl/worker-utils';\n\n/**\n * Determines if a loader can parse with worker\n * @param loader\n * @param options\n */\nexport function canParseWithWorker(loader: Loader, options?: LoaderOptions) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n\n  // Node workers are still experimental\n  if (!isBrowser && !options?._nodeWorkers) {\n    return false;\n  }\n\n  return loader.worker && options?.worker;\n}\n\n/**\n * this function expects that the worker function sends certain messages,\n * this can be automated if the worker is wrapper by a call to createLoaderWorker in @loaders.gl/loader-utils.\n */\nexport async function parseWithWorker(\n  loader: Loader,\n  data: any,\n  options?: LoaderOptions,\n  context?: LoaderContext,\n  parseOnMainThread?: (arrayBuffer: ArrayBuffer, options: {[key: string]: any}) => Promise<void>\n) {\n  const name = loader.id; // TODO\n  const url = getWorkerURL(loader, options);\n\n  const workerFarm = WorkerFarm.getWorkerFarm(options);\n  const workerPool = workerFarm.getWorkerPool({name, url});\n\n  // options.log object contains functions which cannot be transferred\n  // context.fetch & context.parse functions cannot be transferred\n  // TODO - decide how to handle logging on workers\n  options = JSON.parse(JSON.stringify(options));\n  context = JSON.parse(JSON.stringify(context || {}));\n\n  const job = await workerPool.startJob(\n    'process-on-worker',\n    // @ts-expect-error\n    onMessage.bind(null, parseOnMainThread) // eslint-disable-line @typescript-eslint/no-misused-promises\n  );\n\n  job.postMessage('process', {\n    // @ts-ignore\n    input: data,\n    options,\n    context\n  });\n\n  const result = await job.result;\n  // TODO - what is going on here?\n  return await result.result;\n}\n\n/**\n * Handle worker's responses to the main thread\n * @param job\n * @param type\n * @param payload\n */\nasync function onMessage(\n  parseOnMainThread: (arrayBuffer: ArrayBuffer, options?: {[key: string]: any}) => Promise<void>,\n  job: WorkerJob,\n  type: WorkerMessageType,\n  payload: WorkerMessagePayload\n) {\n  switch (type) {\n    case 'done':\n      job.done(payload);\n      break;\n\n    case 'error':\n      job.error(new Error(payload.error));\n      break;\n\n    case 'process':\n      // Worker is asking for main thread to parseO\n      const {id, input, options} = payload;\n      try {\n        const result = await parseOnMainThread(input, options);\n        job.postMessage('done', {id, result});\n      } catch (error) {\n        const message = error instanceof Error ? error.message : 'unknown error';\n        job.postMessage('error', {id, error: message});\n      }\n      break;\n\n    default:\n      // eslint-disable-next-line\n      console.warn(`parse-with-worker unknown message ${type}`);\n  }\n}\n","// Replacement for the external assert method to reduce bundle size\n// Note: We don't use the second \"message\" argument in calling code,\n// so no need to support it here\n\n/** Throws an `Error` with the optional `message` if `condition` is falsy */\nexport function assert(condition: any, message?: string): void {\n  if (!condition) {\n    throw new Error(message || 'loaders.gl assertion failed.');\n  }\n}\n","// Purpose: include this in your module to avoids adding dependencies on\n// micro modules like 'global' and 'is-browser';\n\n/* eslint-disable no-restricted-globals */\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\n\nconst self_: {[key: string]: any} = globals.self || globals.window || globals.global || {};\nconst window_: {[key: string]: any} = globals.window || globals.self || globals.global || {};\nconst global_: {[key: string]: any} = globals.global || globals.self || globals.window || {};\nconst document_: {[key: string]: any} = globals.document || {};\n\nexport {self_ as self, window_ as window, global_ as global, document_ as document};\n\n/** true if running in the browser, false if running in Node.js */\nexport const isBrowser: boolean =\n  // @ts-ignore process.browser\n  typeof process !== 'object' || String(process) !== '[object process]' || process.browser;\n\n/** true if running on a worker thread */\nexport const isWorker: boolean = typeof importScripts === 'function';\n\n/** true if running on a mobile device */\nexport const isMobile: boolean =\n  typeof window !== 'undefined' && typeof window.orientation !== 'undefined';\n\n// Extract node major version\nconst matches =\n  typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n\n/** Version of Node.js if running under Node, otherwise 0 */\nexport const nodeVersion: number = (matches && parseFloat(matches[1])) || 0;\n","// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n\n// Change to `latest` on production branches\nconst DEFAULT_VERSION = 'beta';\ndeclare let __VERSION__: string;\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : DEFAULT_VERSION;\nif (typeof __VERSION__ === 'undefined') {\n  // eslint-disable-next-line\n  console.error(\n    'loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN.'\n  );\n}\n","// Browser fills for Node.js built-in `worker_threads` module.\n// These fills are non-functional, and just intended to ensure that\n// `import 'worker_threads` doesn't break browser builds.\n// The replacement is done in package.json browser field\nexport class Worker {\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  terminate() {}\n}\n\nexport {Worker as NodeWorker};\nexport {Worker as NodeWorkerType};\n\nexport const parentPort = null;\n","// loaders.gl, MIT license\n\nimport type {WorkerObject, WorkerOptions} from '../../types';\nimport {assert} from '../env-utils/assert';\nimport {VERSION as __VERSION__} from '../env-utils/version';\n\nconst NPM_TAG = 'beta'; // 'beta', or 'latest' on release-branch\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : NPM_TAG;\n\n/**\n * Gets worker object's name (for debugging in Chrome thread inspector window)\n */\nexport function getWorkerName(worker: WorkerObject): string {\n  const warning = worker.version !== VERSION ? ` (worker-utils@${VERSION})` : '';\n  return `${worker.name}@${worker.version}${warning}`;\n}\n\n/**\n * Generate a worker URL based on worker object and options\n * @returns A URL to one of the following:\n * - a published worker on unpkg CDN\n * - a local test worker\n * - a URL provided by the user in options\n */\nexport function getWorkerURL(worker: WorkerObject, options: WorkerOptions = {}): string {\n  const workerOptions = options[worker.id] || {};\n\n  const workerFile = `${worker.id}-worker.js`;\n\n  let url = workerOptions.workerUrl;\n\n  // HACK: Allow for non-nested workerUrl for the CompressionWorker.\n  // For the compression worker, workerOptions is currently not nested correctly. For most loaders,\n  // you'd have options within an object, i.e. `{mvt: {coordinates: ...}}` but the CompressionWorker\n  // puts options at the top level, not within a `compression` key (its `id`). For this reason, the\n  // above `workerOptions` will always be a string (i.e. `'gzip'`) for the CompressionWorker. To not\n  // break backwards compatibility, we allow the CompressionWorker to have options at the top level.\n  if (!url && worker.id === 'compression') {\n    url = options.workerUrl;\n  }\n\n  // If URL is test, generate local loaders.gl url\n  // @ts-ignore _workerType\n  if (options._workerType === 'test') {\n    url = `modules/${worker.module}/dist/${workerFile}`;\n  }\n\n  // If url override is not provided, generate a URL to published version on npm CDN unpkg.com\n  if (!url) {\n    // GENERATE\n    let version = worker.version;\n    // On master we need to load npm alpha releases published with the `beta` tag\n    if (version === 'latest') {\n      // throw new Error('latest worker version specified');\n      version = NPM_TAG;\n    }\n    const versionTag = version ? `@${version}` : '';\n    url = `https://unpkg.com/@loaders.gl/${worker.module}${versionTag}/dist/${workerFile}`;\n  }\n\n  assert(url);\n\n  // Allow user to override location\n  return url;\n}\n","import type {WorkerObject} from '../../types';\nimport {assert} from '../env-utils/assert';\nimport {VERSION} from '../env-utils/version';\n\n/**\n * Check if worker is compatible with this library version\n * @param worker\n * @param libVersion\n * @returns `true` if the two versions are compatible\n */\nexport function validateWorkerVersion(\n  worker: WorkerObject,\n  coreVersion: string = VERSION\n): boolean {\n  assert(worker, 'no worker provided');\n\n  const workerVersion = worker.version;\n  if (!coreVersion || !workerVersion) {\n    return false;\n  }\n\n  // TODO enable when fix the __version__ injection\n  // const coreVersions = parseVersion(coreVersion);\n  // const workerVersions = parseVersion(workerVersion);\n  // assert(\n  //   coreVersion.major === workerVersion.major && coreVersion.minor <= workerVersion.minor,\n  //   `worker: ${worker.name} is not compatible. ${coreVersion.major}.${\n  //     coreVersion.minor\n  //   }+ is required.`\n  // );\n\n  return true;\n}\n\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction parseVersion(version) {\n  const parts = version.split('.').map(Number);\n  return {major: parts[0], minor: parts[1]};\n}\n","import WorkerPool from './worker-pool';\nimport WorkerThread from './worker-thread';\n\n/**\n * @param maxConcurrency - max count of workers\n * @param maxMobileConcurrency - max count of workers on mobile\n * @param maxConcurrency - max count of workers\n * @param reuseWorkers - if false, destroys workers when task is completed\n * @param onDebug - callback intended to allow application to log worker pool activity\n */\nexport type WorkerFarmProps = {\n  maxConcurrency?: number;\n  maxMobileConcurrency?: number;\n  reuseWorkers?: boolean;\n  onDebug?: () => void;\n};\n\nconst DEFAULT_PROPS: Required<WorkerFarmProps> = {\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  reuseWorkers: true,\n  onDebug: () => {}\n};\n\n/**\n * Process multiple jobs with a \"farm\" of different workers in worker pools.\n */\nexport default class WorkerFarm {\n  private props: WorkerFarmProps;\n  private workerPools = new Map<string, WorkerPool>();\n  // singleton\n  private static _workerFarm?: WorkerFarm;\n\n  /** Checks if workers are supported on this platform */\n  static isSupported(): boolean {\n    return WorkerThread.isSupported();\n  }\n\n  /** Get the singleton instance of the global worker farm */\n  static getWorkerFarm(props: WorkerFarmProps = {}): WorkerFarm {\n    WorkerFarm._workerFarm = WorkerFarm._workerFarm || new WorkerFarm({});\n    WorkerFarm._workerFarm.setProps(props);\n    return WorkerFarm._workerFarm;\n  }\n\n  /** get global instance with WorkerFarm.getWorkerFarm() */\n  private constructor(props: WorkerFarmProps) {\n    this.props = {...DEFAULT_PROPS};\n    this.setProps(props);\n    /** @type Map<string, WorkerPool>} */\n    this.workerPools = new Map();\n  }\n\n  /**\n   * Terminate all workers in the farm\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.destroy();\n    }\n    this.workerPools = new Map<string, WorkerPool>();\n  }\n\n  /**\n   * Set props used when initializing worker pools\n   * @param props\n   */\n  setProps(props: WorkerFarmProps): void {\n    this.props = {...this.props, ...props};\n    // Update worker pool props\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.setProps(this._getWorkerPoolProps());\n    }\n  }\n\n  /**\n   * Returns a worker pool for the specified worker\n   * @param options - only used first time for a specific worker name\n   * @param options.name - the name of the worker - used to identify worker pool\n   * @param options.url -\n   * @param options.source -\n   * @example\n   *   const job = WorkerFarm.getWorkerFarm().getWorkerPool({name, url}).startJob(...);\n   */\n  getWorkerPool(options: {name: string; source?: string; url?: string}): WorkerPool {\n    const {name, source, url} = options;\n    let workerPool = this.workerPools.get(name);\n    if (!workerPool) {\n      workerPool = new WorkerPool({\n        name,\n        source,\n        url\n      });\n      workerPool.setProps(this._getWorkerPoolProps());\n      this.workerPools.set(name, workerPool);\n    }\n    return workerPool;\n  }\n\n  _getWorkerPoolProps() {\n    return {\n      maxConcurrency: this.props.maxConcurrency,\n      maxMobileConcurrency: this.props.maxMobileConcurrency,\n      reuseWorkers: this.props.reuseWorkers,\n      onDebug: this.props.onDebug\n    };\n  }\n}\n","import type {WorkerMessageType, WorkerMessagePayload} from '../../types';\nimport WorkerThread from './worker-thread';\nimport {assert} from '../env-utils/assert';\n\n/**\n * Represents one Job handled by a WorkerPool or WorkerFarm\n */\nexport default class WorkerJob {\n  readonly name: string;\n  readonly workerThread: WorkerThread;\n  isRunning: boolean = true;\n  /** Promise that resolves when Job is done */\n  readonly result: Promise<any>;\n\n  private _resolve: (value: any) => void = () => {};\n  private _reject: (reason?: any) => void = () => {};\n\n  constructor(jobName: string, workerThread: WorkerThread) {\n    this.name = jobName;\n    this.workerThread = workerThread;\n    this.result = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  /**\n   * Send a message to the job's worker thread\n   * @param data any data structure, ideally consisting mostly of transferrable objects\n   */\n  postMessage(type: WorkerMessageType, payload: WorkerMessagePayload): void {\n    this.workerThread.postMessage({\n      source: 'loaders.gl', // Lets worker ignore unrelated messages\n      type,\n      payload\n    });\n  }\n\n  /**\n   * Call to resolve the `result` Promise with the supplied value\n   */\n  done(value: any): void {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._resolve(value);\n  }\n\n  /**\n   * Call to reject the `result` Promise with the supplied error\n   */\n  error(error: Error): void {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._reject(error);\n  }\n}\n","import type {WorkerMessageType, WorkerMessagePayload} from '../../types';\nimport {isMobile} from '../env-utils/globals';\nimport WorkerThread from './worker-thread';\nimport WorkerJob from './worker-job';\n\n/** WorkerPool onDebug Callback Parameters */\ntype OnDebugParameters = {\n  message: string;\n  worker: string;\n  name: string;\n  job: string;\n  backlog: number;\n  workerThread: WorkerThread;\n};\n\n/** WorkerPool Properties */\nexport type WorkerPoolProps = {\n  name?: string;\n  source?: string; // | Function;\n  url?: string;\n  maxConcurrency?: number;\n  maxMobileConcurrency?: number;\n  onDebug?: (options: OnDebugParameters) => any;\n  reuseWorkers?: boolean;\n};\n\n/** Private helper types */\ntype OnMessage = (job: WorkerJob, type: WorkerMessageType, payload: WorkerMessagePayload) => void;\ntype OnError = (job: WorkerJob, error: Error) => void;\n\ntype QueuedJob = {\n  name: string;\n  onMessage: OnMessage;\n  onError: OnError;\n  onStart: (value: any) => void; // Resolve job start promise\n};\n\n/**\n * Process multiple data messages with small pool of identical workers\n */\nexport default class WorkerPool {\n  name: string = 'unnamed';\n  source?: string; // | Function;\n  url?: string;\n  maxConcurrency: number = 1;\n  maxMobileConcurrency: number = 1;\n  onDebug: (options: OnDebugParameters) => any = () => {};\n  reuseWorkers: boolean = true;\n\n  private props: WorkerPoolProps = {};\n  private jobQueue: QueuedJob[] = [];\n  private idleQueue: WorkerThread[] = [];\n  private count = 0;\n  private isDestroyed = false;\n\n  /** Checks if workers are supported on this platform */\n  static isSupported(): boolean {\n    return WorkerThread.isSupported();\n  }\n\n  /**\n   * @param processor - worker function\n   * @param maxConcurrency - max count of workers\n   */\n  constructor(props: WorkerPoolProps) {\n    this.source = props.source;\n    this.url = props.url;\n    this.setProps(props);\n  }\n\n  /**\n   * Terminates all workers in the pool\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    // Destroy idle workers, active Workers will be destroyed on completion\n    this.idleQueue.forEach((worker) => worker.destroy());\n    this.isDestroyed = true;\n  }\n\n  setProps(props: WorkerPoolProps) {\n    this.props = {...this.props, ...props};\n\n    if (props.name !== undefined) {\n      this.name = props.name;\n    }\n    if (props.maxConcurrency !== undefined) {\n      this.maxConcurrency = props.maxConcurrency;\n    }\n    if (props.maxMobileConcurrency !== undefined) {\n      this.maxMobileConcurrency = props.maxMobileConcurrency;\n    }\n    if (props.reuseWorkers !== undefined) {\n      this.reuseWorkers = props.reuseWorkers;\n    }\n    if (props.onDebug !== undefined) {\n      this.onDebug = props.onDebug;\n    }\n  }\n\n  async startJob(\n    name: string,\n    onMessage: OnMessage = (job, type, data) => job.done(data),\n    onError: OnError = (job, error) => job.error(error)\n  ): Promise<WorkerJob> {\n    // Promise resolves when thread starts working on this job\n    const startPromise = new Promise<WorkerJob>((onStart) => {\n      // Promise resolves when thread completes or fails working on this job\n      this.jobQueue.push({name, onMessage, onError, onStart});\n      return this;\n    });\n    this._startQueuedJob(); // eslint-disable-line @typescript-eslint/no-floating-promises\n    return await startPromise;\n  }\n\n  // PRIVATE\n\n  /**\n   * Starts first queued job if worker is available or can be created\n   * Called when job is started and whenever a worker returns to the idleQueue\n   */\n  async _startQueuedJob(): Promise<void> {\n    if (!this.jobQueue.length) {\n      return;\n    }\n\n    const workerThread = this._getAvailableWorker();\n    if (!workerThread) {\n      return;\n    }\n\n    // We have a worker, dequeue and start the job\n    const queuedJob = this.jobQueue.shift();\n    if (queuedJob) {\n      // Emit a debug event\n      // @ts-ignore\n      this.onDebug({\n        message: 'Starting job',\n        name: queuedJob.name,\n        workerThread,\n        backlog: this.jobQueue.length\n      });\n\n      // Create a worker job to let the app access thread and manage job completion\n      const job = new WorkerJob(queuedJob.name, workerThread);\n\n      // Set the worker thread's message handlers\n      workerThread.onMessage = (data) => queuedJob.onMessage(job, data.type, data.payload);\n      workerThread.onError = (error) => queuedJob.onError(job, error);\n\n      // Resolve the start promise so that the app can start sending messages to worker\n      queuedJob.onStart(job);\n\n      // Wait for the app to signal that the job is complete, then return worker to queue\n      try {\n        await job.result;\n      } finally {\n        this.returnWorkerToQueue(workerThread);\n      }\n    }\n  }\n\n  /**\n   * Returns a worker to the idle queue\n   * Destroys the worker if\n   *  - pool is destroyed\n   *  - if this pool doesn't reuse workers\n   *  - if maxConcurrency has been lowered\n   * @param worker\n   */\n  returnWorkerToQueue(worker: WorkerThread) {\n    const shouldDestroyWorker =\n      this.isDestroyed || !this.reuseWorkers || this.count > this._getMaxConcurrency();\n\n    if (shouldDestroyWorker) {\n      worker.destroy();\n      this.count--;\n    } else {\n      this.idleQueue.push(worker);\n    }\n\n    if (!this.isDestroyed) {\n      this._startQueuedJob(); // eslint-disable-line @typescript-eslint/no-floating-promises\n    }\n  }\n\n  /**\n   * Returns idle worker or creates new worker if maxConcurrency has not been reached\n   */\n  _getAvailableWorker(): WorkerThread | null {\n    // If a worker has completed and returned to the queue, it can be used\n    if (this.idleQueue.length > 0) {\n      return this.idleQueue.shift() || null;\n    }\n\n    // Create fresh worker if we haven't yet created the max amount of worker threads for this worker source\n    if (this.count < this._getMaxConcurrency()) {\n      this.count++;\n      const name = `${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;\n      return new WorkerThread({name, source: this.source, url: this.url});\n    }\n\n    // No worker available, have to wait\n    return null;\n  }\n\n  _getMaxConcurrency() {\n    return isMobile ? this.maxMobileConcurrency : this.maxConcurrency;\n  }\n}\n","// loaders.gl, MIT license\n\nimport {NodeWorker, NodeWorkerType} from '../node/worker_threads';\nimport {isBrowser} from '../env-utils/globals';\nimport {assert} from '../env-utils/assert';\nimport {getLoadableWorkerURL} from '../worker-utils/get-loadable-worker-url';\nimport {getTransferList} from '../worker-utils/get-transfer-list';\n\nconst NOOP = () => {};\n\nexport type WorkerThreadProps = {\n  name: string;\n  source?: string;\n  url?: string;\n};\n\n/**\n * Represents one worker thread\n */\nexport default class WorkerThread {\n  readonly name: string;\n  readonly source: string | undefined;\n  readonly url: string | undefined;\n  terminated: boolean = false;\n  worker: Worker | NodeWorkerType;\n  onMessage: (message: any) => void;\n  onError: (error: Error) => void;\n\n  private _loadableURL: string = '';\n\n  /** Checks if workers are supported on this platform */\n  static isSupported(): boolean {\n    return (\n      (typeof Worker !== 'undefined' && isBrowser) ||\n      (typeof NodeWorker !== 'undefined' && !isBrowser)\n    );\n  }\n\n  constructor(props: WorkerThreadProps) {\n    const {name, source, url} = props;\n    assert(source || url); // Either source or url must be defined\n    this.name = name;\n    this.source = source;\n    this.url = url;\n    this.onMessage = NOOP;\n    this.onError = (error) => console.log(error); // eslint-disable-line\n\n    this.worker = isBrowser ? this._createBrowserWorker() : this._createNodeWorker();\n  }\n\n  /**\n   * Terminate this worker thread\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    this.onMessage = NOOP;\n    this.onError = NOOP;\n    this.worker.terminate(); // eslint-disable-line @typescript-eslint/no-floating-promises\n    this.terminated = true;\n  }\n\n  get isRunning() {\n    return Boolean(this.onMessage);\n  }\n\n  /**\n   * Send a message to this worker thread\n   * @param data any data structure, ideally consisting mostly of transferrable objects\n   * @param transferList If not supplied, calculated automatically by traversing data\n   */\n  postMessage(data: any, transferList?: any[]): void {\n    transferList = transferList || getTransferList(data);\n    // @ts-ignore\n    this.worker.postMessage(data, transferList);\n  }\n\n  // PRIVATE\n\n  /**\n   * Generate a standard Error from an ErrorEvent\n   * @param event\n   */\n  _getErrorFromErrorEvent(event: ErrorEvent): Error {\n    // Note Error object does not have the expected fields if loading failed completely\n    // https://developer.mozilla.org/en-US/docs/Web/API/Worker#Event_handlers\n    // https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent\n    let message = 'Failed to load ';\n    message += `worker ${this.name} from ${this.url}. `;\n    if (event.message) {\n      message += `${event.message} in `;\n    }\n    // const hasFilename = event.filename && !event.filename.startsWith('blob:');\n    // message += hasFilename ? event.filename : this.source.slice(0, 100);\n    if (event.lineno) {\n      message += `:${event.lineno}:${event.colno}`;\n    }\n    return new Error(message);\n  }\n\n  /**\n   * Creates a worker thread on the browser\n   */\n  _createBrowserWorker(): Worker {\n    this._loadableURL = getLoadableWorkerURL({source: this.source, url: this.url});\n    const worker = new Worker(this._loadableURL, {name: this.name});\n\n    worker.onmessage = (event) => {\n      if (!event.data) {\n        this.onError(new Error('No data received'));\n      } else {\n        this.onMessage(event.data);\n      }\n    };\n    // This callback represents an uncaught exception in the worker thread\n    worker.onerror = (error: ErrorEvent): void => {\n      this.onError(this._getErrorFromErrorEvent(error));\n      this.terminated = true;\n    };\n    // TODO - not clear when this would be called, for now just log in case it happens\n    worker.onmessageerror = (event) => console.error(event); // eslint-disable-line\n\n    return worker;\n  }\n\n  /**\n   * Creates a worker thread in node.js\n   * @todo https://nodejs.org/api/async_hooks.html#async-resource-worker-pool\n   */\n  _createNodeWorker(): NodeWorkerType {\n    let worker: NodeWorkerType;\n    if (this.url) {\n      // Make sure relative URLs start with './'\n      const absolute = this.url.includes(':/') || this.url.startsWith('/');\n      const url = absolute ? this.url : `./${this.url}`;\n      // console.log('Starting work from', url);\n      worker = new NodeWorker(url, {eval: false});\n    } else if (this.source) {\n      worker = new NodeWorker(this.source, {eval: true});\n    } else {\n      throw new Error('no worker');\n    }\n    worker.on('message', (data) => {\n      // console.error('message', data);\n      this.onMessage(data);\n    });\n    worker.on('error', (error) => {\n      // console.error('error', error);\n      this.onError(error);\n    });\n    worker.on('exit', (code) => {\n      // console.error('exit', code);\n    });\n    return worker;\n  }\n}\n","import {assert} from '../env-utils/assert';\n\nconst workerURLCache = new Map();\n\n/**\n * Creates a loadable URL from worker source or URL\n * that can be used to create `Worker` instances.\n * Due to CORS issues it may be necessary to wrap a URL in a small importScripts\n * @param props\n * @param props.source Worker source\n * @param props.url Worker URL\n * @returns loadable url\n */\nexport function getLoadableWorkerURL(props: {source?: string; url?: string}) {\n  assert((props.source && !props.url) || (!props.source && props.url)); // Either source or url must be defined\n\n  let workerURL = workerURLCache.get(props.source || props.url);\n  if (!workerURL) {\n    // Differentiate worker urls from worker source code\n    if (props.url) {\n      workerURL = getLoadableWorkerURLFromURL(props.url);\n      workerURLCache.set(props.url, workerURL);\n    }\n\n    if (props.source) {\n      workerURL = getLoadableWorkerURLFromSource(props.source);\n      workerURLCache.set(props.source, workerURL);\n    }\n  }\n\n  assert(workerURL);\n  return workerURL;\n}\n\n/**\n * Build a loadable worker URL from worker URL\n * @param url\n * @returns loadable URL\n */\nfunction getLoadableWorkerURLFromURL(url: string): string {\n  // A local script url, we can use it to initialize a Worker directly\n  if (!url.startsWith('http')) {\n    return url;\n  }\n\n  // A remote script, we need to use `importScripts` to load from different origin\n  const workerSource = buildScriptSource(url);\n  return getLoadableWorkerURLFromSource(workerSource);\n}\n\n/**\n * Build a loadable worker URL from worker source\n * @param workerSource\n * @returns loadable url\n */\nfunction getLoadableWorkerURLFromSource(workerSource: string): string {\n  const blob = new Blob([workerSource], {type: 'application/javascript'});\n  return URL.createObjectURL(blob);\n}\n\n/**\n * Per spec, worker cannot be initialized with a script from a different origin\n * However a local worker script can still import scripts from other origins,\n * so we simply build a wrapper script.\n *\n * @param workerUrl\n * @returns source\n */\nfunction buildScriptSource(workerUrl: string): string {\n  return `\\\ntry {\n  importScripts('${workerUrl}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`;\n}\n","// NOTE - there is a copy of this function is both in core and loader-utils\n// core does not need all the utils in loader-utils, just this one.\n\n/**\n * Returns an array of Transferrable objects that can be used with postMessage\n * https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage\n * @param object data to be sent via postMessage\n * @param recursive - not for application use\n * @param transfers - not for application use\n * @returns a transfer list that can be passed to postMessage\n */\nexport function getTransferList(\n  object: any,\n  recursive: boolean = true,\n  transfers?: Set<any>\n): Transferable[] {\n  // Make sure that items in the transfer list is unique\n  const transfersSet = transfers || new Set();\n\n  if (!object) {\n    // ignore\n  } else if (isTransferable(object)) {\n    transfersSet.add(object);\n  } else if (isTransferable(object.buffer)) {\n    // Typed array\n    transfersSet.add(object.buffer);\n  } else if (ArrayBuffer.isView(object)) {\n    // object is a TypeArray viewing into a SharedArrayBuffer (not transferable)\n    // Do not iterate through the content in this case\n  } else if (recursive && typeof object === 'object') {\n    for (const key in object) {\n      // Avoid perf hit - only go one level deep\n      getTransferList(object[key], recursive, transfersSet);\n    }\n  }\n\n  // If transfers is defined, is internal recursive call\n  // Otherwise it's called by the user\n  return transfers === undefined ? Array.from(transfersSet) : [];\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Transferable\nfunction isTransferable(object: unknown) {\n  if (!object) {\n    return false;\n  }\n  if (object instanceof ArrayBuffer) {\n    return true;\n  }\n  if (typeof MessagePort !== 'undefined' && object instanceof MessagePort) {\n    return true;\n  }\n  if (typeof ImageBitmap !== 'undefined' && object instanceof ImageBitmap) {\n    return true;\n  }\n  // @ts-ignore\n  if (typeof OffscreenCanvas !== 'undefined' && object instanceof OffscreenCanvas) {\n    return true;\n  }\n  return false;\n}\n\n/**\n * Recursively drop non serializable values like functions and regexps.\n * @param object\n */\nexport function getTransferListForWriter(object: object | null): object {\n  if (object === null) {\n    return {};\n  }\n  const clone = Object.assign({}, object);\n\n  Object.keys(clone).forEach((key) => {\n    // Typed Arrays and Arrays are passed with no change\n    if (\n      typeof object[key] === 'object' &&\n      !ArrayBuffer.isView(object[key]) &&\n      !(object[key] instanceof Array)\n    ) {\n      clone[key] = getTransferListForWriter(object[key]);\n    } else if (typeof clone[key] === 'function' || clone[key] instanceof RegExp) {\n      clone[key] = {};\n    } else {\n      clone[key] = object[key];\n    }\n  });\n\n  return clone;\n}\n","import {uid, assert} from '@luma.gl/webgl';\n\n// Rendering primitives - specify how to extract primitives from vertices.\n// NOTE: These are numerically identical to the corresponding WebGL/OpenGL constants\nexport const DRAW_MODE = {\n  POINTS: 0x0000, // draw single points.\n  LINES: 0x0001, // draw lines. Each vertex connects to the one after it.\n  LINE_LOOP: 0x0002, // draw lines. Each set of two vertices is treated as a separate line segment.\n  LINE_STRIP: 0x0003, // draw a connected group of line segments from the first vertex to the last\n  TRIANGLES: 0x0004, // draw triangles. Each set of three vertices creates a separate triangle.\n  TRIANGLE_STRIP: 0x0005, // draw a connected group of triangles.\n  TRIANGLE_FAN: 0x0006 // draw a connected group of triangles.\n  // Each vertex connects to the previous and the first vertex in the fan.\n};\n\nexport default class Geometry {\n  static get DRAW_MODE() {\n    return DRAW_MODE;\n  }\n\n  constructor(props = {}) {\n    const {\n      id = uid('geometry'),\n      drawMode = DRAW_MODE.TRIANGLES,\n      attributes = {},\n      indices = null,\n      vertexCount = null\n    } = props;\n\n    this.id = id;\n    this.drawMode = drawMode | 0;\n    this.attributes = {};\n    this.userData = {};\n\n    this._setAttributes(attributes, indices);\n\n    this.vertexCount = vertexCount || this._calculateVertexCount(this.attributes, this.indices);\n\n    // stubRemovedMethods(this, [\n    //   'setNeedsRedraw', 'needsRedraw', 'setAttributes'\n    // ], 'Immutable');\n\n    // stubRemovedMethods(this, [\n    //   'hasAttribute', 'getAttribute', 'getArray'\n    // ], 'Use geometry.attributes and geometry.indices');\n\n    // deprecateMethods(this, ['getAttributes'])\n  }\n\n  get mode() {\n    return this.drawMode;\n  }\n\n  getVertexCount() {\n    return this.vertexCount;\n  }\n\n  // Return an object with all attributes plus indices added as a field.\n  getAttributes() {\n    return this.indices ? {indices: this.indices, ...this.attributes} : this.attributes;\n  }\n\n  // PRIVATE\n\n  _print(attributeName) {\n    return `Geometry ${this.id} attribute ${attributeName}`;\n  }\n\n  // Attribute\n  // value: typed array\n  // type: indices, vertices, uvs\n  // size: elements per vertex\n  // target: WebGL buffer type (string or constant)\n  _setAttributes(attributes, indices) {\n    if (indices) {\n      this.indices = ArrayBuffer.isView(indices) ? {value: indices, size: 1} : indices;\n    }\n\n    for (const attributeName in attributes) {\n      let attribute = attributes[attributeName];\n\n      // Wrap \"unwrapped\" arrays and try to autodetect their type\n      attribute = ArrayBuffer.isView(attribute) ? {value: attribute} : attribute;\n\n      assert(\n        ArrayBuffer.isView(attribute.value),\n        `${this._print(attributeName)}: must be typed array or object with value as typed array`\n      );\n\n      if ((attributeName === 'POSITION' || attributeName === 'positions') && !attribute.size) {\n        attribute.size = 3;\n      }\n\n      // Move indices to separate field\n      if (attributeName === 'indices') {\n        assert(!this.indices);\n        this.indices = attribute;\n      } else {\n        this.attributes[attributeName] = attribute;\n      }\n    }\n\n    if (this.indices && this.indices.isIndexed !== undefined) {\n      this.indices = Object.assign({}, this.indices);\n      delete this.indices.isIndexed;\n    }\n\n    return this;\n  }\n\n  _calculateVertexCount(attributes, indices) {\n    if (indices) {\n      return indices.value.length;\n    }\n    let vertexCount = Infinity;\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n      const {value, size, constant} = attribute;\n      if (!constant && value && size >= 1) {\n        vertexCount = Math.min(vertexCount, value.length / size);\n      }\n    }\n\n    assert(Number.isFinite(vertexCount));\n    return vertexCount;\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {Buffer, assert} from '@luma.gl/webgl';\n\n// Support for mapping new geometries with glTF attribute names to \"classic\" luma.gl shader names\nconst GLTF_TO_LUMA_ATTRIBUTE_MAP = {\n  POSITION: 'positions',\n  NORMAL: 'normals',\n  COLOR_0: 'colors',\n  TEXCOORD_0: 'texCoords',\n  TEXCOORD_1: 'texCoords1',\n  TEXCOORD_2: 'texCoords2'\n};\n\nexport function getBuffersFromGeometry(gl, geometry, options) {\n  const buffers = {};\n  let indices = geometry.indices;\n\n  for (const name in geometry.attributes) {\n    const attribute = geometry.attributes[name];\n    const remappedName = mapAttributeName(name, options);\n\n    if (name === 'indices') {\n      indices = attribute;\n    } else if (attribute.constant) {\n      buffers[remappedName] = attribute.value;\n    } else {\n      const typedArray = attribute.value;\n      // Create accessor by copying the attribute and removing `value``\n      const accessor = {...attribute};\n      delete accessor.value;\n      buffers[remappedName] = [new Buffer(gl, typedArray), accessor];\n\n      inferAttributeAccessor(name, accessor);\n    }\n  }\n\n  if (indices) {\n    const data = indices.value || indices;\n    assert(\n      data instanceof Uint16Array || data instanceof Uint32Array,\n      'attribute array for \"indices\" must be of integer type'\n    );\n    const accessor = {\n      size: 1,\n      isIndexed: indices.isIndexed === undefined ? true : indices.isIndexed\n    };\n    buffers.indices = [\n      new Buffer(gl, {\n        data,\n        target: GL.ELEMENT_ARRAY_BUFFER\n      }),\n      accessor\n    ];\n  }\n\n  return buffers;\n}\n\nfunction mapAttributeName(name, options) {\n  const {attributeMap = GLTF_TO_LUMA_ATTRIBUTE_MAP} = options || {};\n  return (attributeMap && attributeMap[name]) || name;\n}\n\n// Check for well known attribute names\n// eslint-disable-next-line complexity\nexport function inferAttributeAccessor(attributeName, attribute) {\n  let category;\n  switch (attributeName) {\n    case 'texCoords':\n    case 'texCoord1':\n    case 'texCoord2':\n    case 'texCoord3':\n      category = 'uvs';\n      break;\n    case 'vertices':\n    case 'positions':\n    case 'normals':\n    case 'pickingColors':\n      category = 'vectors';\n      break;\n    default:\n  }\n\n  // Check for categorys\n  switch (category) {\n    case 'vectors':\n      attribute.size = attribute.size || 3;\n      break;\n    case 'uvs':\n      attribute.size = attribute.size || 2;\n      break;\n    default:\n  }\n\n  assert(Number.isFinite(attribute.size), `attribute ${attributeName} needs size`);\n}\n","/* eslint-disable complexity */\n\nimport GL from '@luma.gl/constants';\nimport {isWebGL} from '@luma.gl/gltools';\nimport ProgramManager from './program-manager';\nimport {\n  Program,\n  VertexArray,\n  clear,\n  TransformFeedback,\n  Buffer,\n  log,\n  isObjectEmpty,\n  uid,\n  assert\n} from '@luma.gl/webgl';\nimport {\n  getDebugTableForUniforms,\n  getDebugTableForVertexArray,\n  getDebugTableForProgramConfiguration\n} from '@luma.gl/webgl';\nimport {getBuffersFromGeometry} from './model-utils';\n\nconst LOG_DRAW_PRIORITY = 2;\nconst LOG_DRAW_TIMEOUT = 10000;\n\nconst ERR_MODEL_PARAMS = 'Model needs drawMode and vertexCount';\n\nconst NOOP = () => {};\nconst DRAW_PARAMS = {};\n\nexport default class Model {\n  constructor(gl, props = {}) {\n    // Deduce a helpful id\n    const {id = uid('model')} = props;\n    assert(isWebGL(gl));\n    this.id = id;\n    this.gl = gl;\n    this.id = props.id || uid('Model');\n    this.lastLogTime = 0; // TODO - move to probe.gl\n    this.animated = false;\n    this.initialize(props);\n  }\n\n  initialize(props) {\n    this.props = {};\n\n    this.programManager = props.programManager || ProgramManager.getDefaultProgramManager(this.gl);\n    this._programManagerState = -1;\n    this._managedProgram = false;\n\n    const {\n      program = null,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    } = props;\n\n    this.programProps = {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    };\n    this.program = null;\n    this.vertexArray = null;\n    this._programDirty = true;\n\n    // Initialize state\n    this.userData = {};\n    this.needsRedraw = true;\n\n    // Attributes and buffers\n    // Model manages auto Buffer creation from typed arrays\n    this._attributes = {}; // All attributes\n    this.attributes = {}; // User defined attributes\n\n    // Model manages uniform animation\n    this.uniforms = {};\n\n    // picking options\n    this.pickable = true;\n\n    this._checkProgram();\n\n    this.setUniforms(\n      Object.assign(\n        {},\n        this.getModuleUniforms(props.moduleSettings) // Get unforms for supplied parameters\n      )\n    );\n\n    this.drawMode = props.drawMode !== undefined ? props.drawMode : GL.TRIANGLES;\n    this.vertexCount = props.vertexCount || 0;\n\n    // Track buffers created by setGeometry\n    this.geometryBuffers = {};\n\n    // geometry might have set drawMode and vertexCount\n    this.isInstanced = props.isInstanced || props.instanced || props.instanceCount > 0;\n\n    this._setModelProps(props);\n\n    // TODO - just to unbreak deck.gl 7.0-beta, remove as soon as updated\n    this.geometry = {};\n\n    // assert(program || program instanceof Program);\n    assert(this.drawMode !== undefined && Number.isFinite(this.vertexCount), ERR_MODEL_PARAMS);\n  }\n\n  setProps(props) {\n    this._setModelProps(props);\n  }\n\n  delete() {\n    // delete all attributes created by this model\n    // TODO - should buffer deletes be handled by vertex array?\n    for (const key in this._attributes) {\n      if (this._attributes[key] !== this.attributes[key]) {\n        this._attributes[key].delete();\n      }\n    }\n\n    if (this._managedProgram) {\n      this.programManager.release(this.program);\n      this._managedProgram = false;\n    }\n\n    this.vertexArray.delete();\n\n    this._deleteGeometryBuffers();\n  }\n\n  // GETTERS\n\n  getDrawMode() {\n    return this.drawMode;\n  }\n\n  getVertexCount() {\n    return this.vertexCount;\n  }\n\n  getInstanceCount() {\n    return this.instanceCount;\n  }\n\n  getAttributes() {\n    return this.attributes;\n  }\n\n  getProgram() {\n    return this.program;\n  }\n\n  setProgram(props) {\n    const {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    } = props;\n    this.programProps = {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    };\n    this._programDirty = true;\n  }\n\n  getUniforms() {\n    return this.uniforms;\n  }\n\n  // SETTERS\n\n  setDrawMode(drawMode) {\n    this.drawMode = drawMode;\n    return this;\n  }\n\n  setVertexCount(vertexCount) {\n    assert(Number.isFinite(vertexCount));\n    this.vertexCount = vertexCount;\n    return this;\n  }\n\n  setInstanceCount(instanceCount) {\n    assert(Number.isFinite(instanceCount));\n    this.instanceCount = instanceCount;\n    return this;\n  }\n\n  setGeometry(geometry) {\n    this.drawMode = geometry.drawMode;\n    this.vertexCount = geometry.getVertexCount();\n\n    this._deleteGeometryBuffers();\n\n    this.geometryBuffers = getBuffersFromGeometry(this.gl, geometry);\n    this.vertexArray.setAttributes(this.geometryBuffers);\n    return this;\n  }\n\n  setAttributes(attributes = {}) {\n    // Avoid setting needsRedraw if no attributes\n    if (isObjectEmpty(attributes)) {\n      return this;\n    }\n\n    const normalizedAttributes = {};\n    for (const name in attributes) {\n      const attribute = attributes[name];\n      // The `getValue` call provides support for deck.gl `Attribute` class\n      // TODO - remove once deck refactoring completes\n      normalizedAttributes[name] = attribute.getValue ? attribute.getValue() : attribute;\n    }\n\n    this.vertexArray.setAttributes(normalizedAttributes);\n    return this;\n  }\n\n  // TODO - should actually set the uniforms\n  setUniforms(uniforms = {}) {\n    Object.assign(this.uniforms, uniforms);\n\n    return this;\n  }\n\n  getModuleUniforms(opts) {\n    this._checkProgram();\n\n    const getUniforms = this.programManager.getUniforms(this.program);\n\n    if (getUniforms) {\n      return getUniforms(opts);\n    }\n\n    return {};\n  }\n\n  updateModuleSettings(opts) {\n    const uniforms = this.getModuleUniforms(opts || {});\n    return this.setUniforms(uniforms);\n  }\n\n  // DRAW CALLS\n\n  clear(opts) {\n    clear(this.program.gl, opts);\n    return this;\n  }\n\n  draw(opts = {}) {\n    // Lazy update program and vertex array\n    this._checkProgram();\n\n    const {\n      moduleSettings = null,\n      framebuffer,\n      uniforms = {},\n      attributes = {},\n      transformFeedback = this.transformFeedback,\n      parameters = {},\n      vertexArray = this.vertexArray\n    } = opts;\n\n    // Update model with any just provided attributes, settings or uniforms\n    this.setAttributes(attributes);\n    this.updateModuleSettings(moduleSettings);\n    this.setUniforms(uniforms);\n\n    let logPriority;\n\n    if (log.priority >= LOG_DRAW_PRIORITY) {\n      logPriority = this._logDrawCallStart(LOG_DRAW_PRIORITY);\n    }\n\n    const drawParams = this.vertexArray.getDrawParams();\n    const {\n      isIndexed = drawParams.isIndexed,\n      indexType = drawParams.indexType,\n      indexOffset = drawParams.indexOffset,\n      vertexArrayInstanced = drawParams.isInstanced\n    } = this.props;\n\n    if (vertexArrayInstanced && !this.isInstanced) {\n      log.warn('Found instanced attributes on non-instanced model', this.id)();\n    }\n\n    const {isInstanced, instanceCount} = this;\n\n    const {onBeforeRender = NOOP, onAfterRender = NOOP} = this.props;\n\n    onBeforeRender();\n\n    this.program.setUniforms(this.uniforms);\n\n    const didDraw = this.program.draw(\n      Object.assign(DRAW_PARAMS, opts, {\n        logPriority,\n        uniforms: null, // Already set (may contain \"function values\" not understood by Program)\n        framebuffer,\n        parameters,\n        drawMode: this.getDrawMode(),\n        vertexCount: this.getVertexCount(),\n        vertexArray,\n        transformFeedback,\n        isIndexed,\n        indexType,\n        isInstanced,\n        instanceCount,\n        offset: isIndexed ? indexOffset : 0\n      })\n    );\n\n    onAfterRender();\n\n    if (log.priority >= LOG_DRAW_PRIORITY) {\n      this._logDrawCallEnd(logPriority, vertexArray, framebuffer);\n    }\n\n    return didDraw;\n  }\n\n  // Draw call for transform feedback\n  transform(opts = {}) {\n    const {discard = true, feedbackBuffers, unbindModels = []} = opts;\n\n    let {parameters} = opts;\n\n    if (feedbackBuffers) {\n      this._setFeedbackBuffers(feedbackBuffers);\n    }\n\n    if (discard) {\n      parameters = Object.assign({}, parameters, {[GL.RASTERIZER_DISCARD]: discard});\n    }\n\n    unbindModels.forEach(model => model.vertexArray.unbindBuffers());\n    try {\n      this.draw(Object.assign({}, opts, {parameters}));\n    } finally {\n      unbindModels.forEach(model => model.vertexArray.bindBuffers());\n    }\n\n    return this;\n  }\n\n  // DEPRECATED METHODS\n\n  render(uniforms = {}) {\n    log.warn('Model.render() is deprecated. Use Model.setUniforms() and Model.draw()')();\n    return this.setUniforms(uniforms).draw();\n  }\n\n  // PRIVATE METHODS\n\n  _setModelProps(props) {\n    Object.assign(this.props, props);\n\n    if ('uniforms' in props) {\n      this.setUniforms(props.uniforms);\n    }\n\n    if ('pickable' in props) {\n      this.pickable = props.pickable;\n    }\n\n    if ('instanceCount' in props) {\n      this.instanceCount = props.instanceCount;\n    }\n    if ('geometry' in props) {\n      this.setGeometry(props.geometry);\n    }\n\n    // webgl settings\n    if ('attributes' in props) {\n      this.setAttributes(props.attributes);\n    }\n    if ('_feedbackBuffers' in props) {\n      this._setFeedbackBuffers(props._feedbackBuffers);\n    }\n  }\n\n  _checkProgram() {\n    const needsUpdate =\n      this._programDirty || this.programManager.stateHash !== this._programManagerState;\n\n    if (!needsUpdate) {\n      return;\n    }\n\n    let {program} = this.programProps;\n\n    if (program) {\n      this._managedProgram = false;\n    } else {\n      const {\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        varyings,\n        bufferMode,\n        transpileToGLSL100\n      } = this.programProps;\n      program = this.programManager.get({\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        varyings,\n        bufferMode,\n        transpileToGLSL100\n      });\n      if (this.program && this._managedProgram) {\n        this.programManager.release(this.program);\n      }\n      this._programManagerState = this.programManager.stateHash;\n      this._managedProgram = true;\n    }\n\n    assert(program instanceof Program, 'Model needs a program');\n\n    this._programDirty = false;\n\n    if (program === this.program) {\n      return;\n    }\n\n    this.program = program;\n\n    if (this.vertexArray) {\n      // @ts-ignore TODO\n      this.vertexArray.setProps({program: this.program, attributes: this.vertexArray.attributes});\n    } else {\n      this.vertexArray = new VertexArray(this.gl, {program: this.program});\n    }\n\n    // Make sure we have some reasonable default uniforms in place\n    this.setUniforms(\n      Object.assign(\n        {},\n        this.getModuleUniforms() // Get all default uniforms,\n      )\n    );\n  }\n\n  _deleteGeometryBuffers() {\n    for (const name in this.geometryBuffers) {\n      // Buffer is raw value (for indices) or first element of [buffer, accessor] pair\n      const buffer = this.geometryBuffers[name][0] || this.geometryBuffers[name];\n      if (buffer instanceof Buffer) {\n        buffer.delete();\n      }\n    }\n  }\n\n  // Updates (evaluates) all function valued uniforms based on a new set of animationProps\n  // experimental\n  _setAnimationProps(animationProps) {\n    if (this.animated) {\n      assert(animationProps, 'Model.draw(): animated uniforms but no animationProps');\n      // const animatedUniforms = this._evaluateAnimateUniforms(animationProps);\n      // Object.assign(this.uniforms, animatedUniforms);\n    }\n  }\n\n  // Transform Feedback\n\n  _setFeedbackBuffers(feedbackBuffers = {}) {\n    // Avoid setting needsRedraw if no feedbackBuffers\n    if (isObjectEmpty(feedbackBuffers)) {\n      return this;\n    }\n\n    const {gl} = this.program;\n    this.transformFeedback =\n      this.transformFeedback ||\n      new TransformFeedback(gl, {\n        program: this.program\n      });\n\n    this.transformFeedback.setBuffers(feedbackBuffers);\n    return this;\n  }\n\n  _logDrawCallStart(logLevel) {\n    const logDrawTimeout = logLevel > 3 ? 0 : LOG_DRAW_TIMEOUT;\n    if (Date.now() - this.lastLogTime < logDrawTimeout) {\n      return undefined;\n    }\n\n    this.lastLogTime = Date.now();\n\n    log.group(LOG_DRAW_PRIORITY, `>>> DRAWING MODEL ${this.id}`, {collapsed: log.level <= 2})();\n\n    return logLevel;\n  }\n\n  _logDrawCallEnd(logLevel, vertexArray, uniforms, framebuffer) {\n    // HACK: logLevel === undefined means logDrawCallStart didn't run\n    if (logLevel === undefined) {\n      return;\n    }\n\n    const attributeTable = getDebugTableForVertexArray({\n      vertexArray,\n      header: `${this.id} attributes`,\n      // @ts-ignore\n      attributes: this._attributes\n    });\n\n    const {table: uniformTable, unusedTable, unusedCount} = getDebugTableForUniforms({\n      header: `${this.id} uniforms`,\n      program: this.program,\n      uniforms: Object.assign({}, this.program.uniforms, uniforms)\n    });\n\n    // log missing uniforms\n    const {table: missingTable, count: missingCount} = getDebugTableForUniforms({\n      header: `${this.id} uniforms`,\n      program: this.program,\n      uniforms: Object.assign({}, this.program.uniforms, uniforms),\n      undefinedOnly: true\n    });\n\n    if (missingCount > 0) {\n      log.log('MISSING UNIFORMS', Object.keys(missingTable))();\n      // log.table(logLevel, missingTable)();\n    }\n    if (unusedCount > 0) {\n      log.log('UNUSED UNIFORMS', Object.keys(unusedTable))();\n      // log.log(logLevel, 'Unused uniforms ', unusedTable)();\n    }\n\n    const configTable = getDebugTableForProgramConfiguration(this.vertexArray.configuration);\n\n    log.table(logLevel, attributeTable)();\n\n    log.table(logLevel, uniformTable)();\n\n    log.table(logLevel + 1, configTable)();\n\n    if (framebuffer) {\n      framebuffer.log({logLevel: LOG_DRAW_PRIORITY, message: `Rendered to ${framebuffer.id}`});\n    }\n\n    log.groupEnd(LOG_DRAW_PRIORITY)();\n  }\n}\n","import {assembleShaders} from '@luma.gl/shadertools';\nimport {Program} from '@luma.gl/webgl';\n\nexport default class ProgramManager {\n  static getDefaultProgramManager(gl) {\n    gl.luma = gl.luma || {};\n    gl.luma.defaultProgramManager = gl.luma.defaultProgramManager || new ProgramManager(gl);\n\n    return gl.luma.defaultProgramManager;\n  }\n\n  constructor(gl) {\n    this.gl = gl;\n\n    this._programCache = {};\n    this._getUniforms = {};\n    this._registeredModules = {}; // TODO: Remove? This isn't used anywhere in luma.gl\n    this._hookFunctions = [];\n    this._defaultModules = [];\n\n    this._hashes = {};\n    this._hashCounter = 0;\n    this.stateHash = 0; // Used change hashing if hooks are modified\n    this._useCounts = {};\n  }\n\n  addDefaultModule(module) {\n    if (!this._defaultModules.find(m => m.name === module.name)) {\n      this._defaultModules.push(module);\n    }\n\n    this.stateHash++;\n  }\n\n  removeDefaultModule(module) {\n    const moduleName = typeof module === 'string' ? module : module.name;\n    this._defaultModules = this._defaultModules.filter(m => m.name !== moduleName);\n    this.stateHash++;\n  }\n\n  addShaderHook(hook, opts) {\n    if (opts) {\n      hook = Object.assign(opts, {hook});\n    }\n\n    this._hookFunctions.push(hook);\n\n    this.stateHash++;\n  }\n\n  get(props = {}) {\n    const {\n      vs = '',\n      fs = '',\n      defines = {},\n      inject = {},\n      varyings = [],\n      bufferMode = 0x8c8d,\n      transpileToGLSL100 = false\n    } = props; // varyings/bufferMode for xform feedback, 0x8c8d = SEPARATE_ATTRIBS\n\n    const modules = this._getModuleList(props.modules); // Combine with default modules\n\n    const vsHash = this._getHash(vs);\n    const fsHash = this._getHash(fs);\n    const moduleHashes = modules.map(m => this._getHash(m.name)).sort();\n    const varyingHashes = varyings.map(v => this._getHash(v));\n\n    const defineKeys = Object.keys(defines).sort();\n    const injectKeys = Object.keys(inject).sort();\n    const defineHashes = [];\n    const injectHashes = [];\n\n    for (const key of defineKeys) {\n      defineHashes.push(this._getHash(key));\n      defineHashes.push(this._getHash(defines[key]));\n    }\n\n    for (const key of injectKeys) {\n      injectHashes.push(this._getHash(key));\n      injectHashes.push(this._getHash(inject[key]));\n    }\n\n    const hash = `${vsHash}/${fsHash}D${defineHashes.join('/')}M${moduleHashes.join(\n      '/'\n    )}I${injectHashes.join('/')}V${varyingHashes.join('/')}H${this.stateHash}B${bufferMode}${\n      transpileToGLSL100 ? 'T' : ''\n    }`;\n\n    if (!this._programCache[hash]) {\n      const assembled = assembleShaders(this.gl, {\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        hookFunctions: this._hookFunctions,\n        transpileToGLSL100\n      });\n\n      this._programCache[hash] = new Program(this.gl, {\n        hash,\n        vs: assembled.vs,\n        fs: assembled.fs,\n        varyings,\n        bufferMode\n      });\n\n      this._getUniforms[hash] = assembled.getUniforms || (x => {});\n      this._useCounts[hash] = 0;\n    }\n\n    this._useCounts[hash]++;\n\n    return this._programCache[hash];\n  }\n\n  getUniforms(program) {\n    return this._getUniforms[program.hash] || null;\n  }\n\n  release(program) {\n    const hash = program.hash;\n    this._useCounts[hash]--;\n\n    if (this._useCounts[hash] === 0) {\n      this._programCache[hash].delete();\n      delete this._programCache[hash];\n      delete this._getUniforms[hash];\n      delete this._useCounts[hash];\n    }\n  }\n\n  _getHash(key) {\n    if (this._hashes[key] === undefined) {\n      this._hashes[key] = this._hashCounter++;\n    }\n\n    return this._hashes[key];\n  }\n\n  // Dedup and combine with default modules\n  _getModuleList(appModules = []) {\n    const modules = new Array(this._defaultModules.length + appModules.length);\n    const seen = {};\n    let count = 0;\n\n    for (let i = 0, len = this._defaultModules.length; i < len; ++i) {\n      const module = this._defaultModules[i];\n      const name = module.name;\n      modules[count++] = module;\n      seen[name] = true;\n    }\n\n    for (let i = 0, len = appModules.length; i < len; ++i) {\n      const module = appModules[i];\n      const name = module.name;\n      if (!seen[name]) {\n        modules[count++] = module;\n        seen[name] = true;\n      }\n    }\n\n    modules.length = count;\n\n    return modules;\n  }\n}\n","// WebGLRenderingContext related methods\n\n/** @typedef {import('./context')} types */\n\n/* eslint-disable quotes */\nimport GL from '@luma.gl/constants';\nimport {isBrowser as getIsBrowser} from '@probe.gl/env';\nimport {trackContextState} from '../state-tracker/track-context-state';\n\nimport {log} from '../utils/log';\nimport {assert} from '../utils/assert';\nimport {getDevicePixelRatio} from '../utils/device-pixels';\nimport {isWebGL2} from '../utils/webgl-checks';\n\nconst isBrowser = getIsBrowser();\nconst isPage = isBrowser && typeof document !== 'undefined';\n\nconst CONTEXT_DEFAULTS = {\n  // COMMON CONTEXT PARAMETERS\n  // Attempt to allocate WebGL2 context\n  webgl2: true, // Attempt to create a WebGL2 context (false to force webgl1)\n  webgl1: true, // Attempt to create a WebGL1 context (false to fail if webgl2 not available)\n  throwOnError: true,\n  manageState: true,\n  // BROWSER CONTEXT PARAMETERS\n  canvas: null, // A canvas element or a canvas string id\n  debug: false, // Instrument context (at the expense of performance)\n  // HEADLESS CONTEXT PARAMETERS\n  width: 800, // width are height are only used by headless gl\n  height: 600\n  // WEBGL/HEADLESS CONTEXT PARAMETERS\n  // Remaining options are passed through to context creator\n};\n\n/**\n * Creates a context giving access to the WebGL API\n * @type {types['createGLContext']}\n */\n/* eslint-disable complexity, max-statements */\nexport function createGLContext(options = {}) {\n  assert(\n    isBrowser,\n    \"createGLContext only available in the browser.\\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils\"\n  );\n\n  options = Object.assign({}, CONTEXT_DEFAULTS, options);\n  const {width, height} = options;\n\n  // Error reporting function, enables exceptions to be disabled\n  function onError(message) {\n    if (options.throwOnError) {\n      throw new Error(message);\n    }\n    // eslint-disable-next-line\n    console.error(message);\n    return null;\n  }\n  options.onError = onError;\n\n  let gl;\n  // Get or create a canvas\n  const {canvas} = options;\n  const targetCanvas = getCanvas({canvas, width, height, onError});\n  // Create a WebGL context in the canvas\n  gl = createBrowserContext(targetCanvas, options);\n\n  if (!gl) {\n    return null;\n  }\n\n  gl = instrumentGLContext(gl, options);\n\n  // Log some debug info about the newly created context\n  logInfo(gl);\n\n  // Add to seer integration\n  return gl;\n}\n\n/**\n * Creates a context giving access to the WebGL API\n * @type {types['instrumentGLContext']}\n */\nexport function instrumentGLContext(gl, options = {}) {\n  // Avoid multiple instrumentations\n  // @ts-ignore\n  if (!gl || gl._instrumented) {\n    return gl;\n  }\n\n  // @ts-ignore\n  gl._version = gl._version || getVersion(gl);\n\n  // Cache canvas size information to avoid setting it on every frame.\n  // @ts-ignore\n  gl.luma = gl.luma || {};\n  // @ts-ignore\n  gl.luma.canvasSizeInfo = gl.luma.canvasSizeInfo || {};\n\n  options = Object.assign({}, CONTEXT_DEFAULTS, options);\n  const {manageState, debug} = options;\n\n  // Install context state tracking\n  if (manageState) {\n    trackContextState(gl, {\n      copyState: false,\n      log: (...args) => log.log(1, ...args)()\n    });\n  }\n\n  // Add debug instrumentation to the context\n  if (isBrowser && debug) {\n    // @ts-ignore\n    if (!globalThis.makeDebugContext) {\n      log.warn('WebGL debug mode not activated. import \"@luma.gl/debug\" to enable.')();\n    } else {\n      // @ts-ignore\n      gl = globalThis.makeDebugContext(gl, options);\n      // Debug forces log level to at least 1\n      log.level = Math.max(log.level, 1);\n    }\n  }\n\n  // @ts-ignore\n  gl._instrumented = true;\n\n  return gl;\n}\n\n/**\n * Provides strings identifying the GPU vendor and driver.\n * @type {types['getContextDebugInfo']}\n */\nexport function getContextDebugInfo(gl) {\n  const vendorMasked = gl.getParameter(GL.VENDOR);\n  const rendererMasked = gl.getParameter(GL.RENDERER);\n  const ext = gl.getExtension('WEBGL_debug_renderer_info');\n  const vendorUnmasked = ext && gl.getParameter(ext.UNMASKED_VENDOR_WEBGL || GL.VENDOR);\n  const rendererUnmasked = ext && gl.getParameter(ext.UNMASKED_RENDERER_WEBGL || GL.RENDERER);\n  return {\n    vendor: vendorUnmasked || vendorMasked,\n    renderer: rendererUnmasked || rendererMasked,\n    vendorMasked,\n    rendererMasked,\n    version: gl.getParameter(GL.VERSION),\n    shadingLanguageVersion: gl.getParameter(GL.SHADING_LANGUAGE_VERSION)\n  };\n}\n\n/**\n * Resize the canvas' drawing buffer.\n * @type {types['resizeGLContext']}\n */\nexport function resizeGLContext(gl, options = {}) {\n  // Resize browser context\n  if (gl.canvas) {\n    const devicePixelRatio = getDevicePixelRatio(options.useDevicePixels);\n    setDevicePixelRatio(gl, devicePixelRatio, options);\n    return;\n  }\n\n  // Resize headless gl context\n  const ext = gl.getExtension('STACKGL_resize_drawingbuffer');\n  if (ext && `width` in options && `height` in options) {\n    ext.resize(options.width, options.height);\n  }\n}\n\n// HELPER METHODS\n\n/**\n * Create a WebGL context for a canvas\n * Note calling this multiple time on the same canvas does return the same context\n */\n\nfunction createBrowserContext(canvas, options) {\n  const {onError} = options;\n\n  // Try to extract any extra information about why context creation failed\n  let errorMessage = null;\n  const onCreateError = error => (errorMessage = error.statusMessage || errorMessage);\n  canvas.addEventListener('webglcontextcreationerror', onCreateError, false);\n\n  const {webgl1 = true, webgl2 = true} = options;\n  let gl = null;\n  // Prefer webgl2 over webgl1, prefer conformant over experimental\n  if (webgl2) {\n    gl = gl || canvas.getContext('webgl2', options);\n    gl = gl || canvas.getContext('experimental-webgl2', options);\n  }\n  if (webgl1) {\n    gl = gl || canvas.getContext('webgl', options);\n    gl = gl || canvas.getContext('experimental-webgl', options);\n  }\n\n  canvas.removeEventListener('webglcontextcreationerror', onCreateError, false);\n\n  if (!gl) {\n    return onError(\n      `Failed to create ${webgl2 && !webgl1 ? 'WebGL2' : 'WebGL'} context: ${errorMessage ||\n        'Unknown error'}`\n    );\n  }\n\n  if (options.onContextLost) {\n    canvas.addEventListener('webglcontextlost', options.onContextLost, false);\n  }\n\n  if (options.onContextRestored) {\n    canvas.addEventListener('webglcontextrestored', options.onContextRestored, false);\n  }\n\n  return gl;\n}\n\nfunction getCanvas({canvas, width = 800, height = 600, onError}) {\n  let targetCanvas;\n  if (typeof canvas === 'string') {\n    const isPageLoaded = isPage && document.readyState === 'complete';\n    if (!isPageLoaded) {\n      onError(`createGLContext called on canvas '${canvas}' before page was loaded`);\n    }\n    targetCanvas = document.getElementById(canvas);\n  } else if (canvas) {\n    targetCanvas = canvas;\n  } else {\n    targetCanvas = document.createElement('canvas');\n    targetCanvas.id = 'lumagl-canvas';\n    targetCanvas.style.width = Number.isFinite(width) ? `${width}px` : '100%';\n    targetCanvas.style.height = Number.isFinite(height) ? `${height}px` : '100%';\n    document.body.insertBefore(targetCanvas, document.body.firstChild);\n  }\n\n  return targetCanvas;\n}\n\nfunction logInfo(gl) {\n  const webGL = isWebGL2(gl) ? 'WebGL2' : 'WebGL1';\n  const info = getContextDebugInfo(gl);\n  const driver = info ? `(${info.vendor},${info.renderer})` : '';\n  const debug = gl.debug ? ' debug' : '';\n  log.info(1, `${webGL}${debug} context ${driver}`)();\n}\n\nfunction getVersion(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    // WebGL2 context.\n    return 2;\n  }\n  // Must be a WebGL1 context.\n  return 1;\n}\n\n// use devicePixelRatio to set canvas width and height\nfunction setDevicePixelRatio(gl, devicePixelRatio, options) {\n  // NOTE: if options.width and options.height not used remove in v8\n  let clientWidth = 'width' in options ? options.width : gl.canvas.clientWidth;\n  let clientHeight = 'height' in options ? options.height : gl.canvas.clientHeight;\n\n  if (!clientWidth || !clientHeight) {\n    log.log(1, 'Canvas clientWidth/clientHeight is 0')();\n    // by forcing devicePixel ratio to 1, we do not scale gl.canvas.width and height in each frame.\n    devicePixelRatio = 1;\n    clientWidth = gl.canvas.width || 1;\n    clientHeight = gl.canvas.height || 1;\n  }\n\n  gl.luma = gl.luma || {};\n  gl.luma.canvasSizeInfo = gl.luma.canvasSizeInfo || {};\n  const cachedSize = gl.luma.canvasSizeInfo;\n  // Check if canvas needs to be resized\n  if (\n    cachedSize.clientWidth !== clientWidth ||\n    cachedSize.clientHeight !== clientHeight ||\n    cachedSize.devicePixelRatio !== devicePixelRatio\n  ) {\n    let clampedPixelRatio = devicePixelRatio;\n\n    const canvasWidth = Math.floor(clientWidth * clampedPixelRatio);\n    const canvasHeight = Math.floor(clientHeight * clampedPixelRatio);\n    gl.canvas.width = canvasWidth;\n    gl.canvas.height = canvasHeight;\n\n    // Note: when devicePixelRatio is too high, it is possible we might hit system limit for\n    // drawing buffer width and hight, in those cases they get clamped and resulting aspect ration may not be maintained\n    // for those cases, reduce devicePixelRatio.\n    if (gl.drawingBufferWidth !== canvasWidth || gl.drawingBufferHeight !== canvasHeight) {\n      log.warn(`Device pixel ratio clamped`)();\n      clampedPixelRatio = Math.min(\n        gl.drawingBufferWidth / clientWidth,\n        gl.drawingBufferHeight / clientHeight\n      );\n\n      gl.canvas.width = Math.floor(clientWidth * clampedPixelRatio);\n      gl.canvas.height = Math.floor(clientHeight * clampedPixelRatio);\n    }\n\n    Object.assign(gl.luma.canvasSizeInfo, {clientWidth, clientHeight, devicePixelRatio});\n  }\n}\n","// Utils\nexport {log} from './utils/log';\nexport {\n  isWebGL,\n  isWebGL2,\n  getWebGL2Context,\n  assertWebGLContext,\n  assertWebGL2Context\n} from './utils/webgl-checks';\n\n// Polyfills to support a subset of WebGL2 APIs on WebGL1 contexts\nexport {polyfillContext} from './polyfill/polyfill-context';\n\n// unified parameter APIs\nexport {\n  getParameters,\n  setParameters,\n  resetParameters,\n  withParameters\n} from './state-tracker/unified-parameter-api';\n\n// state tracking\nexport {\n  trackContextState,\n  pushContextState,\n  popContextState\n} from './state-tracker/track-context-state';\n\nexport {\n  createGLContext,\n  resizeGLContext,\n  instrumentGLContext,\n  getContextDebugInfo\n} from './context/context';\n\nexport {cssToDeviceRatio, cssToDevicePixels} from './utils/device-pixels';\n","/* eslint-disable no-inline-comments, max-len, camelcase */\nimport GL from '@luma.gl/constants';\nimport {isWebGL2} from '../utils/webgl-checks';\n\nconst OES_element_index = 'OES_element_index';\nconst WEBGL_draw_buffers = 'WEBGL_draw_buffers';\nconst EXT_disjoint_timer_query = 'EXT_disjoint_timer_query';\nconst EXT_disjoint_timer_query_webgl2 = 'EXT_disjoint_timer_query_webgl2';\nconst EXT_texture_filter_anisotropic = 'EXT_texture_filter_anisotropic';\nconst WEBGL_debug_renderer_info = 'WEBGL_debug_renderer_info';\n\nconst GL_FRAGMENT_SHADER_DERIVATIVE_HINT = 0x8b8b;\nconst GL_DONT_CARE = 0x1100;\nconst GL_GPU_DISJOINT_EXT = 0x8fbb;\nconst GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT = 0x84ff;\nconst GL_UNMASKED_VENDOR_WEBGL = 0x9245; // vendor string of the graphics driver.\nconst GL_UNMASKED_RENDERER_WEBGL = 0x9246; // renderer string of the graphics driver.\n\nconst getWebGL2ValueOrZero = gl => (!isWebGL2(gl) ? 0 : undefined);\n\n// if a function returns undefined in this table,\n// the original getParameter will be called, defeating the override\nconst WEBGL_PARAMETERS = {\n  [GL.READ_BUFFER]: gl => (!isWebGL2(gl) ? GL.COLOR_ATTACHMENT0 : undefined),\n\n  // WebGL2 context parameters\n  [GL_FRAGMENT_SHADER_DERIVATIVE_HINT]: gl => (!isWebGL2(gl) ? GL_DONT_CARE : undefined),\n\n  [GL.RASTERIZER_DISCARD]: getWebGL2ValueOrZero,\n\n  [GL.SAMPLES]: getWebGL2ValueOrZero,\n\n  // WebGL2 extension context parameters\n  [GL_GPU_DISJOINT_EXT]: (gl, getParameter) => {\n    const ext = isWebGL2(gl)\n      ? gl.getExtension(EXT_disjoint_timer_query_webgl2)\n      : gl.getExtension(EXT_disjoint_timer_query);\n    return ext && ext.GPU_DISJOINT_EXT ? getParameter(ext.GPU_DISJOINT_EXT) : 0;\n  },\n\n  // Extension fixed values\n  [GL_UNMASKED_VENDOR_WEBGL]: (gl, getParameter) => {\n    const ext = gl.getExtension(WEBGL_debug_renderer_info);\n    return getParameter((ext && ext.UNMASKED_VENDOR_WEBGL) || GL.VENDOR);\n  },\n\n  [GL_UNMASKED_RENDERER_WEBGL]: (gl, getParameter) => {\n    const ext = gl.getExtension(WEBGL_debug_renderer_info);\n    return getParameter((ext && ext.UNMASKED_RENDERER_WEBGL) || GL.RENDERER);\n  },\n\n  // Extension LIMITS\n  [GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT]: (gl, getParameter) => {\n    const ext = gl.luma.extensions[EXT_texture_filter_anisotropic];\n    return ext ? getParameter(ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 1.0;\n  },\n\n  // WebGL2 Limits\n  [GL.MAX_3D_TEXTURE_SIZE]: getWebGL2ValueOrZero,\n  [GL.MAX_ARRAY_TEXTURE_LAYERS]: getWebGL2ValueOrZero,\n  [GL.MAX_CLIENT_WAIT_TIMEOUT_WEBGL]: getWebGL2ValueOrZero,\n  [GL.MAX_COLOR_ATTACHMENTS]: (gl, getParameter) => {\n    if (!isWebGL2(gl)) {\n      const ext = gl.getExtension(WEBGL_draw_buffers);\n      return ext ? getParameter(ext.MAX_COLOR_ATTACHMENTS_WEBGL) : 0;\n    }\n    return undefined;\n  },\n  [GL.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_COMBINED_UNIFORM_BLOCKS]: getWebGL2ValueOrZero,\n  [GL.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_DRAW_BUFFERS]: gl => {\n    if (!isWebGL2(gl)) {\n      const ext = gl.getExtension(WEBGL_draw_buffers);\n      return ext ? ext.MAX_DRAW_BUFFERS_WEBGL : 0;\n    }\n    return undefined;\n  },\n  [GL.MAX_ELEMENT_INDEX]:\n    // Guess: per webglstats.com 99.6% of webgl2 supports 2147483647\n    gl => (gl.getExtension(OES_element_index) ? 2147483647 : 65535),\n  [GL.MAX_ELEMENTS_INDICES]:\n    // Guess: \"Reasonably safe\" per webglstats.com - could be higher/lower (on some mobile devices)\n    gl => (gl.getExtension(OES_element_index) ? 16777216 : 65535),\n  [GL.MAX_ELEMENTS_VERTICES]:\n    // Guess: \"Reasonably safe\" per webglstats.com - could be higher/lower (on some mobile devices)\n    gl => 16777216,\n  [GL.MAX_FRAGMENT_INPUT_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_FRAGMENT_UNIFORM_BLOCKS]: getWebGL2ValueOrZero,\n  [GL.MAX_FRAGMENT_UNIFORM_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_SAMPLES]: getWebGL2ValueOrZero,\n  [GL.MAX_SERVER_WAIT_TIMEOUT]: getWebGL2ValueOrZero,\n  [GL.MAX_TEXTURE_LOD_BIAS]: getWebGL2ValueOrZero,\n  [GL.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS]: getWebGL2ValueOrZero,\n  [GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_UNIFORM_BLOCK_SIZE]: getWebGL2ValueOrZero,\n  [GL.MAX_UNIFORM_BUFFER_BINDINGS]: getWebGL2ValueOrZero,\n  [GL.MAX_VARYING_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_VERTEX_OUTPUT_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_VERTEX_UNIFORM_BLOCKS]: getWebGL2ValueOrZero,\n  [GL.MAX_VERTEX_UNIFORM_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MIN_PROGRAM_TEXEL_OFFSET]: getWebGL2ValueOrZero,\n  [GL.MAX_PROGRAM_TEXEL_OFFSET]: getWebGL2ValueOrZero,\n  [GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT]: getWebGL2ValueOrZero\n};\n\n// A \"replacement\" gl.getParameter that accepts \"enums\" from extensions and WebGL2\n// and returns reasonably safe defaults\nexport function getParameterPolyfill(gl, originalGetParameter, pname) {\n  // Return mock limits (usually 0) for WebGL2 constants to ensure these\n  // can be queries without error\n  const limit = WEBGL_PARAMETERS[pname];\n  // @ts-ignore TODO pname parameter not declared\n  const value = typeof limit === 'function' ? limit(gl, originalGetParameter, pname) : limit;\n  const result = value !== undefined ? value : originalGetParameter(pname);\n  return result;\n}\n","// WebGL1/WebGL2 extension polyfill support\n//\n// Provides a function that creates polyfills for WebGL2 functions based\n// on available extensions and installs them on a supplied target (could be\n// the WebGLContext or its prototype, or a separate object).\n//\n// This is intended to be a stand-alone file with minimal dependencies,\n// easy to reuse or repurpose in other projects.\n\n/** @typedef {import('./polyfill-context')} types */\n\nimport {polyfillVertexArrayObject} from './polyfill-vertex-array-object';\nimport {assert} from '../utils/assert';\n\nimport {WEBGL2_CONTEXT_POLYFILLS, WEBGL2_CONTEXT_OVERRIDES} from './polyfill-table';\n\n/** @type {types['polyfillContext']} */\nexport function polyfillContext(gl) {\n  // @ts-ignore\n  gl.luma = gl.luma || {};\n  // @ts-ignore\n  const {luma} = gl;\n\n  if (!luma.polyfilled) {\n    polyfillVertexArrayObject(gl);\n    initializeExtensions(gl);\n    installPolyfills(gl, WEBGL2_CONTEXT_POLYFILLS);\n    installOverrides(gl, {target: luma, target2: gl});\n    luma.polyfilled = true;\n  }\n\n  // TODO - only supporting a few members\n  /** @type {WebGL2RenderingContext} */\n  // @ts-ignore\n  return gl;\n}\n\n// TODO - is this still required?\n// @ts-ignore\nglobalThis.polyfillContext = polyfillContext;\n\nfunction initializeExtensions(gl) {\n  gl.luma.extensions = {};\n  // `getSupportedExtensions` can return null when context is lost.\n  const EXTENSIONS = gl.getSupportedExtensions() || [];\n  for (const extension of EXTENSIONS) {\n    gl.luma[extension] = gl.getExtension(extension);\n  }\n}\n\n// Install simple overrides (mostly get* functions)\nfunction installOverrides(gl, {target, target2}) {\n  Object.keys(WEBGL2_CONTEXT_OVERRIDES).forEach(key => {\n    if (typeof WEBGL2_CONTEXT_OVERRIDES[key] === 'function') {\n      // install an override, if no implementation was detected\n      const originalFunc = gl[key] ? gl[key].bind(gl) : () => {};\n      const polyfill = WEBGL2_CONTEXT_OVERRIDES[key].bind(null, gl, originalFunc);\n      target[key] = polyfill;\n      target2[key] = polyfill;\n    }\n  });\n}\n\nfunction installPolyfills(gl, polyfills) {\n  for (const extension of Object.getOwnPropertyNames(polyfills)) {\n    if (extension !== 'overrides') {\n      polyfillExtension(gl, {extension, target: gl.luma, target2: gl});\n    }\n  }\n}\n\n// Polyfills a single WebGL extension into the `target` object\nfunction polyfillExtension(gl, {extension, target, target2}) {\n  const defaults = WEBGL2_CONTEXT_POLYFILLS[extension];\n  assert(defaults);\n\n  const {meta = {}} = defaults;\n  const {suffix = ''} = meta;\n\n  const ext = gl.getExtension(extension);\n\n  for (const key of Object.keys(defaults)) {\n    const extKey = `${key}${suffix}`;\n\n    let polyfill = null;\n    if (key === 'meta') {\n      // ignore\n    } else if (typeof gl[key] === 'function') {\n      // WebGL2 implementation is already\n    } else if (ext && typeof ext[extKey] === 'function') {\n      // pick extension implemenentation,if available\n      polyfill = (...args) => ext[extKey](...args);\n    } else if (typeof defaults[key] === 'function') {\n      // pick the mock implementation, if no implementation was detected\n      polyfill = defaults[key].bind(target);\n    }\n\n    if (polyfill) {\n      target[key] = polyfill;\n      target2[key] = polyfill;\n    }\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {assert} from '../utils/assert';\nimport {isWebGL2} from '../utils/webgl-checks';\n\nimport {getParameterPolyfill} from './get-parameter-polyfill';\n\nconst OES_vertex_array_object = 'OES_vertex_array_object';\nconst ANGLE_instanced_arrays = 'ANGLE_instanced_arrays';\nconst WEBGL_draw_buffers = 'WEBGL_draw_buffers';\nconst EXT_disjoint_timer_query = 'EXT_disjoint_timer_query';\nconst EXT_texture_filter_anisotropic = 'EXT_texture_filter_anisotropic';\n\nconst ERR_VAO_NOT_SUPPORTED = 'VertexArray requires WebGL2 or OES_vertex_array_object extension';\n\n// Return object with webgl2 flag and an extension\nfunction getExtensionData(gl, extension) {\n  return {\n    webgl2: isWebGL2(gl),\n    ext: gl.getExtension(extension)\n  };\n}\n\n// function mapExtensionConstant(gl, constant) {\n//   switch (constant) {\n//   case ext.FRAGMENT_SHADER_DERIVATIVE_HINT_OES: return GL.FRAGMENT_SHADER_DERIVATIVE_HINT;\n//   }\n// }\n\nexport const WEBGL2_CONTEXT_POLYFILLS = {\n  // POLYFILL TABLE\n  [OES_vertex_array_object]: {\n    meta: {suffix: 'OES'},\n    // NEW METHODS\n    createVertexArray: () => {\n      assert(false, ERR_VAO_NOT_SUPPORTED);\n    },\n    deleteVertexArray: () => {},\n    bindVertexArray: () => {},\n    isVertexArray: () => false\n  },\n  [ANGLE_instanced_arrays]: {\n    meta: {\n      suffix: 'ANGLE'\n      // constants: {\n      //   VERTEX_ATTRIB_ARRAY_DIVISOR: 'VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE'\n      // }\n    },\n    vertexAttribDivisor(location, divisor) {\n      // Accept divisor 0 even if instancing is not supported (0 = no instancing)\n      assert(divisor === 0, 'WebGL instanced rendering not supported');\n    },\n    drawElementsInstanced: () => {},\n    drawArraysInstanced: () => {}\n  },\n  [WEBGL_draw_buffers]: {\n    meta: {\n      suffix: 'WEBGL'\n    },\n    drawBuffers: () => {\n      assert(false);\n    }\n  },\n  [EXT_disjoint_timer_query]: {\n    meta: {suffix: 'EXT'},\n    // WebGL1: Polyfills the WebGL2 Query API\n    createQuery: () => {\n      assert(false);\n    },\n    deleteQuery: () => {\n      assert(false);\n    },\n    beginQuery: () => {\n      assert(false);\n    },\n    endQuery: () => {},\n    getQuery(handle, pname) {\n      // @ts-ignore\n      return this.getQueryObject(handle, pname);\n    },\n    // The WebGL1 extension uses getQueryObject rather then getQueryParameter\n    getQueryParameter(handle, pname) {\n      // @ts-ignore\n      return this.getQueryObject(handle, pname);\n    },\n    getQueryObject: () => {}\n  }\n};\n\nexport const WEBGL2_CONTEXT_OVERRIDES = {\n  // Ensure readBuffer is a no-op\n  readBuffer: (gl, originalFunc, attachment) => {\n    if (isWebGL2(gl)) {\n      originalFunc(attachment);\n    } else {\n      // assert(attachment !== GL_COLOR_ATTACHMENT0 && attachment !== GL_FRONT);\n    }\n  },\n  // Override for getVertexAttrib that returns sane values for non-WebGL1 constants\n  getVertexAttrib: (gl, originalFunc, location, pname) => {\n    // const gl = this; // eslint-disable-line\n    const {webgl2, ext} = getExtensionData(gl, ANGLE_instanced_arrays);\n\n    let result;\n    switch (pname) {\n      // WebGL1 attributes will never be integer\n      case GL.VERTEX_ATTRIB_ARRAY_INTEGER:\n        result = !webgl2 ? false : undefined;\n        break;\n      // if instancing is not available, return 0 meaning divisor has not been set\n      case GL.VERTEX_ATTRIB_ARRAY_DIVISOR:\n        result = !webgl2 && !ext ? 0 : undefined;\n        break;\n      default:\n    }\n\n    return result !== undefined ? result : originalFunc(location, pname);\n  },\n  // Handle transform feedback and uniform block queries in WebGL1\n  getProgramParameter: (gl, originalFunc, program, pname) => {\n    if (!isWebGL2(gl)) {\n      switch (pname) {\n        case GL.TRANSFORM_FEEDBACK_BUFFER_MODE:\n          return GL.SEPARATE_ATTRIBS;\n        case GL.TRANSFORM_FEEDBACK_VARYINGS:\n          return 0;\n        case GL.ACTIVE_UNIFORM_BLOCKS:\n          return 0;\n        default:\n      }\n    }\n    return originalFunc(program, pname);\n  },\n  getInternalformatParameter: (gl, originalFunc, target, format, pname) => {\n    if (!isWebGL2(gl)) {\n      switch (pname) {\n        case GL.SAMPLES:\n          return new Int32Array([0]);\n        default:\n      }\n    }\n    return gl.getInternalformatParameter(target, format, pname);\n  },\n  getTexParameter(gl, originalFunc, target, pname) {\n    switch (pname) {\n      case GL.TEXTURE_MAX_ANISOTROPY_EXT:\n        const {extensions} = gl.luma;\n        const ext = extensions[EXT_texture_filter_anisotropic];\n        pname = (ext && ext.TEXTURE_MAX_ANISOTROPY_EXT) || GL.TEXTURE_MAX_ANISOTROPY_EXT;\n        break;\n      default:\n    }\n    return originalFunc(target, pname);\n  },\n  getParameter: getParameterPolyfill,\n  hint(gl, originalFunc, pname, value) {\n    // TODO - handle GL.FRAGMENT_SHADER_DERIVATIVE_HINT:\n    // switch (pname) {\n    // case GL.FRAGMENT_SHADER_DERIVATIVE_HINT:\n    // }\n    return originalFunc(pname, value);\n  }\n};\n","/*\n** Copyright (c) 2015 The Khronos Group Inc.\n**\n** Permission is hereby granted, free of charge, to any person obtaining a\n** copy of this software and/or associated documentation files (the\n** \"Materials\"), to deal in the Materials without restriction, including\n** without limitation the rights to use, copy, modify, merge, publish,\n** distribute, sublicense, and/or sell copies of the Materials, and to\n** permit persons to whom the Materials are furnished to do so, subject to\n** the following conditions:\n**\n** The above copyright notice and this permission notice shall be included\n** in all copies or substantial portions of the Materials.\n**\n** THE MATERIALS ARE PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n** EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n** MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n** IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n** CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n** TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n** MATERIALS OR THE USE OR OTHER DEALINGS IN THE MATERIALS.\n*/\n\n// Modified to use ES6 and polyfill a provided context rather than\n// the global class.\n\n// @ts-nocheck external code\n\nconst glErrorShadow = {};\n\nfunction error(msg) {\n  if (globalThis.console && globalThis.console.error) {\n    globalThis.console.error(msg);\n  }\n}\n\nfunction log(msg) {\n  if (globalThis.console && globalThis.console.log) {\n    globalThis.console.log(msg);\n  }\n}\n\nfunction synthesizeGLError(err, opt_msg) {\n  glErrorShadow[err] = true;\n  if (opt_msg !== undefined) {\n    error(opt_msg);\n  }\n}\n\nfunction wrapGLError(gl) {\n  const f = gl.getError;\n  gl.getError = function getError() {\n    let err;\n    do {\n      err = f.apply(gl);\n      if (err !== gl.NO_ERROR) {\n        glErrorShadow[err] = true;\n      }\n    } while (err !== gl.NO_ERROR);\n\n    for (err in glErrorShadow) {\n      if (glErrorShadow[err]) {\n        delete glErrorShadow[err];\n        return parseInt(err, 10);\n      }\n    }\n\n    return gl.NO_ERROR;\n  };\n}\n\nconst WebGLVertexArrayObjectOES = function WebGLVertexArrayObjectOES(ext) {\n  const gl = ext.gl;\n\n  this.ext = ext;\n  this.isAlive = true;\n  this.hasBeenBound = false;\n\n  this.elementArrayBuffer = null;\n  this.attribs = new Array(ext.maxVertexAttribs);\n  for (let n = 0; n < this.attribs.length; n++) {\n    const attrib = new WebGLVertexArrayObjectOES.VertexAttrib(gl);\n    this.attribs[n] = attrib;\n  }\n\n  this.maxAttrib = 0;\n};\n\nWebGLVertexArrayObjectOES.VertexAttrib = function VertexAttrib(gl) {\n  this.enabled = false;\n  this.buffer = null;\n  this.size = 4;\n  this.type = gl.FLOAT;\n  this.normalized = false;\n  this.stride = 16;\n  this.offset = 0;\n\n  this.cached = '';\n  this.recache();\n};\nWebGLVertexArrayObjectOES.VertexAttrib.prototype.recache = function recache() {\n  this.cached = [this.size, this.type, this.normalized, this.stride, this.offset].join(':');\n};\n\nconst OESVertexArrayObject = function OESVertexArrayObject(gl) {\n  const self = this;\n  this.gl = gl;\n\n  wrapGLError(gl);\n\n  const original = (this.original = {\n    getParameter: gl.getParameter,\n    enableVertexAttribArray: gl.enableVertexAttribArray,\n    disableVertexAttribArray: gl.disableVertexAttribArray,\n    bindBuffer: gl.bindBuffer,\n    getVertexAttrib: gl.getVertexAttrib,\n    vertexAttribPointer: gl.vertexAttribPointer\n  });\n\n  gl.getParameter = function getParameter(pname) {\n    if (pname === self.VERTEX_ARRAY_BINDING_OES) {\n      if (self.currentVertexArrayObject === self.defaultVertexArrayObject) {\n        return null;\n      }\n      return self.currentVertexArrayObject;\n    }\n    return original.getParameter.apply(this, arguments);\n  };\n\n  gl.enableVertexAttribArray = function enableVertexAttribArray(index) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, index);\n    const attrib = vao.attribs[index];\n    attrib.enabled = true;\n    return original.enableVertexAttribArray.apply(this, arguments);\n  };\n  gl.disableVertexAttribArray = function disableVertexAttribArray(index) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, index);\n    const attrib = vao.attribs[index];\n    attrib.enabled = false;\n    return original.disableVertexAttribArray.apply(this, arguments);\n  };\n\n  gl.bindBuffer = function bindBuffer(target, buffer) {\n    switch (target) {\n      case gl.ARRAY_BUFFER:\n        self.currentArrayBuffer = buffer;\n        break;\n      case gl.ELEMENT_ARRAY_BUFFER:\n        self.currentVertexArrayObject.elementArrayBuffer = buffer;\n        break;\n      default:\n    }\n    return original.bindBuffer.apply(this, arguments);\n  };\n\n  gl.getVertexAttrib = function getVertexAttrib(index, pname) {\n    const vao = self.currentVertexArrayObject;\n    const attrib = vao.attribs[index];\n    switch (pname) {\n      case gl.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:\n        return attrib.buffer;\n      case gl.VERTEX_ATTRIB_ARRAY_ENABLED:\n        return attrib.enabled;\n      case gl.VERTEX_ATTRIB_ARRAY_SIZE:\n        return attrib.size;\n      case gl.VERTEX_ATTRIB_ARRAY_STRIDE:\n        return attrib.stride;\n      case gl.VERTEX_ATTRIB_ARRAY_TYPE:\n        return attrib.type;\n      case gl.VERTEX_ATTRIB_ARRAY_NORMALIZED:\n        return attrib.normalized;\n      default:\n        return original.getVertexAttrib.apply(this, arguments);\n    }\n  };\n\n  gl.vertexAttribPointer = function vertexAttribPointer(\n    indx,\n    size,\n    type,\n    normalized,\n    stride,\n    offset\n  ) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, indx);\n    const attrib = vao.attribs[indx];\n    attrib.buffer = self.currentArrayBuffer;\n    attrib.size = size;\n    attrib.type = type;\n    attrib.normalized = normalized;\n    attrib.stride = stride;\n    attrib.offset = offset;\n    attrib.recache();\n    return original.vertexAttribPointer.apply(this, arguments);\n  };\n\n  if (gl.instrumentExtension) {\n    gl.instrumentExtension(this, 'OES_vertex_array_object');\n  }\n\n  // undefined for headless gl\n  if (gl.canvas) {\n    gl.canvas.addEventListener(\n      'webglcontextrestored',\n      () => {\n        log('OESVertexArrayObject emulation library context restored');\n        self.reset_();\n      },\n      true\n    );\n  }\n\n  this.reset_();\n};\n\nOESVertexArrayObject.prototype.VERTEX_ARRAY_BINDING_OES = 0x85b5;\n\nOESVertexArrayObject.prototype.reset_ = function reset_() {\n  const contextWasLost = this.vertexArrayObjects !== undefined;\n  if (contextWasLost) {\n    for (let ii = 0; ii < this.vertexArrayObjects.length; ++ii) {\n      this.vertexArrayObjects.isAlive = false;\n    }\n  }\n  const gl = this.gl;\n  this.maxVertexAttribs = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);\n\n  this.defaultVertexArrayObject = new WebGLVertexArrayObjectOES(this);\n  this.currentVertexArrayObject = null;\n  this.currentArrayBuffer = null;\n  this.vertexArrayObjects = [this.defaultVertexArrayObject];\n\n  this.bindVertexArrayOES(null);\n};\n\nOESVertexArrayObject.prototype.createVertexArrayOES = function createVertexArrayOES() {\n  const arrayObject = new WebGLVertexArrayObjectOES(this);\n  this.vertexArrayObjects.push(arrayObject);\n  return arrayObject;\n};\n\nOESVertexArrayObject.prototype.deleteVertexArrayOES = function deleteVertexArrayOES(arrayObject) {\n  arrayObject.isAlive = false;\n  this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(arrayObject), 1);\n  if (this.currentVertexArrayObject === arrayObject) {\n    this.bindVertexArrayOES(null);\n  }\n};\n\nOESVertexArrayObject.prototype.isVertexArrayOES = function isVertexArrayOES(arrayObject) {\n  if (arrayObject && arrayObject instanceof WebGLVertexArrayObjectOES) {\n    if (arrayObject.hasBeenBound && arrayObject.ext === this) {\n      return true;\n    }\n  }\n  return false;\n};\n\nOESVertexArrayObject.prototype.bindVertexArrayOES = function bindVertexArrayOES(arrayObject) {\n  const gl = this.gl;\n  if (arrayObject && !arrayObject.isAlive) {\n    synthesizeGLError(\n      gl.INVALID_OPERATION,\n      'bindVertexArrayOES: attempt to bind deleted arrayObject'\n    );\n    return;\n  }\n  const original = this.original;\n\n  const oldVAO = this.currentVertexArrayObject;\n  this.currentVertexArrayObject = arrayObject || this.defaultVertexArrayObject;\n  this.currentVertexArrayObject.hasBeenBound = true;\n  const newVAO = this.currentVertexArrayObject;\n\n  if (oldVAO === newVAO) {\n    return;\n  }\n\n  if (!oldVAO || newVAO.elementArrayBuffer !== oldVAO.elementArrayBuffer) {\n    original.bindBuffer.call(gl, gl.ELEMENT_ARRAY_BUFFER, newVAO.elementArrayBuffer);\n  }\n\n  let currentBinding = this.currentArrayBuffer;\n  const maxAttrib = Math.max(oldVAO ? oldVAO.maxAttrib : 0, newVAO.maxAttrib);\n  for (let n = 0; n <= maxAttrib; n++) {\n    const attrib = newVAO.attribs[n];\n    const oldAttrib = oldVAO ? oldVAO.attribs[n] : null;\n\n    if (!oldVAO || attrib.enabled !== oldAttrib.enabled) {\n      if (attrib.enabled) {\n        original.enableVertexAttribArray.call(gl, n);\n      } else {\n        original.disableVertexAttribArray.call(gl, n);\n      }\n    }\n\n    if (attrib.enabled) {\n      let bufferChanged = false;\n      if (!oldVAO || attrib.buffer !== oldAttrib.buffer) {\n        if (currentBinding !== attrib.buffer) {\n          original.bindBuffer.call(gl, gl.ARRAY_BUFFER, attrib.buffer);\n          currentBinding = attrib.buffer;\n        }\n        bufferChanged = true;\n      }\n\n      if (bufferChanged || attrib.cached !== oldAttrib.cached) {\n        original.vertexAttribPointer.call(\n          gl,\n          n,\n          attrib.size,\n          attrib.type,\n          attrib.normalized,\n          attrib.stride,\n          attrib.offset\n        );\n      }\n    }\n  }\n\n  if (this.currentArrayBuffer !== currentBinding) {\n    original.bindBuffer.call(gl, gl.ARRAY_BUFFER, this.currentArrayBuffer);\n  }\n};\n\nexport function polyfillVertexArrayObject(gl) {\n  if (typeof gl.createVertexArray === 'function') {\n    // VAOs directly supported on object (i.e. WebGL 2 context)\n    return;\n  }\n\n  const original_getSupportedExtensions = gl.getSupportedExtensions;\n  gl.getSupportedExtensions = function getSupportedExtensions() {\n    const list = original_getSupportedExtensions.call(this) || [];\n    if (list.indexOf('OES_vertex_array_object') < 0) {\n      list.push('OES_vertex_array_object');\n    }\n    return list;\n  };\n\n  const original_getExtension = gl.getExtension;\n  gl.getExtension = function getExtension(name) {\n    const ext = original_getExtension.call(this, name);\n    if (ext) {\n      return ext;\n    }\n    if (name !== 'OES_vertex_array_object') {\n      return null;\n    }\n\n    if (!gl.__OESVertexArrayObject) {\n      this.__OESVertexArrayObject = new OESVertexArrayObject(this);\n    }\n    return this.__OESVertexArrayObject;\n  };\n}\n","// Support for listening to context state changes and intercepting state queries\n// NOTE: this system does not handle buffer bindings\n/** @typedef {import('./track-context-state')} types */\n\nimport {GL_PARAMETER_DEFAULTS, GL_HOOKED_SETTERS} from './webgl-parameter-tables';\nimport {setParameters, getParameters} from './unified-parameter-api';\nimport {assert} from '../utils/assert';\nimport {deepArrayEqual} from '../utils/utils';\n\n// HELPER FUNCTIONS - INSTALL GET/SET INTERCEPTORS (SPYS) ON THE CONTEXT\n\n// Overrides a WebGLRenderingContext state \"getter\" function\n// to return values directly from cache\nfunction installGetterOverride(gl, functionName) {\n  // Get the original function from the WebGLRenderingContext\n  const originalGetterFunc = gl[functionName].bind(gl);\n\n  // Wrap it with a spy so that we can update our state cache when it gets called\n  gl[functionName] = function get(...params) {\n    const pname = params[0];\n\n    // WebGL limits are not prepopulated in the cache, it's neither undefined in GL_PARAMETER_DEFAULTS\n    // nor intercepted by GL_HOOKED_SETTERS. Query the original getter.\n    if (!(pname in gl.state.cache)) {\n      return originalGetterFunc(...params);\n    }\n\n    // Optionally call the original function to do a \"hard\" query from the WebGLRenderingContext\n    return gl.state.enable\n      ? // Call the getter the params so that it can e.g. serve from a cache\n        gl.state.cache[pname]\n      : // Optionally call the original function to do a \"hard\" query from the WebGLRenderingContext\n        originalGetterFunc(...params);\n  };\n\n  // Set the name of this anonymous function to help in debugging and profiling\n  Object.defineProperty(gl[functionName], 'name', {\n    value: `${functionName}-from-cache`,\n    configurable: false\n  });\n}\n\n// Overrides a WebGLRenderingContext state \"setter\" function\n// to call a setter spy before the actual setter. Allows us to keep a cache\n// updated with a copy of the WebGL context state.\nfunction installSetterSpy(gl, functionName, setter) {\n  // Get the original function from the WebGLRenderingContext\n  const originalSetterFunc = gl[functionName].bind(gl);\n\n  // Wrap it with a spy so that we can update our state cache when it gets called\n  gl[functionName] = function set(...params) {\n    // Update the value\n    // Call the setter with the state cache and the params so that it can store the parameters\n    const {valueChanged, oldValue} = setter(gl.state._updateCache, ...params);\n\n    // Call the original WebGLRenderingContext func to make sure the context actually gets updated\n    if (valueChanged) {\n      originalSetterFunc(...params);\n    }\n\n    // Note: if the original function fails to set the value, our state cache will be bad\n    // No solution for this at the moment, but assuming that this is unlikely to be a real problem\n    // We could call the setter after the originalSetterFunc. Concern is that this would\n    // cause different behavior in debug mode, where originalSetterFunc can throw exceptions\n\n    return oldValue;\n  };\n\n  // Set the name of this anonymous function to help in debugging and profiling\n  Object.defineProperty(gl[functionName], 'name', {\n    value: `${functionName}-to-cache`,\n    configurable: false\n  });\n}\n\nfunction installProgramSpy(gl) {\n  const originalUseProgram = gl.useProgram.bind(gl);\n\n  gl.useProgram = function useProgramLuma(handle) {\n    if (gl.state.program !== handle) {\n      originalUseProgram(handle);\n      gl.state.program = handle;\n    }\n  };\n}\n\n// HELPER CLASS - GLState\n\n/* eslint-disable no-shadow */\nclass GLState {\n  constructor(\n    gl,\n    {\n      copyState = false, // Copy cache from params (slow) or initialize from WebGL defaults (fast)\n      log = () => {} // Logging function, called when gl parameter change calls are actually issued\n    } = {}\n  ) {\n    this.gl = gl;\n    this.program = null;\n    this.stateStack = [];\n    this.enable = true;\n    this.cache = copyState ? getParameters(gl) : Object.assign({}, GL_PARAMETER_DEFAULTS);\n    this.log = log;\n\n    this._updateCache = this._updateCache.bind(this);\n    Object.seal(this);\n  }\n\n  push(values = {}) {\n    this.stateStack.push({});\n  }\n\n  pop() {\n    assert(this.stateStack.length > 0);\n    // Use the saved values in the state stack to restore parameters\n    const oldValues = this.stateStack[this.stateStack.length - 1];\n    setParameters(this.gl, oldValues);\n    // Don't pop until we have reset parameters (to make sure other \"stack frames\" are not affected)\n    this.stateStack.pop();\n  }\n\n  // interceptor for context set functions - update our cache and our stack\n  // values (Object) - the key values for this setter\n  _updateCache(values) {\n    let valueChanged = false;\n    let oldValue; // = undefined\n\n    const oldValues = this.stateStack.length > 0 && this.stateStack[this.stateStack.length - 1];\n\n    for (const key in values) {\n      assert(key !== undefined);\n      const value = values[key];\n      const cached = this.cache[key];\n      // Check that value hasn't already been shadowed\n      if (!deepArrayEqual(value, cached)) {\n        valueChanged = true;\n        oldValue = cached;\n\n        // First, save current value being shadowed\n        // If a state stack frame is active, save the current parameter values for pop\n        // but first check that value hasn't already been shadowed and saved\n        if (oldValues && !(key in oldValues)) {\n          oldValues[key] = cached;\n        }\n\n        // Save current value being shadowed\n        this.cache[key] = value;\n      }\n    }\n\n    return {valueChanged, oldValue};\n  }\n}\n\n// PUBLIC API\n\n/**\n * Initialize WebGL state caching on a context\n * @type {types['trackContextState']}\n */\n// After calling this function, context state will be cached\n// gl.state.push() and gl.state.pop() will be available for saving,\n// temporarily modifying, and then restoring state.\nexport function trackContextState(gl, options = {}) {\n  const {enable = true, copyState} = options;\n  assert(copyState !== undefined);\n  // @ts-ignore\n  if (!gl.state) {\n    // @ts-ignore\n    const {polyfillContext} = globalThis;\n    if (polyfillContext) {\n      polyfillContext(gl);\n    }\n\n    // Create a state cache\n    // @ts-ignore\n    gl.state = new GLState(gl, {copyState});\n\n    installProgramSpy(gl);\n\n    // intercept all setter functions in the table\n    for (const key in GL_HOOKED_SETTERS) {\n      const setter = GL_HOOKED_SETTERS[key];\n      installSetterSpy(gl, key, setter);\n    }\n\n    // intercept all getter functions in the table\n    installGetterOverride(gl, 'getParameter');\n    installGetterOverride(gl, 'isEnabled');\n  }\n\n  // @ts-ignore\n  gl.state.enable = enable;\n\n  return gl;\n}\n\n/**\n * Initialize WebGL state caching on a context\n * @type {types['pushContextState']}\n */\nexport function pushContextState(gl) {\n  // @ts-ignore\n  if (!gl.state) {\n    trackContextState(gl, {copyState: false});\n  }\n  // @ts-ignore\n  gl.state.push();\n}\n\n/**\n * Initialize WebGL state caching on a context\n * @type {types['popContextState']}\n */\nexport function popContextState(gl) {\n  // @ts-ignore\n  assert(gl.state);\n  // @ts-ignore\n  gl.state.pop();\n}\n","// Provides a unified API for getting and setting any WebGL parameter\n// Also knows default values of all parameters, enabling fast cache initialization\n// Provides base functionality for the state caching.\nimport {\n  GL_PARAMETER_DEFAULTS,\n  GL_PARAMETER_SETTERS,\n  GL_COMPOSITE_PARAMETER_SETTERS,\n  GL_PARAMETER_GETTERS\n} from './webgl-parameter-tables';\n\nimport {pushContextState, popContextState} from './track-context-state';\nimport {assert} from '../utils/assert';\nimport {isWebGL} from '../utils/webgl-checks';\nimport {isObjectEmpty} from '../utils/utils';\n\n// Sets any GL parameter regardless of function (gl.blendMode, ...)\n// Note: requires a `cache` object to be set on the context (gl.state.cache)\n// This object is used to fill in any missing values for composite setter functions\nexport function setParameters(gl, values) {\n  assert(isWebGL(gl), 'setParameters requires a WebGL context');\n\n  if (isObjectEmpty(values)) {\n    return;\n  }\n\n  const compositeSetters = {};\n\n  // HANDLE PRIMITIVE SETTERS (and make note of any composite setters)\n\n  for (const key in values) {\n    const glConstant = Number(key);\n    const setter = GL_PARAMETER_SETTERS[key];\n    if (setter) {\n      // Composite setters should only be called once, so save them\n      if (typeof setter === 'string') {\n        compositeSetters[setter] = true;\n      } else {\n        // if (gl[glConstant] !== undefined) {\n        // TODO - added above check since this is being called on WebGL2 values in WebGL1...\n        // TODO - deep equal on values? only call setter if value has changed?\n        // NOTE - the setter will automatically update this.state\n        setter(gl, values[key], glConstant);\n      }\n    }\n  }\n\n  // HANDLE COMPOSITE SETTERS\n\n  // NOTE: any non-provided values needed by composite setters are filled in from state cache\n  // The cache parameter is automatically retrieved from the context\n  // This depends on `trackContextState`, which is technically a \"circular\" dependency.\n  // But it is too inconvenient to always require a cache parameter here.\n  // This is the ONLY external dependency in this module/\n  const cache = gl.state && gl.state.cache;\n  if (cache) {\n    for (const key in compositeSetters) {\n      // TODO - avoid calling composite setters if values have not changed.\n      const compositeSetter = GL_COMPOSITE_PARAMETER_SETTERS[key];\n      // Note - if `trackContextState` has been called,\n      // the setter will automatically update this.state.cache\n      compositeSetter(gl, values, cache);\n    }\n  }\n\n  // Add a log for the else case?\n}\n\n// Copies the state from a context (gl.getParameter should not be overriden)\n// Reads the entire WebGL state from a context\n// Caveat: This generates a huge amount of synchronous driver roundtrips and should be\n// considered a very slow operation, to be used only if/when a context already manipulated\n// by external code needs to be synchronized for the first time\n// @return {Object} - a newly created map, with values keyed by GL parameters\nexport function getParameters(gl, parameters) {\n  // default to querying all parameters\n  parameters = parameters || GL_PARAMETER_DEFAULTS;\n  // support both arrays of parameters and objects (keys represent parameters)\n\n  if (typeof parameters === 'number') {\n    // single GL enum\n    const key = parameters;\n    const getter = GL_PARAMETER_GETTERS[key];\n    return getter ? getter(gl, key) : gl.getParameter(key);\n  }\n\n  const parameterKeys = Array.isArray(parameters) ? parameters : Object.keys(parameters);\n\n  const state = {};\n  for (const key of parameterKeys) {\n    const getter = GL_PARAMETER_GETTERS[key];\n    state[key] = getter ? getter(gl, Number(key)) : gl.getParameter(Number(key));\n  }\n  return state;\n}\n\n// Reset all parameters to a (almost) pure context state\n// NOTE: viewport and scissor will be set to the values in GL_PARAMETER_DEFAULTS,\n//   NOT the canvas size dimensions, so they will have to be properly set after\n//   calling this function.\nexport function resetParameters(gl) {\n  setParameters(gl, GL_PARAMETER_DEFAULTS);\n}\n\n// Stores current \"global\" WebGL context settings, changes selected parameters,\n// executes function, restores parameters\nexport function withParameters(gl, parameters, func) {\n  if (isObjectEmpty(parameters)) {\n    // Avoid setting state if no parameters provided. Just call and return\n    return func(gl);\n  }\n\n  const {nocatch = true} = parameters;\n\n  pushContextState(gl);\n  setParameters(gl, parameters);\n\n  // Setup is done, call the function\n  let value;\n\n  if (nocatch) {\n    // Avoid try catch to minimize stack size impact for safe execution paths\n    value = func(gl);\n    popContextState(gl);\n  } else {\n    // Wrap in a try-catch to ensure that parameters are restored on exceptions\n    try {\n      value = func(gl);\n    } finally {\n      popContextState(gl);\n    }\n  }\n\n  return value;\n}\n","// Tables describing WebGL parameters\nimport GL from '@luma.gl/constants';\nimport {isWebGL2} from '../utils/webgl-checks';\n\n// DEFAULT SETTINGS - FOR FAST CACHE INITIALIZATION AND CONTEXT RESETS\n\n/* eslint-disable no-shadow */\n\nexport const GL_PARAMETER_DEFAULTS = {\n  [GL.BLEND]: false,\n  [GL.BLEND_COLOR]: new Float32Array([0, 0, 0, 0]),\n  [GL.BLEND_EQUATION_RGB]: GL.FUNC_ADD,\n  [GL.BLEND_EQUATION_ALPHA]: GL.FUNC_ADD,\n  [GL.BLEND_SRC_RGB]: GL.ONE,\n  [GL.BLEND_DST_RGB]: GL.ZERO,\n  [GL.BLEND_SRC_ALPHA]: GL.ONE,\n  [GL.BLEND_DST_ALPHA]: GL.ZERO,\n  [GL.COLOR_CLEAR_VALUE]: new Float32Array([0, 0, 0, 0]), // TBD\n  [GL.COLOR_WRITEMASK]: [true, true, true, true],\n  [GL.CULL_FACE]: false,\n  [GL.CULL_FACE_MODE]: GL.BACK,\n  [GL.DEPTH_TEST]: false,\n  [GL.DEPTH_CLEAR_VALUE]: 1,\n  [GL.DEPTH_FUNC]: GL.LESS,\n  [GL.DEPTH_RANGE]: new Float32Array([0, 1]), // TBD\n  [GL.DEPTH_WRITEMASK]: true,\n  [GL.DITHER]: true,\n  // FRAMEBUFFER_BINDING and DRAW_FRAMEBUFFER_BINDING(WebGL2) refer same state.\n  [GL.FRAMEBUFFER_BINDING]: null,\n  [GL.FRONT_FACE]: GL.CCW,\n  [GL.GENERATE_MIPMAP_HINT]: GL.DONT_CARE,\n  [GL.LINE_WIDTH]: 1,\n  [GL.POLYGON_OFFSET_FILL]: false,\n  [GL.POLYGON_OFFSET_FACTOR]: 0,\n  [GL.POLYGON_OFFSET_UNITS]: 0,\n  [GL.SAMPLE_COVERAGE_VALUE]: 1.0,\n  [GL.SAMPLE_COVERAGE_INVERT]: false,\n  [GL.SCISSOR_TEST]: false,\n  // Note: Dynamic value. If scissor test enabled we expect users to set correct scissor box\n  [GL.SCISSOR_BOX]: new Int32Array([0, 0, 1024, 1024]),\n  [GL.STENCIL_TEST]: false,\n  [GL.STENCIL_CLEAR_VALUE]: 0,\n  [GL.STENCIL_WRITEMASK]: 0xffffffff,\n  [GL.STENCIL_BACK_WRITEMASK]: 0xffffffff,\n  [GL.STENCIL_FUNC]: GL.ALWAYS,\n  [GL.STENCIL_REF]: 0,\n  [GL.STENCIL_VALUE_MASK]: 0xffffffff,\n  [GL.STENCIL_BACK_FUNC]: GL.ALWAYS,\n  [GL.STENCIL_BACK_REF]: 0,\n  [GL.STENCIL_BACK_VALUE_MASK]: 0xffffffff,\n  [GL.STENCIL_FAIL]: GL.KEEP,\n  [GL.STENCIL_PASS_DEPTH_FAIL]: GL.KEEP,\n  [GL.STENCIL_PASS_DEPTH_PASS]: GL.KEEP,\n  [GL.STENCIL_BACK_FAIL]: GL.KEEP,\n  [GL.STENCIL_BACK_PASS_DEPTH_FAIL]: GL.KEEP,\n  [GL.STENCIL_BACK_PASS_DEPTH_PASS]: GL.KEEP,\n  // Dynamic value: We use [0, 0, 1024, 1024] as default, but usually this is updated in each frame.\n  [GL.VIEWPORT]: [0, 0, 1024, 1024],\n  // WEBGL1 PIXEL PACK/UNPACK MODES\n  [GL.PACK_ALIGNMENT]: 4,\n  [GL.UNPACK_ALIGNMENT]: 4,\n  [GL.UNPACK_FLIP_Y_WEBGL]: false,\n  [GL.UNPACK_PREMULTIPLY_ALPHA_WEBGL]: false,\n  [GL.UNPACK_COLORSPACE_CONVERSION_WEBGL]: GL.BROWSER_DEFAULT_WEBGL,\n\n  // WEBGL2 / EXTENSIONS\n  // gl1: 'OES_standard_derivatives'\n  [GL.FRAGMENT_SHADER_DERIVATIVE_HINT]: GL.DONT_CARE,\n  [GL.READ_FRAMEBUFFER_BINDING]: null,\n  [GL.RASTERIZER_DISCARD]: false,\n  [GL.PACK_ROW_LENGTH]: 0,\n  [GL.PACK_SKIP_PIXELS]: 0,\n  [GL.PACK_SKIP_ROWS]: 0,\n  [GL.UNPACK_ROW_LENGTH]: 0,\n  [GL.UNPACK_IMAGE_HEIGHT]: 0,\n  [GL.UNPACK_SKIP_PIXELS]: 0,\n  [GL.UNPACK_SKIP_ROWS]: 0,\n  [GL.UNPACK_SKIP_IMAGES]: 0\n};\n\n// SETTER TABLES - ENABLES SETTING ANY PARAMETER WITH A COMMON API\n\nconst enable = (gl, value, key) => (value ? gl.enable(key) : gl.disable(key));\nconst hint = (gl, value, key) => gl.hint(key, value);\nconst pixelStorei = (gl, value, key) => gl.pixelStorei(key, value);\n\nconst drawFramebuffer = (gl, value) => {\n  const target = isWebGL2(gl) ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER;\n  return gl.bindFramebuffer(target, value);\n};\nconst readFramebuffer = (gl, value) => {\n  return gl.bindFramebuffer(GL.READ_FRAMEBUFFER, value);\n};\n\n// Utility\nfunction isArray(array) {\n  return Array.isArray(array) || ArrayBuffer.isView(array);\n}\n\n// Map from WebGL parameter names to corresponding WebGL setter functions\n// WegGL constants are read by parameter names, but set by function names\n// NOTE: When value type is a string, it will be handled by 'GL_COMPOSITE_PARAMETER_SETTERS'\nexport const GL_PARAMETER_SETTERS = {\n  [GL.BLEND]: enable,\n  [GL.BLEND_COLOR]: (gl, value) => gl.blendColor(...value),\n  [GL.BLEND_EQUATION_RGB]: 'blendEquation',\n  [GL.BLEND_EQUATION_ALPHA]: 'blendEquation',\n  [GL.BLEND_SRC_RGB]: 'blendFunc',\n  [GL.BLEND_DST_RGB]: 'blendFunc',\n  [GL.BLEND_SRC_ALPHA]: 'blendFunc',\n  [GL.BLEND_DST_ALPHA]: 'blendFunc',\n  [GL.COLOR_CLEAR_VALUE]: (gl, value) => gl.clearColor(...value),\n  [GL.COLOR_WRITEMASK]: (gl, value) => gl.colorMask(...value),\n  [GL.CULL_FACE]: enable,\n  [GL.CULL_FACE_MODE]: (gl, value) => gl.cullFace(value),\n  [GL.DEPTH_TEST]: enable,\n  [GL.DEPTH_CLEAR_VALUE]: (gl, value) => gl.clearDepth(value),\n  [GL.DEPTH_FUNC]: (gl, value) => gl.depthFunc(value),\n  [GL.DEPTH_RANGE]: (gl, value) => gl.depthRange(...value),\n  [GL.DEPTH_WRITEMASK]: (gl, value) => gl.depthMask(value),\n  [GL.DITHER]: enable,\n  [GL.FRAGMENT_SHADER_DERIVATIVE_HINT]: hint,\n  // NOTE: FRAMEBUFFER_BINDING and DRAW_FRAMEBUFFER_BINDING(WebGL2) refer same state.\n  [GL.FRAMEBUFFER_BINDING]: drawFramebuffer,\n  [GL.FRONT_FACE]: (gl, value) => gl.frontFace(value),\n  [GL.GENERATE_MIPMAP_HINT]: hint,\n  [GL.LINE_WIDTH]: (gl, value) => gl.lineWidth(value),\n  [GL.POLYGON_OFFSET_FILL]: enable,\n  [GL.POLYGON_OFFSET_FACTOR]: 'polygonOffset',\n  [GL.POLYGON_OFFSET_UNITS]: 'polygonOffset',\n  [GL.RASTERIZER_DISCARD]: enable,\n  [GL.SAMPLE_COVERAGE_VALUE]: 'sampleCoverage',\n  [GL.SAMPLE_COVERAGE_INVERT]: 'sampleCoverage',\n  [GL.SCISSOR_TEST]: enable,\n  [GL.SCISSOR_BOX]: (gl, value) => gl.scissor(...value),\n  [GL.STENCIL_TEST]: enable,\n  [GL.STENCIL_CLEAR_VALUE]: (gl, value) => gl.clearStencil(value),\n  [GL.STENCIL_WRITEMASK]: (gl, value) => gl.stencilMaskSeparate(GL.FRONT, value),\n  [GL.STENCIL_BACK_WRITEMASK]: (gl, value) => gl.stencilMaskSeparate(GL.BACK, value),\n  [GL.STENCIL_FUNC]: 'stencilFuncFront',\n  [GL.STENCIL_REF]: 'stencilFuncFront',\n  [GL.STENCIL_VALUE_MASK]: 'stencilFuncFront',\n  [GL.STENCIL_BACK_FUNC]: 'stencilFuncBack',\n  [GL.STENCIL_BACK_REF]: 'stencilFuncBack',\n  [GL.STENCIL_BACK_VALUE_MASK]: 'stencilFuncBack',\n  [GL.STENCIL_FAIL]: 'stencilOpFront',\n  [GL.STENCIL_PASS_DEPTH_FAIL]: 'stencilOpFront',\n  [GL.STENCIL_PASS_DEPTH_PASS]: 'stencilOpFront',\n  [GL.STENCIL_BACK_FAIL]: 'stencilOpBack',\n  [GL.STENCIL_BACK_PASS_DEPTH_FAIL]: 'stencilOpBack',\n  [GL.STENCIL_BACK_PASS_DEPTH_PASS]: 'stencilOpBack',\n  [GL.VIEWPORT]: (gl, value) => gl.viewport(...value),\n\n  // WEBGL1 PIXEL PACK/UNPACK MODES\n  [GL.PACK_ALIGNMENT]: pixelStorei,\n  [GL.UNPACK_ALIGNMENT]: pixelStorei,\n  [GL.UNPACK_FLIP_Y_WEBGL]: pixelStorei,\n  [GL.UNPACK_PREMULTIPLY_ALPHA_WEBGL]: pixelStorei,\n  [GL.UNPACK_COLORSPACE_CONVERSION_WEBGL]: pixelStorei,\n\n  // WEBGL2 PIXEL PACK/UNPACK MODES\n  // RASTERIZER_DISCARD ...\n  [GL.PACK_ROW_LENGTH]: pixelStorei,\n  [GL.PACK_SKIP_PIXELS]: pixelStorei,\n  [GL.PACK_SKIP_ROWS]: pixelStorei,\n  [GL.READ_FRAMEBUFFER_BINDING]: readFramebuffer,\n  [GL.UNPACK_ROW_LENGTH]: pixelStorei,\n  [GL.UNPACK_IMAGE_HEIGHT]: pixelStorei,\n  [GL.UNPACK_SKIP_PIXELS]: pixelStorei,\n  [GL.UNPACK_SKIP_ROWS]: pixelStorei,\n  [GL.UNPACK_SKIP_IMAGES]: pixelStorei,\n\n  // Function-style setters\n  framebuffer: (gl, framebuffer) => {\n    // accepts 1) a WebGLFramebuffer 2) null (default framebuffer), or 3) luma.gl Framebuffer class\n    // framebuffer is null when restoring to default framebuffer, otherwise use the WebGL handle.\n    const handle = framebuffer && 'handle' in framebuffer ? framebuffer.handle : framebuffer;\n    return gl.bindFramebuffer(GL.FRAMEBUFFER, handle);\n  },\n  blend: (gl, value) => (value ? gl.enable(GL.BLEND) : gl.disable(GL.BLEND)),\n  blendColor: (gl, value) => gl.blendColor(...value),\n  blendEquation: (gl, args) => {\n    args = isArray(args) ? args : [args, args];\n    gl.blendEquationSeparate(...args);\n  },\n  blendFunc: (gl, args) => {\n    args = isArray(args) && args.length === 2 ? [...args, ...args] : args;\n    gl.blendFuncSeparate(...args);\n  },\n\n  clearColor: (gl, value) => gl.clearColor(...value),\n  clearDepth: (gl, value) => gl.clearDepth(value),\n  clearStencil: (gl, value) => gl.clearStencil(value),\n\n  colorMask: (gl, value) => gl.colorMask(...value),\n\n  cull: (gl, value) => (value ? gl.enable(GL.CULL_FACE) : gl.disable(GL.CULL_FACE)),\n  cullFace: (gl, value) => gl.cullFace(value),\n\n  depthTest: (gl, value) => (value ? gl.enable(GL.DEPTH_TEST) : gl.disable(GL.DEPTH_TEST)),\n  depthFunc: (gl, value) => gl.depthFunc(value),\n  depthMask: (gl, value) => gl.depthMask(value),\n  depthRange: (gl, value) => gl.depthRange(...value),\n\n  dither: (gl, value) => (value ? gl.enable(GL.DITHER) : gl.disable(GL.DITHER)),\n\n  derivativeHint: (gl, value) => {\n    // gl1: 'OES_standard_derivatives'\n    gl.hint(GL.FRAGMENT_SHADER_DERIVATIVE_HINT, value);\n  },\n\n  frontFace: (gl, value) => gl.frontFace(value),\n\n  mipmapHint: (gl, value) => gl.hint(GL.GENERATE_MIPMAP_HINT, value),\n\n  lineWidth: (gl, value) => gl.lineWidth(value),\n\n  polygonOffsetFill: (gl, value) =>\n    value ? gl.enable(GL.POLYGON_OFFSET_FILL) : gl.disable(GL.POLYGON_OFFSET_FILL),\n  polygonOffset: (gl, value) => gl.polygonOffset(...value),\n\n  sampleCoverage: (gl, value) => gl.sampleCoverage(...value),\n\n  scissorTest: (gl, value) => (value ? gl.enable(GL.SCISSOR_TEST) : gl.disable(GL.SCISSOR_TEST)),\n  scissor: (gl, value) => gl.scissor(...value),\n\n  stencilTest: (gl, value) => (value ? gl.enable(GL.STENCIL_TEST) : gl.disable(GL.STENCIL_TEST)),\n  stencilMask: (gl, value) => {\n    value = isArray(value) ? value : [value, value];\n    const [mask, backMask] = value;\n    gl.stencilMaskSeparate(GL.FRONT, mask);\n    gl.stencilMaskSeparate(GL.BACK, backMask);\n  },\n  stencilFunc: (gl, args) => {\n    args = isArray(args) && args.length === 3 ? [...args, ...args] : args;\n    const [func, ref, mask, backFunc, backRef, backMask] = args;\n    gl.stencilFuncSeparate(GL.FRONT, func, ref, mask);\n    gl.stencilFuncSeparate(GL.BACK, backFunc, backRef, backMask);\n  },\n  stencilOp: (gl, args) => {\n    args = isArray(args) && args.length === 3 ? [...args, ...args] : args;\n    const [sfail, dpfail, dppass, backSfail, backDpfail, backDppass] = args;\n    gl.stencilOpSeparate(GL.FRONT, sfail, dpfail, dppass);\n    gl.stencilOpSeparate(GL.BACK, backSfail, backDpfail, backDppass);\n  },\n\n  viewport: (gl, value) => gl.viewport(...value)\n};\n\nfunction getValue(glEnum, values, cache) {\n  return values[glEnum] !== undefined ? values[glEnum] : cache[glEnum];\n}\n\n// COMPOSITE_WEBGL_PARAMETER_\nexport const GL_COMPOSITE_PARAMETER_SETTERS = {\n  blendEquation: (gl, values, cache) =>\n    gl.blendEquationSeparate(\n      getValue(GL.BLEND_EQUATION_RGB, values, cache),\n      getValue(GL.BLEND_EQUATION_ALPHA, values, cache)\n    ),\n  blendFunc: (gl, values, cache) =>\n    gl.blendFuncSeparate(\n      getValue(GL.BLEND_SRC_RGB, values, cache),\n      getValue(GL.BLEND_DST_RGB, values, cache),\n      getValue(GL.BLEND_SRC_ALPHA, values, cache),\n      getValue(GL.BLEND_DST_ALPHA, values, cache)\n    ),\n  polygonOffset: (gl, values, cache) =>\n    gl.polygonOffset(\n      getValue(GL.POLYGON_OFFSET_FACTOR, values, cache),\n      getValue(GL.POLYGON_OFFSET_UNITS, values, cache)\n    ),\n  sampleCoverage: (gl, values, cache) =>\n    gl.sampleCoverage(\n      getValue(GL.SAMPLE_COVERAGE_VALUE, values, cache),\n      getValue(GL.SAMPLE_COVERAGE_INVERT, values, cache)\n    ),\n  stencilFuncFront: (gl, values, cache) =>\n    gl.stencilFuncSeparate(\n      GL.FRONT,\n      getValue(GL.STENCIL_FUNC, values, cache),\n      getValue(GL.STENCIL_REF, values, cache),\n      getValue(GL.STENCIL_VALUE_MASK, values, cache)\n    ),\n  stencilFuncBack: (gl, values, cache) =>\n    gl.stencilFuncSeparate(\n      GL.BACK,\n      getValue(GL.STENCIL_BACK_FUNC, values, cache),\n      getValue(GL.STENCIL_BACK_REF, values, cache),\n      getValue(GL.STENCIL_BACK_VALUE_MASK, values, cache)\n    ),\n  stencilOpFront: (gl, values, cache) =>\n    gl.stencilOpSeparate(\n      GL.FRONT,\n      getValue(GL.STENCIL_FAIL, values, cache),\n      getValue(GL.STENCIL_PASS_DEPTH_FAIL, values, cache),\n      getValue(GL.STENCIL_PASS_DEPTH_PASS, values, cache)\n    ),\n  stencilOpBack: (gl, values, cache) =>\n    gl.stencilOpSeparate(\n      GL.BACK,\n      getValue(GL.STENCIL_BACK_FAIL, values, cache),\n      getValue(GL.STENCIL_BACK_PASS_DEPTH_FAIL, values, cache),\n      getValue(GL.STENCIL_BACK_PASS_DEPTH_PASS, values, cache)\n    )\n};\n\n// Setter functions intercepted for cache updates\nexport const GL_HOOKED_SETTERS = {\n  // GENERIC SETTERS\n\n  enable: (update, capability) =>\n    update({\n      [capability]: true\n    }),\n  disable: (update, capability) =>\n    update({\n      [capability]: false\n    }),\n  pixelStorei: (update, pname, value) =>\n    update({\n      [pname]: value\n    }),\n  hint: (update, pname, hint) =>\n    update({\n      [pname]: hint\n    }),\n\n  // SPECIFIC SETTERS\n\n  bindFramebuffer: (update, target, framebuffer) => {\n    switch (target) {\n      case GL.FRAMEBUFFER:\n        return update({\n          [GL.DRAW_FRAMEBUFFER_BINDING]: framebuffer,\n          [GL.READ_FRAMEBUFFER_BINDING]: framebuffer\n        });\n      case GL.DRAW_FRAMEBUFFER:\n        return update({[GL.DRAW_FRAMEBUFFER_BINDING]: framebuffer});\n      case GL.READ_FRAMEBUFFER:\n        return update({[GL.READ_FRAMEBUFFER_BINDING]: framebuffer});\n      default:\n        return null;\n    }\n  },\n  blendColor: (update, r, g, b, a) =>\n    update({\n      [GL.BLEND_COLOR]: new Float32Array([r, g, b, a])\n    }),\n\n  blendEquation: (update, mode) =>\n    update({\n      [GL.BLEND_EQUATION_RGB]: mode,\n      [GL.BLEND_EQUATION_ALPHA]: mode\n    }),\n\n  blendEquationSeparate: (update, modeRGB, modeAlpha) =>\n    update({\n      [GL.BLEND_EQUATION_RGB]: modeRGB,\n      [GL.BLEND_EQUATION_ALPHA]: modeAlpha\n    }),\n\n  blendFunc: (update, src, dst) =>\n    update({\n      [GL.BLEND_SRC_RGB]: src,\n      [GL.BLEND_DST_RGB]: dst,\n      [GL.BLEND_SRC_ALPHA]: src,\n      [GL.BLEND_DST_ALPHA]: dst\n    }),\n\n  blendFuncSeparate: (update, srcRGB, dstRGB, srcAlpha, dstAlpha) =>\n    update({\n      [GL.BLEND_SRC_RGB]: srcRGB,\n      [GL.BLEND_DST_RGB]: dstRGB,\n      [GL.BLEND_SRC_ALPHA]: srcAlpha,\n      [GL.BLEND_DST_ALPHA]: dstAlpha\n    }),\n\n  clearColor: (update, r, g, b, a) =>\n    update({\n      [GL.COLOR_CLEAR_VALUE]: new Float32Array([r, g, b, a])\n    }),\n\n  clearDepth: (update, depth) =>\n    update({\n      [GL.DEPTH_CLEAR_VALUE]: depth\n    }),\n\n  clearStencil: (update, s) =>\n    update({\n      [GL.STENCIL_CLEAR_VALUE]: s\n    }),\n\n  colorMask: (update, r, g, b, a) =>\n    update({\n      [GL.COLOR_WRITEMASK]: [r, g, b, a]\n    }),\n\n  cullFace: (update, mode) =>\n    update({\n      [GL.CULL_FACE_MODE]: mode\n    }),\n\n  depthFunc: (update, func) =>\n    update({\n      [GL.DEPTH_FUNC]: func\n    }),\n\n  depthRange: (update, zNear, zFar) =>\n    update({\n      [GL.DEPTH_RANGE]: new Float32Array([zNear, zFar])\n    }),\n\n  depthMask: (update, mask) =>\n    update({\n      [GL.DEPTH_WRITEMASK]: mask\n    }),\n\n  frontFace: (update, face) =>\n    update({\n      [GL.FRONT_FACE]: face\n    }),\n\n  lineWidth: (update, width) =>\n    update({\n      [GL.LINE_WIDTH]: width\n    }),\n\n  polygonOffset: (update, factor, units) =>\n    update({\n      [GL.POLYGON_OFFSET_FACTOR]: factor,\n      [GL.POLYGON_OFFSET_UNITS]: units\n    }),\n\n  sampleCoverage: (update, value, invert) =>\n    update({\n      [GL.SAMPLE_COVERAGE_VALUE]: value,\n      [GL.SAMPLE_COVERAGE_INVERT]: invert\n    }),\n\n  scissor: (update, x, y, width, height) =>\n    update({\n      [GL.SCISSOR_BOX]: new Int32Array([x, y, width, height])\n    }),\n\n  stencilMask: (update, mask) =>\n    update({\n      [GL.STENCIL_WRITEMASK]: mask,\n      [GL.STENCIL_BACK_WRITEMASK]: mask\n    }),\n\n  stencilMaskSeparate: (update, face, mask) =>\n    update({\n      [face === GL.FRONT ? GL.STENCIL_WRITEMASK : GL.STENCIL_BACK_WRITEMASK]: mask\n    }),\n\n  stencilFunc: (update, func, ref, mask) =>\n    update({\n      [GL.STENCIL_FUNC]: func,\n      [GL.STENCIL_REF]: ref,\n      [GL.STENCIL_VALUE_MASK]: mask,\n      [GL.STENCIL_BACK_FUNC]: func,\n      [GL.STENCIL_BACK_REF]: ref,\n      [GL.STENCIL_BACK_VALUE_MASK]: mask\n    }),\n\n  stencilFuncSeparate: (update, face, func, ref, mask) =>\n    update({\n      [face === GL.FRONT ? GL.STENCIL_FUNC : GL.STENCIL_BACK_FUNC]: func,\n      [face === GL.FRONT ? GL.STENCIL_REF : GL.STENCIL_BACK_REF]: ref,\n      [face === GL.FRONT ? GL.STENCIL_VALUE_MASK : GL.STENCIL_BACK_VALUE_MASK]: mask\n    }),\n\n  stencilOp: (update, fail, zfail, zpass) =>\n    update({\n      [GL.STENCIL_FAIL]: fail,\n      [GL.STENCIL_PASS_DEPTH_FAIL]: zfail,\n      [GL.STENCIL_PASS_DEPTH_PASS]: zpass,\n      [GL.STENCIL_BACK_FAIL]: fail,\n      [GL.STENCIL_BACK_PASS_DEPTH_FAIL]: zfail,\n      [GL.STENCIL_BACK_PASS_DEPTH_PASS]: zpass\n    }),\n\n  stencilOpSeparate: (update, face, fail, zfail, zpass) =>\n    update({\n      [face === GL.FRONT ? GL.STENCIL_FAIL : GL.STENCIL_BACK_FAIL]: fail,\n      [face === GL.FRONT ? GL.STENCIL_PASS_DEPTH_FAIL : GL.STENCIL_BACK_PASS_DEPTH_FAIL]: zfail,\n      [face === GL.FRONT ? GL.STENCIL_PASS_DEPTH_PASS : GL.STENCIL_BACK_PASS_DEPTH_PASS]: zpass\n    }),\n\n  viewport: (update, x, y, width, height) =>\n    update({\n      [GL.VIEWPORT]: [x, y, width, height]\n    })\n};\n\n// GETTER TABLE - FOR READING OUT AN ENTIRE CONTEXT\n\nconst isEnabled = (gl, key) => gl.isEnabled(key);\n\n// Exceptions for any keys that cannot be queried by gl.getParameters\nexport const GL_PARAMETER_GETTERS = {\n  [GL.BLEND]: isEnabled,\n  [GL.CULL_FACE]: isEnabled,\n  [GL.DEPTH_TEST]: isEnabled,\n  [GL.DITHER]: isEnabled,\n  [GL.POLYGON_OFFSET_FILL]: isEnabled,\n  [GL.SAMPLE_ALPHA_TO_COVERAGE]: isEnabled,\n  [GL.SAMPLE_COVERAGE]: isEnabled,\n  [GL.SCISSOR_TEST]: isEnabled,\n  [GL.STENCIL_TEST]: isEnabled,\n\n  // WebGL 2\n  [GL.RASTERIZER_DISCARD]: isEnabled\n};\n","// Avoid bundling assert polyfill module\nexport function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'luma.gl: assertion failed.');\n  }\n}\n","/** @typedef {import('./device-pixels')} types */\n\n/**\n * Returns multiplier need to convert CSS size to Device size\n * @type {types['cssToDeviceRatio']}\n */\nexport function cssToDeviceRatio(gl) {\n  // @ts-ignore\n  const {luma} = gl;\n\n  if (gl.canvas && luma) {\n    // For headless gl we might have used custom width and height\n    // hence prioritize cached clientWidth\n    const cachedSize = luma.canvasSizeInfo;\n    const clientWidth =\n      'clientWidth' in cachedSize ? cachedSize.clientWidth : gl.canvas.clientWidth;\n    return clientWidth ? gl.drawingBufferWidth / clientWidth : 1;\n  }\n  // use default device pixel ratio\n  return 1;\n}\n\n/**\n * Maps CSS pixel position to device pixel position\n * @type {types['cssToDevicePixels']}\n */\nexport function cssToDevicePixels(gl, cssPixel, yInvert = true) {\n  const ratio = cssToDeviceRatio(gl);\n  const width = gl.drawingBufferWidth;\n  const height = gl.drawingBufferHeight;\n  return scalePixels(cssPixel, ratio, width, height, yInvert);\n}\n\n// HELPER METHOD\n\n/**\n * Calulates device pixel ratio, used during context creation\n * @type {types['getDevicePixelRatio']}\n */\nexport function getDevicePixelRatio(useDevicePixels) {\n  const windowRatio = typeof window === 'undefined' ? 1 : window.devicePixelRatio || 1;\n  if (Number.isFinite(useDevicePixels)) {\n    // @ts-ignore Can no longer be boolean after previous line\n    return useDevicePixels <= 0 ? 1 : useDevicePixels;\n  }\n  return useDevicePixels ? windowRatio : 1;\n}\n\n// PRIVATE\n\nfunction scalePixels(pixel, ratio, width, height, yInvert) {\n  const x = scaleX(pixel[0], ratio, width);\n  let y = scaleY(pixel[1], ratio, height, yInvert);\n\n  // Find boundaries of next pixel to provide valid range of device pixel locaitons\n\n  let t = scaleX(pixel[0] + 1, ratio, width);\n  // If next pixel's position is clamped to boundary, use it as is, otherwise subtract 1 for current pixel boundary\n  const xHigh = t === width - 1 ? t : t - 1;\n\n  t = scaleY(pixel[1] + 1, ratio, height, yInvert);\n  let yHigh;\n  if (yInvert) {\n    // If next pixel's position is clamped to boundary, use it as is, otherwise clamp it to valid range\n    t = t === 0 ? t : t + 1;\n    // swap y and yHigh\n    yHigh = y;\n    y = t;\n  } else {\n    // If next pixel's position is clamped to boundary, use it as is, otherwise clamp it to valid range\n    yHigh = t === height - 1 ? t : t - 1;\n    // y remains same\n  }\n  return {\n    x,\n    y,\n    // when ratio < 1, current css pixel and next css pixel may point to same device pixel, set width/height to 1 in those cases.\n    width: Math.max(xHigh - x + 1, 1),\n    height: Math.max(yHigh - y + 1, 1)\n  };\n}\n\nfunction scaleX(x, ratio, width) {\n  // since we are rounding to nearest, when ratio > 1, edge pixels may point to out of bounds value, clamp to the limit\n  const r = Math.min(Math.round(x * ratio), width - 1);\n  return r;\n}\n\nfunction scaleY(y, ratio, height, yInvert) {\n  // since we are rounding to nearest, when ratio > 1, edge pixels may point to out of bounds value, clamp to the limit\n  return yInvert\n    ? Math.max(0, height - 1 - Math.round(y * ratio))\n    : Math.min(Math.round(y * ratio), height - 1);\n}\n","import {Log} from '@probe.gl/log';\n\nexport const log = new Log({id: 'luma.gl'});\n","// Returns true if given object is empty, false otherwise.\nexport function isObjectEmpty(object) {\n  for (const key in object) {\n    return false;\n  }\n  return true;\n}\n\nexport function deepArrayEqual(x, y) {\n  if (x === y) {\n    return true;\n  }\n  const isArrayX = Array.isArray(x) || ArrayBuffer.isView(x);\n  const isArrayY = Array.isArray(y) || ArrayBuffer.isView(y);\n\n  // @ts-expect-error DataView...\n  if (isArrayX && isArrayY && x.length === y.length) {\n    // @ts-expect-error DataView...\n    for (let i = 0; i < x.length; ++i) {\n      if (x[i] !== y[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n","import {assert} from './assert';\n\nconst ERR_CONTEXT = 'Invalid WebGLRenderingContext';\nexport const ERR_WEBGL = ERR_CONTEXT;\nexport const ERR_WEBGL2 = 'Requires WebGL2';\n\nexport function isWebGL(gl) {\n  if (typeof WebGLRenderingContext !== 'undefined' && gl instanceof WebGLRenderingContext) {\n    return true;\n  }\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n  // Look for debug contexts, headless gl etc\n  return Boolean(gl && Number.isFinite(gl._version));\n}\n\nexport function isWebGL2(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n  // Look for debug contexts, headless gl etc\n  return Boolean(gl && gl._version === 2);\n}\n\nexport function getWebGL2Context(gl) {\n  return isWebGL2(gl) ? gl : null;\n}\n\nexport function assertWebGLContext(gl) {\n  assert(isWebGL(gl), ERR_CONTEXT);\n  return gl;\n}\n\nexport function assertWebGL2Context(gl) {\n  assert(isWebGL2(gl), ERR_WEBGL2);\n  return gl;\n}\n","import {VERTEX_SHADER, FRAGMENT_SHADER} from './constants';\nimport {resolveModules} from './resolve-modules';\nimport {getPlatformShaderDefines, getVersionDefines} from './platform-defines';\nimport injectShader, {DECLARATION_INJECT_MARKER} from './inject-shader';\nimport transpileShader from './transpile-shader';\nimport {assert} from '../utils';\n\nconst INJECT_SHADER_DECLARATIONS = `\\n\\n${DECLARATION_INJECT_MARKER}\\n\\n`;\n\nconst SHADER_TYPE = {\n  [VERTEX_SHADER]: 'vertex',\n  [FRAGMENT_SHADER]: 'fragment'\n};\n\n// Precision prologue to inject before functions are injected in shader\n// TODO - extract any existing prologue in the fragment source and move it up...\nconst FRAGMENT_SHADER_PROLOGUE = `\\\nprecision highp float;\n\n`;\n\n// Inject a list of modules\nexport function assembleShaders(gl, opts) {\n  const {vs, fs} = opts;\n  const modules = resolveModules(opts.modules || []);\n  return {\n    gl,\n    vs: assembleShader(gl, Object.assign({}, opts, {source: vs, type: VERTEX_SHADER, modules})),\n    fs: assembleShader(gl, Object.assign({}, opts, {source: fs, type: FRAGMENT_SHADER, modules})),\n    getUniforms: assembleGetUniforms(modules)\n  };\n}\n\n// Pulls together complete source code for either a vertex or a fragment shader\n// adding prologues, requested module chunks, and any final injections.\nfunction assembleShader(\n  gl,\n  {\n    id,\n    source,\n    type,\n    modules,\n    defines = {},\n    hookFunctions = [],\n    inject = {},\n    transpileToGLSL100 = false,\n    prologue = true,\n    log\n  }\n) {\n  assert(typeof source === 'string', 'shader source must be a string');\n\n  const isVertex = type === VERTEX_SHADER;\n\n  const sourceLines = source.split('\\n');\n  let glslVersion = 100;\n  let versionLine = '';\n  let coreSource = source;\n  // Extract any version directive string from source.\n  // TODO : keep all pre-processor statements at the begining of the shader.\n  if (sourceLines[0].indexOf('#version ') === 0) {\n    glslVersion = 300; // TODO - regexp that matches actual version number\n    versionLine = sourceLines[0];\n    coreSource = sourceLines.slice(1).join('\\n');\n  } else {\n    versionLine = `#version ${glslVersion}`;\n  }\n\n  // Combine Module and Application Defines\n  const allDefines = {};\n  modules.forEach(module => {\n    Object.assign(allDefines, module.getDefines());\n  });\n  Object.assign(allDefines, defines);\n\n  // Add platform defines (use these to work around platform-specific bugs and limitations)\n  // Add common defines (GLSL version compatibility, feature detection)\n  // Add precision declaration for fragment shaders\n  let assembledSource = prologue\n    ? `\\\n${versionLine}\n${getShaderName({id, source, type})}\n${getShaderType({type})}\n${getPlatformShaderDefines(gl)}\n${getVersionDefines(gl, glslVersion, !isVertex)}\n${getApplicationDefines(allDefines)}\n${isVertex ? '' : FRAGMENT_SHADER_PROLOGUE}\n`\n    : `${versionLine}\n`;\n\n  const hookFunctionMap = normalizeHookFunctions(hookFunctions);\n\n  // Add source of dependent modules in resolved order\n  const hookInjections = {};\n  const declInjections = {};\n  const mainInjections = {};\n\n  for (const key in inject) {\n    const injection =\n      typeof inject[key] === 'string' ? {injection: inject[key], order: 0} : inject[key];\n    const match = key.match(/^(v|f)s:(#)?([\\w-]+)$/);\n    if (match) {\n      const hash = match[2];\n      const name = match[3];\n      if (hash) {\n        if (name === 'decl') {\n          declInjections[key] = [injection];\n        } else {\n          mainInjections[key] = [injection];\n        }\n      } else {\n        hookInjections[key] = [injection];\n      }\n    } else {\n      // Regex injection\n      mainInjections[key] = [injection];\n    }\n  }\n\n  for (const module of modules) {\n    if (log) {\n      module.checkDeprecations(coreSource, log);\n    }\n    const moduleSource = module.getModuleSource(type, glslVersion);\n    // Add the module source, and a #define that declares it presence\n    assembledSource += moduleSource;\n\n    const injections = module.injections[type];\n    for (const key in injections) {\n      const match = key.match(/^(v|f)s:#([\\w-]+)$/);\n      if (match) {\n        const name = match[2];\n        const injectionType = name === 'decl' ? declInjections : mainInjections;\n        injectionType[key] = injectionType[key] || [];\n        injectionType[key].push(injections[key]);\n      } else {\n        hookInjections[key] = hookInjections[key] || [];\n        hookInjections[key].push(injections[key]);\n      }\n    }\n  }\n\n  // For injectShader\n  assembledSource += INJECT_SHADER_DECLARATIONS;\n\n  assembledSource = injectShader(assembledSource, type, declInjections);\n\n  assembledSource += getHookFunctions(hookFunctionMap[type], hookInjections);\n\n  // Add the version directive and actual source of this shader\n  assembledSource += coreSource;\n\n  // Apply any requested shader injections\n  assembledSource = injectShader(assembledSource, type, mainInjections);\n\n  assembledSource = transpileShader(\n    assembledSource,\n    transpileToGLSL100 ? 100 : glslVersion,\n    isVertex\n  );\n\n  return assembledSource;\n}\n\n// Returns a combined `getUniforms` covering the options for all the modules,\n// the created function will pass on options to the inidividual `getUniforms`\n// function of each shader module and combine the results into one object that\n// can be passed to setUniforms.\nfunction assembleGetUniforms(modules) {\n  return function getUniforms(opts) {\n    const uniforms = {};\n    for (const module of modules) {\n      // `modules` is already sorted by dependency level. This guarantees that\n      // modules have access to the uniforms that are generated by their dependencies.\n      const moduleUniforms = module.getUniforms(opts, uniforms);\n      Object.assign(uniforms, moduleUniforms);\n    }\n    return uniforms;\n  };\n}\n\nfunction getShaderType({type}) {\n  return `\n#define SHADER_TYPE_${SHADER_TYPE[type].toUpperCase()}\n`;\n}\n\n// Generate \"glslify-compatible\" SHADER_NAME defines\n// These are understood by the GLSL error parsing function\n// If id is provided and no SHADER_NAME constant is present in source, create one\nfunction getShaderName({id, source, type}) {\n  const injectShaderName = id && typeof id === 'string' && source.indexOf('SHADER_NAME') === -1;\n  return injectShaderName\n    ? `\n#define SHADER_NAME ${id}_${SHADER_TYPE[type]}\n\n`\n    : '';\n}\n\n// Generates application defines from an object\nfunction getApplicationDefines(defines = {}) {\n  let count = 0;\n  let sourceText = '';\n  for (const define in defines) {\n    if (count === 0) {\n      sourceText += '\\n// APPLICATION DEFINES\\n';\n    }\n    count++;\n\n    const value = defines[define];\n    if (value || Number.isFinite(value)) {\n      sourceText += `#define ${define.toUpperCase()} ${defines[define]}\\n`;\n    }\n  }\n  if (count === 0) {\n    sourceText += '\\n';\n  }\n  return sourceText;\n}\n\nfunction getHookFunctions(hookFunctions, hookInjections) {\n  let result = '';\n  for (const hookName in hookFunctions) {\n    const hookFunction = hookFunctions[hookName];\n    result += `void ${hookFunction.signature} {\\n`;\n    if (hookFunction.header) {\n      result += `  ${hookFunction.header}`;\n    }\n    if (hookInjections[hookName]) {\n      const injections = hookInjections[hookName];\n      injections.sort((a, b) => a.order - b.order);\n      for (const injection of injections) {\n        result += `  ${injection.injection}\\n`;\n      }\n    }\n    if (hookFunction.footer) {\n      result += `  ${hookFunction.footer}`;\n    }\n    result += '}\\n';\n  }\n\n  return result;\n}\n\nfunction normalizeHookFunctions(hookFunctions) {\n  const result = {\n    vs: {},\n    fs: {}\n  };\n\n  hookFunctions.forEach(hook => {\n    let opts;\n    if (typeof hook !== 'string') {\n      opts = hook;\n      hook = opts.hook;\n    } else {\n      opts = {};\n    }\n    hook = hook.trim();\n    const [stage, signature] = hook.split(':');\n    const name = hook.replace(/\\(.+/, '');\n    result[stage][name] = Object.assign(opts, {signature});\n  });\n\n  return result;\n}\n","export const VERTEX_SHADER = 'vs';\nexport const FRAGMENT_SHADER = 'fs';\n","const TYPE_DEFINITIONS = {\n  number: {\n    validate(value, propType) {\n      return (\n        Number.isFinite(value) &&\n        (!('max' in propType) || value <= propType.max) &&\n        (!('min' in propType) || value >= propType.min)\n      );\n    }\n  },\n  array: {\n    validate(value, propType) {\n      return Array.isArray(value) || ArrayBuffer.isView(value);\n    }\n  }\n};\n\nexport function parsePropTypes(propDefs) {\n  const propTypes = {};\n  for (const propName in propDefs) {\n    const propDef = propDefs[propName];\n    const propType = parsePropType(propDef);\n    propTypes[propName] = propType;\n  }\n  return propTypes;\n}\n\n// Parses one property definition entry. Either contains:\n// * a valid prop type object ({type, ...})\n// * or just a default value, in which case type and name inference is used\nfunction parsePropType(propDef) {\n  let type = getTypeOf(propDef);\n  if (type === 'object') {\n    if (!propDef) {\n      return {type: 'object', value: null};\n    }\n    if ('type' in propDef) {\n      return Object.assign({}, propDef, TYPE_DEFINITIONS[propDef.type]);\n    }\n    if (!('value' in propDef)) {\n      // If no type and value this object is likely the value\n      return {type: 'object', value: propDef};\n    }\n    type = getTypeOf(propDef.value);\n    return Object.assign({type}, propDef, TYPE_DEFINITIONS[type]);\n  }\n  return Object.assign({type, value: propDef}, TYPE_DEFINITIONS[type]);\n}\n\n// improved version of javascript typeof that can distinguish arrays and null values\nfunction getTypeOf(value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    return 'array';\n  }\n  return typeof value;\n}\n","import {MODULE_INJECTORS_VS, MODULE_INJECTORS_FS} from '../modules/module-injectors';\nimport {VERTEX_SHADER, FRAGMENT_SHADER} from './constants';\nimport {assert} from '../utils';\n\n// TODO - experimental\nconst MODULE_INJECTORS = {\n  [VERTEX_SHADER]: MODULE_INJECTORS_VS,\n  [FRAGMENT_SHADER]: MODULE_INJECTORS_FS\n};\n\nexport const DECLARATION_INJECT_MARKER = '__LUMA_INJECT_DECLARATIONS__'; // Uniform/attribute declarations\n\nconst REGEX_START_OF_MAIN = /void\\s+main\\s*\\([^)]*\\)\\s*\\{\\n?/; // Beginning of main\nconst REGEX_END_OF_MAIN = /}\\n?[^{}]*$/; // End of main, assumes main is last function\nconst fragments = [];\n\n// A minimal shader injection/templating system.\n// RFC: https://github.com/visgl/luma.gl/blob/7.0-release/dev-docs/RFCs/v6.0/shader-injection-rfc.md\n/* eslint-disable complexity */\nexport default function injectShader(source, type, inject, injectStandardStubs = false) {\n  const isVertex = type === VERTEX_SHADER;\n\n  for (const key in inject) {\n    const fragmentData = inject[key];\n    fragmentData.sort((a, b) => a.order - b.order);\n    fragments.length = fragmentData.length;\n    for (let i = 0, len = fragmentData.length; i < len; ++i) {\n      fragments[i] = fragmentData[i].injection;\n    }\n    const fragmentString = `${fragments.join('\\n')}\\n`;\n    switch (key) {\n      // declarations are injected before the main function\n      case 'vs:#decl':\n        if (isVertex) {\n          source = source.replace(DECLARATION_INJECT_MARKER, fragmentString);\n        }\n        break;\n      // inject code at the beginning of the main function\n      case 'vs:#main-start':\n        if (isVertex) {\n          source = source.replace(REGEX_START_OF_MAIN, match => match + fragmentString);\n        }\n        break;\n      // inject code at the end of main function\n      case 'vs:#main-end':\n        if (isVertex) {\n          source = source.replace(REGEX_END_OF_MAIN, match => fragmentString + match);\n        }\n        break;\n      // declarations are injected before the main function\n      case 'fs:#decl':\n        if (!isVertex) {\n          source = source.replace(DECLARATION_INJECT_MARKER, fragmentString);\n        }\n        break;\n      // inject code at the beginning of the main function\n      case 'fs:#main-start':\n        if (!isVertex) {\n          source = source.replace(REGEX_START_OF_MAIN, match => match + fragmentString);\n        }\n        break;\n      // inject code at the end of main function\n      case 'fs:#main-end':\n        if (!isVertex) {\n          source = source.replace(REGEX_END_OF_MAIN, match => fragmentString + match);\n        }\n        break;\n\n      default:\n        // TODO(Tarek): I think this usage should be deprecated.\n\n        // inject code after key, leaving key in place\n        source = source.replace(key, match => match + fragmentString);\n    }\n  }\n\n  // Remove if it hasn't already been replaced\n  source = source.replace(DECLARATION_INJECT_MARKER, '');\n\n  // Finally, if requested, insert an automatic module injector chunk\n  if (injectStandardStubs) {\n    source = source.replace(/\\}\\s*$/, match => match + MODULE_INJECTORS[type]);\n  }\n\n  return source;\n}\n\n/* eslint-enable complexity */\n\n// Takes an array of inject objects and combines them into one\nexport function combineInjects(injects) {\n  const result = {};\n  assert(Array.isArray(injects) && injects.length > 1);\n  injects.forEach(inject => {\n    for (const key in inject) {\n      result[key] = result[key] ? `${result[key]}\\n${inject[key]}` : inject[key];\n    }\n  });\n  return result;\n}\n","import {getContextInfo, hasFeatures, canCompileGLGSExtension, FEATURES} from '../utils/webgl-info';\n\nexport function getPlatformShaderDefines(gl) {\n  const debugInfo = getContextInfo(gl);\n\n  switch (debugInfo.gpuVendor.toLowerCase()) {\n    case 'nvidia':\n      return `\\\n#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n`;\n\n    case 'intel':\n      return `\\\n#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n`;\n\n    case 'amd':\n      // AMD Does not eliminate fp64 code\n      return `\\\n#define AMD_GPU\n`;\n\n    default:\n      // We don't know what GPU it is, could be that the GPU driver or\n      // browser is not implementing UNMASKED_RENDERER constant and not\n      // reporting a correct name\n      return `\\\n#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n`;\n  }\n}\n\nexport function getVersionDefines(gl, glslVersion, isFragment) {\n  // Add shadertools defines to let shaders portably v1/v3 check for features\n  let versionDefines = `\\\n#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n`;\n\n  if (hasFeatures(gl, FEATURES.GLSL_FRAG_DEPTH)) {\n    versionDefines += `\\\n\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n`;\n  }\n  if (\n    hasFeatures(gl, FEATURES.GLSL_DERIVATIVES) &&\n    canCompileGLGSExtension(gl, FEATURES.GLSL_DERIVATIVES)\n  ) {\n    versionDefines += `\\\n\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n`;\n  }\n  if (\n    hasFeatures(gl, FEATURES.GLSL_FRAG_DATA) &&\n    canCompileGLGSExtension(gl, FEATURES.GLSL_FRAG_DATA, {behavior: 'require'})\n  ) {\n    versionDefines += `\\\n\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n`;\n  }\n  if (hasFeatures(gl, FEATURES.GLSL_TEXTURE_LOD)) {\n    versionDefines += `\\\n// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n`;\n  }\n  return versionDefines;\n}\n","import ShaderModule from './shader-module';\nimport {assert} from '../utils';\n\n// Instantiate shader modules and any dependencies resolve dependencies\nexport function resolveModules(modules) {\n  return getShaderDependencies(instantiateModules(modules));\n}\n\n/**\n * Takes a list of shader module names and returns a new list of\n * shader module names that includes all dependencies, sorted so\n * that modules that are dependencies of other modules come first.\n *\n * If the shader glsl code from the returned modules is concatenated\n * in the reverse order, it is guaranteed that all functions be resolved and\n * that all function and variable definitions come before use.\n *\n * @param {String[]} modules - Array of modules (inline modules or module names)\n * @return {String[]} - Array of modules\n */\nfunction getShaderDependencies(modules) {\n  const moduleMap = {};\n  const moduleDepth = {};\n  getDependencyGraph({modules, level: 0, moduleMap, moduleDepth});\n\n  // Return a reverse sort so that dependencies come before the modules that use them\n  return Object.keys(moduleDepth)\n    .sort((a, b) => moduleDepth[b] - moduleDepth[a])\n    .map(name => moduleMap[name]);\n}\n\n/**\n * Recursively checks module dpendencies to calculate dependency\n * level of each module.\n *\n * @param {object} options\n * @param {object[]} options.modules - Array of modules\n * @param {number} options.level - Current level\n * @param {object} options.moduleMap -\n * @param {object} options.moduleDepth - Current level\n * @return {object} - Map of module name to its level\n */\n// Adds another level of dependencies to the result map\nfunction getDependencyGraph({modules, level, moduleMap, moduleDepth}) {\n  if (level >= 5) {\n    throw new Error('Possible loop in shader dependency graph');\n  }\n\n  // Update level on all current modules\n  for (const module of modules) {\n    moduleMap[module.name] = module;\n    if (moduleDepth[module.name] === undefined || moduleDepth[module.name] < level) {\n      moduleDepth[module.name] = level;\n    }\n  }\n\n  // Recurse\n  for (const module of modules) {\n    if (module.dependencies) {\n      getDependencyGraph({modules: module.dependencies, level: level + 1, moduleMap, moduleDepth});\n    }\n  }\n}\n\nfunction instantiateModules(modules, seen) {\n  return modules.map(module => {\n    if (module instanceof ShaderModule) {\n      return module;\n    }\n\n    assert(\n      typeof module !== 'string',\n      `Shader module use by name is deprecated. Import shader module '${module}' and use it directly.`\n    );\n    assert(module.name, 'shader module has no name');\n\n    module = new ShaderModule(module);\n    module.dependencies = instantiateModules(module.dependencies);\n\n    return module;\n  });\n}\n\nexport const TEST_EXPORTS = {\n  getShaderDependencies,\n  getDependencyGraph\n};\n","import {assert} from '../utils';\nimport {parsePropTypes} from './filters/prop-types';\n\nconst VERTEX_SHADER = 'vs';\nconst FRAGMENT_SHADER = 'fs';\n\nexport default class ShaderModule {\n  constructor({\n    name,\n    vs,\n    fs,\n    dependencies = [],\n    uniforms,\n    getUniforms,\n    deprecations = [],\n    defines = {},\n    inject = {},\n    // DEPRECATED\n    vertexShader,\n    fragmentShader\n  }) {\n    assert(typeof name === 'string');\n    this.name = name;\n    this.vs = vs || vertexShader;\n    this.fs = fs || fragmentShader;\n    this.getModuleUniforms = getUniforms;\n    this.dependencies = dependencies;\n    this.deprecations = this._parseDeprecationDefinitions(deprecations);\n    this.defines = defines;\n    this.injections = normalizeInjections(inject);\n\n    if (uniforms) {\n      this.uniforms = parsePropTypes(uniforms);\n    }\n  }\n\n  // Extracts the source code chunk for the specified shader type from the named shader module\n  getModuleSource(type) {\n    let moduleSource;\n    switch (type) {\n      case VERTEX_SHADER:\n        moduleSource = this.vs || '';\n        break;\n      case FRAGMENT_SHADER:\n        moduleSource = this.fs || '';\n        break;\n      default:\n        assert(false);\n    }\n\n    return `\\\n#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi, '_')}\n${moduleSource}\\\n// END MODULE_${this.name}\n\n`;\n  }\n\n  getUniforms(opts, uniforms) {\n    if (this.getModuleUniforms) {\n      return this.getModuleUniforms(opts, uniforms);\n    }\n    // Build uniforms from the uniforms array\n    if (this.uniforms) {\n      return this._defaultGetUniforms(opts);\n    }\n    return {};\n  }\n\n  getDefines() {\n    return this.defines;\n  }\n\n  // Warn about deprecated uniforms or functions\n  checkDeprecations(shaderSource, log) {\n    this.deprecations.forEach(def => {\n      if (def.regex.test(shaderSource)) {\n        if (def.deprecated) {\n          log.deprecated(def.old, def.new)();\n        } else {\n          log.removed(def.old, def.new)();\n        }\n      }\n    });\n  }\n\n  _parseDeprecationDefinitions(deprecations) {\n    deprecations.forEach(def => {\n      switch (def.type) {\n        case 'function':\n          def.regex = new RegExp(`\\\\b${def.old}\\\\(`);\n          break;\n        default:\n          def.regex = new RegExp(`${def.type} ${def.old};`);\n      }\n    });\n\n    return deprecations;\n  }\n\n  _defaultGetUniforms(opts = {}) {\n    const uniforms = {};\n    const propTypes = this.uniforms;\n\n    for (const key in propTypes) {\n      const propDef = propTypes[key];\n      if (key in opts && !propDef.private) {\n        if (propDef.validate) {\n          assert(propDef.validate(opts[key], propDef), `${this.name}: invalid ${key}`);\n        }\n        uniforms[key] = opts[key];\n      } else {\n        uniforms[key] = propDef.value;\n      }\n    }\n\n    return uniforms;\n  }\n}\n\n// This utility mutates the original module\n// Keeping for backward compatibility\n// TODO - remove in v8\nexport function normalizeShaderModule(module) {\n  if (!module.normalized) {\n    module.normalized = true;\n    if (module.uniforms && !module.getUniforms) {\n      const shaderModule = new ShaderModule(module);\n      module.getUniforms = shaderModule.getUniforms.bind(shaderModule);\n    }\n  }\n  return module;\n}\n\nfunction normalizeInjections(injections) {\n  const result = {\n    vs: {},\n    fs: {}\n  };\n\n  for (const hook in injections) {\n    let injection = injections[hook];\n    const stage = hook.slice(0, 2);\n\n    if (typeof injection === 'string') {\n      injection = {\n        order: 0,\n        injection\n      };\n    }\n\n    result[stage][hook] = injection;\n  }\n\n  return result;\n}\n","// TRANSPILATION TABLES\n\nfunction testVariable(qualifier) {\n  /*\n    should match:\n      in float weight;\n      out vec4 positions[2];\n    should not match:\n      void f(out float a, in float b) {}\n   */\n  return new RegExp(`\\\\b${qualifier}[ \\\\t]+(\\\\w+[ \\\\t]+\\\\w+(\\\\[\\\\w+\\\\])?;)`, 'g');\n}\n\n/** Simple regex replacements for GLSL ES 1.00 syntax that has changed in GLSL ES 3.00 */\nconst ES300_REPLACEMENTS = [\n  // Fix poorly formatted version directive\n  [/^(#version[ \\t]+(100|300[ \\t]+es))?[ \\t]*\\n/, '#version 300 es\\n'],\n  // The individual `texture...()` functions were replaced with `texture()` overloads\n  [/\\btexture(2D|2DProj|Cube)Lod(EXT)?\\(/g, 'textureLod('],\n  [/\\btexture(2D|2DProj|Cube)(EXT)?\\(/g, 'texture(']\n];\n\nconst ES300_VERTEX_REPLACEMENTS = [\n  ...ES300_REPLACEMENTS,\n  // `attribute` keyword replaced with `in`\n  [testVariable('attribute'), 'in $1'],\n  // `varying` keyword replaced with `out`\n  [testVariable('varying'), 'out $1']\n];\n\n/** Simple regex replacements for GLSL ES 1.00 syntax that has changed in GLSL ES 3.00 */\nconst ES300_FRAGMENT_REPLACEMENTS = [\n  ...ES300_REPLACEMENTS,\n  // `varying` keyword replaced with `in`\n  [testVariable('varying'), 'in $1']\n];\n\nconst ES100_REPLACEMENTS = [\n  [/^#version[ \\t]+300[ \\t]+es/, '#version 100'],\n\n  // In GLSL 1.00 ES these functions are provided by an extension\n  [/\\btexture(2D|2DProj|Cube)Lod\\(/g, 'texture$1LodEXT('],\n\n  // Overloads in GLSL 3.00 map to individual functions. Note that we cannot\n  // differentiate 2D,2DProj,Cube without type analysis so we choose the most common variant.\n  [/\\btexture\\(/g, 'texture2D('],\n  [/\\btextureLod\\(/g, 'texture2DLodEXT(']\n];\n\nconst ES100_VERTEX_REPLACEMENTS = [\n  ...ES100_REPLACEMENTS,\n  [testVariable('in'), 'attribute $1'],\n  [testVariable('out'), 'varying $1']\n];\n\nconst ES100_FRAGMENT_REPLACEMENTS = [\n  ...ES100_REPLACEMENTS,\n  // Replace `in` with `varying`\n  [testVariable('in'), 'varying $1']\n];\n\nconst ES100_FRAGMENT_OUTPUT_NAME = 'gl_FragColor';\nconst ES300_FRAGMENT_OUTPUT_REGEX = /\\bout[ \\t]+vec4[ \\t]+(\\w+)[ \\t]*;\\n?/;\n\nconst REGEX_START_OF_MAIN = /void\\s+main\\s*\\([^)]*\\)\\s*\\{\\n?/; // Beginning of main\n\n// Transpiles shader source code to target GLSL version\n// Note: We always run transpiler even if same version e.g. 3.00 => 3.00\n// RFC: https://github.com/visgl/luma.gl/blob/7.0-release/dev-docs/RFCs/v6.0/portable-glsl-300-rfc.md\nexport default function transpileShader(source, targetGLSLVersion, isVertex) {\n  switch (targetGLSLVersion) {\n    case 300:\n      return isVertex\n        ? convertShader(source, ES300_VERTEX_REPLACEMENTS)\n        : convertFragmentShaderTo300(source);\n    case 100:\n      return isVertex\n        ? convertShader(source, ES100_VERTEX_REPLACEMENTS)\n        : convertFragmentShaderTo100(source);\n    default:\n      throw new Error(`unknown GLSL version ${targetGLSLVersion}`);\n  }\n}\n\nfunction convertShader(source, replacements) {\n  for (const [pattern, replacement] of replacements) {\n    source = source.replace(pattern, replacement);\n  }\n  return source;\n}\n\nfunction convertFragmentShaderTo300(source) {\n  source = convertShader(source, ES300_FRAGMENT_REPLACEMENTS);\n\n  const outputMatch = source.match(ES300_FRAGMENT_OUTPUT_REGEX);\n  if (outputMatch) {\n    const outputName = outputMatch[1];\n    source = source.replace(new RegExp(`\\\\b${ES100_FRAGMENT_OUTPUT_NAME}\\\\b`, 'g'), outputName);\n  } else {\n    const outputName = 'fragmentColor';\n    source = source\n      .replace(REGEX_START_OF_MAIN, match => `out vec4 ${outputName};\\n${match}`)\n      .replace(new RegExp(`\\\\b${ES100_FRAGMENT_OUTPUT_NAME}\\\\b`, 'g'), outputName);\n  }\n\n  return source;\n}\n\nfunction convertFragmentShaderTo100(source) {\n  source = convertShader(source, ES100_FRAGMENT_REPLACEMENTS);\n\n  const outputMatch = source.match(ES300_FRAGMENT_OUTPUT_REGEX);\n  if (outputMatch) {\n    const outputName = outputMatch[1];\n    source = source\n      .replace(ES300_FRAGMENT_OUTPUT_REGEX, '')\n      .replace(new RegExp(`\\\\b${outputName}\\\\b`, 'g'), ES100_FRAGMENT_OUTPUT_NAME);\n  }\n\n  return source;\n}\n","export const MODULE_INJECTORS_VS = `\\\n#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n`;\n\nexport const MODULE_INJECTORS_FS = `\\\n#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n`;\n","// Recommendation is to ignore message but current test suite checks agains the\n// message so keep it for now.\nexport default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'shadertools: assertion failed.');\n  }\n}\n","// opts allows user agent to be overridden for testing\nexport default function isOldIE(opts = {}) {\n  const navigator = typeof window !== 'undefined' ? window.navigator || {} : {};\n  // @ts-ignore\n  const userAgent = opts.userAgent || navigator.userAgent || '';\n  // We only care about older versions of IE (IE 11 and below). Newer versions of IE (Edge)\n  // have much better web standards support.\n  const isMSIE = userAgent.indexOf('MSIE ') !== -1;\n  const isTrident = userAgent.indexOf('Trident/') !== -1;\n  return isMSIE || isTrident;\n}\n","// Feature detection for WebGL\n//\n// Provides a function that enables simple checking of which WebGL features are\n// available in an WebGL1 or WebGL2 environment.\n\n/* eslint-disable no-inline-comments, max-len */\nimport isOldIE from './is-old-ie';\nimport assert from './assert';\n\nconst GL_VENDOR = 0x1f00;\nconst GL_RENDERER = 0x1f01;\nconst GL_VERSION = 0x1f02;\nconst GL_SHADING_LANGUAGE_VERSION = 0x8b8c;\n\n// Defines luma.gl \"feature\" names and semantics\nconst WEBGL_FEATURES = {\n  // GLSL extensions\n  GLSL_FRAG_DATA: ['WEBGL_draw_buffers', true], // TODO - name makes no sense in GLSL 3.00\n  GLSL_FRAG_DEPTH: ['EXT_frag_depth', true],\n  GLSL_DERIVATIVES: ['OES_standard_derivatives', true],\n  GLSL_TEXTURE_LOD: ['EXT_shader_texture_lod', true]\n};\n\n// Create a key-mirrored FEATURES array\nconst FEATURES = {};\nObject.keys(WEBGL_FEATURES).forEach(key => {\n  FEATURES[key] = key;\n});\n\nexport {FEATURES};\n\nfunction isWebGL2(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n  return Boolean(gl && gl._version === 2);\n}\n\nexport function getContextInfo(gl) {\n  const info = gl.getExtension('WEBGL_debug_renderer_info');\n  const vendor = gl.getParameter((info && info.UNMASKED_VENDOR_WEBGL) || GL_VENDOR);\n  const renderer = gl.getParameter((info && info.UNMASKED_RENDERER_WEBGL) || GL_RENDERER);\n  const gpuVendor = identifyGPUVendor(vendor, renderer);\n  const gpuInfo = {\n    gpuVendor,\n    vendor,\n    renderer,\n    version: gl.getParameter(GL_VERSION),\n    shadingLanguageVersion: gl.getParameter(GL_SHADING_LANGUAGE_VERSION)\n  };\n  return gpuInfo;\n}\n\nfunction identifyGPUVendor(vendor, renderer) {\n  if (vendor.match(/NVIDIA/i) || renderer.match(/NVIDIA/i)) {\n    return 'NVIDIA';\n  }\n  if (vendor.match(/INTEL/i) || renderer.match(/INTEL/i)) {\n    return 'INTEL';\n  }\n  if (\n    vendor.match(/AMD/i) ||\n    renderer.match(/AMD/i) ||\n    vendor.match(/ATI/i) ||\n    renderer.match(/ATI/i)\n  ) {\n    return 'AMD';\n  }\n  return 'UNKNOWN GPU';\n}\n\nconst compiledGlslExtensions = {};\n\n// Enables feature detection in IE11 due to a bug where gl.getExtension may return true\n// but fail to compile when the extension is enabled in the shader. Specifically,\n// the OES_standard_derivatives and WEBGL_draw_buffers extensions fails to compile in IE11 even though its included\n// in the list of supported extensions.\n// opts allows user agent to be overridden for testing\n/*\n* Inputs :\n*  gl : WebGL context\n*  cap : Key of WEBGL_FEATURES object identifying the extension\n*  opts :\n*   behavior : behavior of extension to be tested, by defualt `enable` is used\n* Returns : true, if shader is compiled successfully, false otherwise\n*/\nexport function canCompileGLGSExtension(gl, cap, opts = {}) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n\n  if (!isOldIE(opts)) {\n    return true;\n  }\n\n  if (cap in compiledGlslExtensions) {\n    return compiledGlslExtensions[cap];\n  }\n\n  const extensionName = feature[0];\n  const behavior = opts.behavior || 'enable';\n  const source = `#extension GL_${extensionName} : ${behavior}\\nvoid main(void) {}`;\n\n  const shader = gl.createShader(gl.VERTEX_SHADER);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  const canCompile = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n  gl.deleteShader(shader);\n  compiledGlslExtensions[cap] = canCompile;\n  return canCompile;\n}\n\n// TODO - cache the value\nfunction getFeature(gl, cap) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n\n  // Get extension name from table\n  const extensionName = isWebGL2(gl) ? feature[1] || feature[0] : feature[0];\n\n  // Check if the value is dependent on checking an extension\n  const value =\n    typeof extensionName === 'string' ? Boolean(gl.getExtension(extensionName)) : extensionName;\n\n  assert(value === false || value === true);\n\n  return value;\n}\n\nexport function hasFeatures(gl, features) {\n  features = Array.isArray(features) ? features : [features];\n  return features.every(feature => getFeature(gl, feature));\n}\n","import GL from '@luma.gl/constants';\nimport {getTypedArrayFromGLType} from '../webgl-utils/typed-array-utils';\nimport {assert} from '../utils/assert';\nimport {checkProps} from '../utils/check-props';\n\nconst DEFAULT_ACCESSOR_VALUES = {\n  offset: 0,\n  stride: 0,\n  type: GL.FLOAT,\n  size: 1,\n  divisor: 0,\n  normalized: false,\n  integer: false\n};\n\nconst PROP_CHECKS = {\n  deprecatedProps: {\n    instanced: 'divisor',\n    isInstanced: 'divisor'\n  }\n};\n\nexport default class Accessor {\n  static getBytesPerElement(accessor) {\n    // TODO: using `FLOAT` when type is not specified,\n    // ensure this assumption is valid or force API to specify type.\n    const ArrayType = getTypedArrayFromGLType(accessor.type || GL.FLOAT);\n    return ArrayType.BYTES_PER_ELEMENT;\n  }\n\n  static getBytesPerVertex(accessor) {\n    assert(accessor.size);\n    // TODO: using `FLOAT` when type is not specified,\n    // ensure this assumption is valid or force API to specify type.\n    const ArrayType = getTypedArrayFromGLType(accessor.type || GL.FLOAT);\n    return ArrayType.BYTES_PER_ELEMENT * accessor.size;\n  }\n\n  // Combines (merges) a list of accessors. On top of default values\n  // Usually [programAccessor, bufferAccessor, appAccessor]\n  // All props will be set in the returned object.\n  // TODO check for conflicts between values in the supplied accessors\n  static resolve(...accessors) {\n    return new Accessor(...[DEFAULT_ACCESSOR_VALUES, ...accessors]); // Default values\n  }\n\n  constructor(...accessors) {\n    accessors.forEach(accessor => this._assign(accessor)); // Merge in sequence\n    Object.freeze(this);\n  }\n\n  toString() {\n    return JSON.stringify(this);\n  }\n\n  // ACCESSORS\n\n  // TODO - remove>\n  get BYTES_PER_ELEMENT() {\n    return Accessor.getBytesPerElement(this);\n  }\n\n  get BYTES_PER_VERTEX() {\n    return Accessor.getBytesPerVertex(this);\n  }\n\n  // PRIVATE\n\n  // eslint-disable-next-line complexity, max-statements\n  _assign(props = {}) {\n    props = checkProps('Accessor', props, PROP_CHECKS);\n\n    if (props.type !== undefined) {\n      this.type = props.type;\n\n      // Auto-deduce integer type?\n      if (props.type === GL.INT || props.type === GL.UNSIGNED_INT) {\n        this.integer = true;\n      }\n    }\n    if (props.size !== undefined) {\n      this.size = props.size;\n    }\n    if (props.offset !== undefined) {\n      this.offset = props.offset;\n    }\n    if (props.stride !== undefined) {\n      this.stride = props.stride;\n    }\n    if (props.normalized !== undefined) {\n      this.normalized = props.normalized;\n    }\n    if (props.integer !== undefined) {\n      this.integer = props.integer;\n    }\n\n    // INSTANCE DIVISOR\n    if (props.divisor !== undefined) {\n      this.divisor = props.divisor;\n    }\n\n    // Buffer is optional\n    if (props.buffer !== undefined) {\n      this.buffer = props.buffer;\n    }\n\n    // The binding index (for binding e.g. Transform feedbacks and Uniform buffers)\n    // TODO - should this be part of accessor?\n    if (props.index !== undefined) {\n      if (typeof props.index === 'boolean') {\n        this.index = props.index ? 1 : 0;\n      } else {\n        this.index = props.index;\n      }\n    }\n\n    // DEPRECATED\n    if (props.instanced !== undefined) {\n      this.divisor = props.instanced ? 1 : 0;\n    }\n    if (props.isInstanced !== undefined) {\n      this.divisor = props.isInstanced ? 1 : 0;\n    }\n\n    return this;\n  }\n}\n\n// TEST EXPORTS\nexport {DEFAULT_ACCESSOR_VALUES};\n","import GL from '@luma.gl/constants';\nimport Resource from './resource';\nimport Accessor from './accessor';\nimport {getGLTypeFromTypedArray, getTypedArrayFromGLType} from '../webgl-utils/typed-array-utils';\nimport {assertWebGL2Context, log} from '@luma.gl/gltools';\nimport {assert} from '../utils/assert';\nimport {checkProps} from '../utils/check-props';\n\nconst DEBUG_DATA_LENGTH = 10;\n\n// Shared prop checks for constructor and setProps\nconst DEPRECATED_PROPS = {\n  offset: 'accessor.offset',\n  stride: 'accessor.stride',\n  type: 'accessor.type',\n  size: 'accessor.size',\n  divisor: 'accessor.divisor',\n  normalized: 'accessor.normalized',\n  integer: 'accessor.integer',\n  instanced: 'accessor.divisor',\n  isInstanced: 'accessor.divisor'\n};\n\n// Prop checks for constructor\nconst PROP_CHECKS_INITIALIZE = {\n  removedProps: {},\n  replacedProps: {\n    bytes: 'byteLength'\n  },\n  // new Buffer() with individual accessor props is still used in apps, emit warnings\n  deprecatedProps: DEPRECATED_PROPS\n};\n\n// Prop checks for setProps\nconst PROP_CHECKS_SET_PROPS = {\n  // Buffer.setProps() with individual accessor props is rare => emit errors\n  removedProps: DEPRECATED_PROPS\n};\n\nexport default class Buffer extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Buffer';\n  }\n  constructor(gl, props = {}) {\n    super(gl, props);\n\n    this.stubRemovedMethods('Buffer', 'v6.0', ['layout', 'setLayout', 'getIndexedParameter']);\n    // this.stubRemovedMethods('Buffer', 'v7.0', ['updateAccessor']);\n\n    // In WebGL1, need to make sure we use GL.ELEMENT_ARRAY_BUFFER when initializing element buffers\n    // otherwise buffer type will lock to generic (non-element) buffer\n    // In WebGL2, we can use GL.COPY_READ_BUFFER which avoids locking the type here\n    this.target = props.target || (this.gl.webgl2 ? GL.COPY_READ_BUFFER : GL.ARRAY_BUFFER);\n\n    this.initialize(props);\n\n    Object.seal(this);\n  }\n\n  // returns number of elements in the buffer (assuming that the full buffer is used)\n  getElementCount(accessor = this.accessor) {\n    return Math.round(this.byteLength / Accessor.getBytesPerElement(accessor));\n  }\n\n  // returns number of vertices in the buffer (assuming that the full buffer is used)\n  getVertexCount(accessor = this.accessor) {\n    return Math.round(this.byteLength / Accessor.getBytesPerVertex(accessor));\n  }\n\n  // Creates and initializes the buffer object's data store.\n  // Signature: `new Buffer(gl, {data: new Float32Array(...)})`\n  // Signature: `new Buffer(gl, new Float32Array(...))`\n  // Signature: `new Buffer(gl, 100)`\n  initialize(props = {}) {\n    // Signature `new Buffer(gl, new Float32Array(...)`\n    if (ArrayBuffer.isView(props)) {\n      props = {data: props};\n    }\n\n    // Signature: `new Buffer(gl, 100)`\n    if (Number.isFinite(props)) {\n      props = {byteLength: props};\n    }\n\n    props = checkProps('Buffer', props, PROP_CHECKS_INITIALIZE);\n\n    // Initialize member fields\n    this.usage = props.usage || GL.STATIC_DRAW;\n    this.debugData = null;\n\n    // Deprecated: Merge main props and accessor\n    this.setAccessor(Object.assign({}, props, props.accessor));\n\n    // Set data: (re)initializes the buffer\n    if (props.data) {\n      this._setData(props.data, props.offset, props.byteLength);\n    } else {\n      this._setByteLength(props.byteLength || 0);\n    }\n\n    return this;\n  }\n\n  setProps(props) {\n    props = checkProps('Buffer', props, PROP_CHECKS_SET_PROPS);\n\n    if ('accessor' in props) {\n      this.setAccessor(props.accessor);\n    }\n\n    return this;\n  }\n\n  // Optionally stores an accessor with the buffer, makes it easier to use it as an attribute later\n  // {type, size = 1, offset = 0, stride = 0, normalized = false, integer = false, divisor = 0}\n  setAccessor(accessor) {\n    // NOTE: From luma.gl v7.0, Accessors have an optional `buffer `field\n    // (mainly to support \"interleaving\")\n    // To avoid confusion, ensure `buffer.accessor` does not have a `buffer.accessor.buffer` field:\n    accessor = Object.assign({}, accessor);\n    delete accessor.buffer;\n\n    // This new statement ensures that an \"accessor object\" is re-packaged as an Accessor instance\n    this.accessor = new Accessor(accessor);\n    return this;\n  }\n\n  // Allocate a bigger GPU buffer (if the current buffer is not big enough).\n  // If a reallocation is triggered it clears the buffer\n  // Returns:\n  //  `true`: buffer was reallocated, data was cleared\n  //  `false`: buffer was big enough, data is intact\n  reallocate(byteLength) {\n    if (byteLength > this.byteLength) {\n      this._setByteLength(byteLength);\n      return true;\n    }\n    this.bytesUsed = byteLength;\n    return false;\n  }\n\n  // Update with new data. Reinitializes the buffer\n  setData(props) {\n    return this.initialize(props);\n  }\n\n  // Updates a subset of a buffer object's data store.\n  // Data (Typed Array or ArrayBuffer), length is inferred unless provided\n  // Offset into buffer\n  // WebGL2 only: Offset into srcData\n  // WebGL2 only: Number of bytes to be copied\n  subData(props) {\n    // Signature: buffer.subData(new Float32Array([...]))\n    if (ArrayBuffer.isView(props)) {\n      props = {data: props};\n    }\n\n    const {data, offset = 0, srcOffset = 0} = props;\n    const byteLength = props.byteLength || props.length;\n\n    assert(data);\n\n    // Create the buffer - binding it here for the first time locks the type\n    // In WebGL2, use GL.COPY_WRITE_BUFFER to avoid locking the type\n    const target = this.gl.webgl2 ? GL.COPY_WRITE_BUFFER : this.target;\n    this.gl.bindBuffer(target, this.handle);\n    // WebGL2: subData supports additional srcOffset and length parameters\n    if (srcOffset !== 0 || byteLength !== undefined) {\n      assertWebGL2Context(this.gl);\n      this.gl.bufferSubData(this.target, offset, data, srcOffset, byteLength);\n    } else {\n      this.gl.bufferSubData(target, offset, data);\n    }\n    this.gl.bindBuffer(target, null);\n\n    // TODO - update local `data` if offsets are right\n    this.debugData = null;\n\n    this._inferType(data);\n\n    return this;\n  }\n\n  // WEBGL2 ONLY: Copies part of the data of another buffer into this buffer\n  copyData({sourceBuffer, readOffset = 0, writeOffset = 0, size}) {\n    const {gl} = this;\n    assertWebGL2Context(gl);\n\n    // Use GL.COPY_READ_BUFFER+GL.COPY_WRITE_BUFFER avoid disturbing other targets and locking type\n    gl.bindBuffer(GL.COPY_READ_BUFFER, sourceBuffer.handle);\n    gl.bindBuffer(GL.COPY_WRITE_BUFFER, this.handle);\n    gl.copyBufferSubData(GL.COPY_READ_BUFFER, GL.COPY_WRITE_BUFFER, readOffset, writeOffset, size);\n    gl.bindBuffer(GL.COPY_READ_BUFFER, null);\n    gl.bindBuffer(GL.COPY_WRITE_BUFFER, null);\n\n    // TODO - update local `data` if offsets are 0\n    this.debugData = null;\n\n    return this;\n  }\n\n  // WEBGL2 ONLY: Reads data from buffer into an ArrayBufferView or SharedArrayBuffer.\n  getData({dstData = null, srcByteOffset = 0, dstOffset = 0, length = 0} = {}) {\n    assertWebGL2Context(this.gl);\n\n    const ArrayType = getTypedArrayFromGLType(this.accessor.type || GL.FLOAT, {clamped: false});\n    const sourceAvailableElementCount = this._getAvailableElementCount(srcByteOffset);\n\n    const dstElementOffset = dstOffset;\n\n    let dstAvailableElementCount;\n    let dstElementCount;\n    if (dstData) {\n      dstElementCount = dstData.length;\n      dstAvailableElementCount = dstElementCount - dstElementOffset;\n    } else {\n      // Allocate ArrayBufferView with enough size to copy all eligible data.\n      dstAvailableElementCount = Math.min(\n        sourceAvailableElementCount,\n        length || sourceAvailableElementCount\n      );\n      dstElementCount = dstElementOffset + dstAvailableElementCount;\n    }\n\n    const copyElementCount = Math.min(sourceAvailableElementCount, dstAvailableElementCount);\n    length = length || copyElementCount;\n    assert(length <= copyElementCount);\n    dstData = dstData || new ArrayType(dstElementCount);\n\n    // Use GL.COPY_READ_BUFFER to avoid disturbing other targets and locking type\n    this.gl.bindBuffer(GL.COPY_READ_BUFFER, this.handle);\n    this.gl.getBufferSubData(GL.COPY_READ_BUFFER, srcByteOffset, dstData, dstOffset, length);\n    this.gl.bindBuffer(GL.COPY_READ_BUFFER, null);\n\n    // TODO - update local `data` if offsets are 0\n    return dstData;\n  }\n\n  /**\n   * Binds a buffer to a given binding point (target).\n   *   GL.TRANSFORM_FEEDBACK_BUFFER and GL.UNIFORM_BUFFER take an index, and optionally a range.\n   *   - GL.TRANSFORM_FEEDBACK_BUFFER and GL.UNIFORM_BUFFER need an index to affect state\n   *   - GL.UNIFORM_BUFFER: `offset` must be aligned to GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT.\n   *   - GL.UNIFORM_BUFFER: `size` must be a minimum of GL.UNIFORM_BLOCK_SIZE_DATA.\n   */\n  bind({\n    target = this.target, // target for the bind operation\n    index = this.accessor && this.accessor.index, // index = index of target (indexed bind point)\n    offset = 0,\n    size\n  } = {}) {\n    // NOTE: While GL.TRANSFORM_FEEDBACK_BUFFER and GL.UNIFORM_BUFFER could\n    // be used as direct binding points, they will not affect transform feedback or\n    // uniform buffer state. Instead indexed bindings need to be made.\n    if (target === GL.UNIFORM_BUFFER || target === GL.TRANSFORM_FEEDBACK_BUFFER) {\n      if (size !== undefined) {\n        this.gl.bindBufferRange(target, index, this.handle, offset, size);\n      } else {\n        assert(offset === 0); // Make sure offset wasn't supplied\n        this.gl.bindBufferBase(target, index, this.handle);\n      }\n    } else {\n      this.gl.bindBuffer(target, this.handle);\n    }\n\n    return this;\n  }\n\n  unbind({target = this.target, index = this.accessor && this.accessor.index} = {}) {\n    const isIndexedBuffer = target === GL.UNIFORM_BUFFER || target === GL.TRANSFORM_FEEDBACK_BUFFER;\n    if (isIndexedBuffer) {\n      this.gl.bindBufferBase(target, index, null);\n    } else {\n      this.gl.bindBuffer(target, null);\n    }\n    return this;\n  }\n\n  // PROTECTED METHODS (INTENDED FOR USE BY OTHER FRAMEWORK CODE ONLY)\n\n  // Returns a short initial data array\n  getDebugData() {\n    if (!this.debugData) {\n      this.debugData = this.getData({length: Math.min(DEBUG_DATA_LENGTH, this.byteLength)});\n      return {data: this.debugData, changed: true};\n    }\n    return {data: this.debugData, changed: false};\n  }\n\n  invalidateDebugData() {\n    this.debugData = null;\n  }\n\n  // PRIVATE METHODS\n\n  // Allocate a new buffer and initialize to contents of typed array\n  _setData(data, offset = 0, byteLength = data.byteLength + offset) {\n    assert(ArrayBuffer.isView(data));\n\n    this._trackDeallocatedMemory();\n\n    const target = this._getTarget();\n    this.gl.bindBuffer(target, this.handle);\n    this.gl.bufferData(target, byteLength, this.usage);\n    this.gl.bufferSubData(target, offset, data);\n    this.gl.bindBuffer(target, null);\n\n    this.debugData = data.slice(0, DEBUG_DATA_LENGTH);\n    this.bytesUsed = byteLength;\n\n    this._trackAllocatedMemory(byteLength);\n\n    // infer GL type from supplied typed array\n    const type = getGLTypeFromTypedArray(data);\n    assert(type);\n    this.setAccessor(new Accessor(this.accessor, {type}));\n    return this;\n  }\n\n  // Allocate a GPU buffer of specified size.\n  _setByteLength(byteLength, usage = this.usage) {\n    assert(byteLength >= 0);\n\n    this._trackDeallocatedMemory();\n\n    // Workaround needed for Safari (#291):\n    // gl.bufferData with size equal to 0 crashes. Instead create zero sized array.\n    let data = byteLength;\n    if (byteLength === 0) {\n      data = new Float32Array(0);\n    }\n\n    const target = this._getTarget();\n    this.gl.bindBuffer(target, this.handle);\n    this.gl.bufferData(target, data, usage);\n    this.gl.bindBuffer(target, null);\n\n    this.usage = usage;\n    this.debugData = null;\n    this.bytesUsed = byteLength;\n\n    this._trackAllocatedMemory(byteLength);\n\n    return this;\n  }\n\n  // Binding a buffer for the first time locks the type\n  // In WebGL2, use GL.COPY_WRITE_BUFFER to avoid locking the type\n  _getTarget() {\n    return this.gl.webgl2 ? GL.COPY_WRITE_BUFFER : this.target;\n  }\n\n  _getAvailableElementCount(srcByteOffset) {\n    const ArrayType = getTypedArrayFromGLType(this.accessor.type || GL.FLOAT, {clamped: false});\n    const sourceElementOffset = srcByteOffset / ArrayType.BYTES_PER_ELEMENT;\n    return this.getElementCount() - sourceElementOffset;\n  }\n\n  // Automatically infers type from typed array passed to setData\n  // Note: No longer that useful, since type is now autodeduced from the compiled shaders\n  _inferType(data) {\n    if (!this.accessor.type) {\n      this.setAccessor(new Accessor(this.accessor, {type: getGLTypeFromTypedArray(data)}));\n    }\n  }\n\n  // RESOURCE METHODS\n\n  _createHandle() {\n    return this.gl.createBuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteBuffer(this.handle);\n    this._trackDeallocatedMemory();\n  }\n\n  _getParameter(pname) {\n    this.gl.bindBuffer(this.target, this.handle);\n    const value = this.gl.getBufferParameter(this.target, pname);\n    this.gl.bindBuffer(this.target, null);\n    return value;\n  }\n\n  // DEPRECATIONS - v7.0\n  get type() {\n    log.deprecated('Buffer.type', 'Buffer.accessor.type')();\n    return this.accessor.type;\n  }\n\n  get bytes() {\n    log.deprecated('Buffer.bytes', 'Buffer.byteLength')();\n    return this.byteLength;\n  }\n\n  // DEPRECATIONS - v6.0\n  // Deprecated in v6.x, but not warnings not properly implemented\n  setByteLength(byteLength) {\n    log.deprecated('setByteLength', 'reallocate')();\n    return this.reallocate(byteLength);\n  }\n\n  // Deprecated in v6.x, but not warnings not properly implemented\n  updateAccessor(opts) {\n    log.deprecated('updateAccessor(...)', 'setAccessor(new Accessor(buffer.accessor, ...)')();\n    this.accessor = new Accessor(this.accessor, opts);\n    return this;\n  }\n}\n","import {assertWebGL2Context, withParameters} from '@luma.gl/gltools';\nimport {assert} from '../utils/assert';\n\n// Should collapse during minification\nconst GL_DEPTH_BUFFER_BIT = 0x00000100;\nconst GL_STENCIL_BUFFER_BIT = 0x00000400;\nconst GL_COLOR_BUFFER_BIT = 0x00004000;\n\nconst GL_COLOR = 0x1800;\nconst GL_DEPTH = 0x1801;\nconst GL_STENCIL = 0x1802;\nconst GL_DEPTH_STENCIL = 0x84f9;\n\n// Should disappear if asserts are removed\nconst ERR_ARGUMENTS = 'clear: bad arguments';\n\n// Optionally clears depth, color and stencil buffers\n/** @type {import('./clear').clear} */\nexport function clear(gl, {framebuffer = null, color = null, depth = null, stencil = null} = {}) {\n  const parameters = {};\n\n  if (framebuffer) {\n    parameters.framebuffer = framebuffer;\n  }\n\n  let clearFlags = 0;\n\n  if (color) {\n    clearFlags |= GL_COLOR_BUFFER_BIT;\n    if (color !== true) {\n      parameters.clearColor = color;\n    }\n  }\n\n  if (depth) {\n    clearFlags |= GL_DEPTH_BUFFER_BIT;\n    if (depth !== true) {\n      parameters.clearDepth = depth;\n    }\n  }\n\n  if (stencil) {\n    clearFlags |= GL_STENCIL_BUFFER_BIT;\n    if (depth !== true) {\n      parameters.clearStencil = depth;\n    }\n  }\n\n  assert(clearFlags !== 0, ERR_ARGUMENTS);\n\n  // Temporarily set any clear \"colors\" and call clear\n  withParameters(gl, parameters, () => {\n    gl.clear(clearFlags);\n  });\n}\n\n// WebGL2 - clear a specific drawing buffer\n/** @type {import('./clear').clearBuffer} */\nexport function clearBuffer(\n  gl,\n  {framebuffer = null, buffer = GL_COLOR, drawBuffer = 0, value = [0, 0, 0, 0]} = {}\n) {\n  assertWebGL2Context(gl);\n\n  withParameters(gl, {framebuffer}, () => {\n    // Method selection per OpenGL ES 3 docs\n    switch (buffer) {\n      case GL_COLOR:\n        switch (value.constructor) {\n          case Int32Array:\n            gl.clearBufferiv(buffer, drawBuffer, value);\n            break;\n          case Uint32Array:\n            gl.clearBufferuiv(buffer, drawBuffer, value);\n            break;\n          case Float32Array:\n          default:\n            gl.clearBufferfv(buffer, drawBuffer, value);\n        }\n        break;\n\n      case GL_DEPTH:\n        gl.clearBufferfv(GL_DEPTH, 0, [value]);\n        break;\n\n      case GL_STENCIL:\n        gl.clearBufferiv(GL_STENCIL, 0, [value]);\n        break;\n\n      case GL_DEPTH_STENCIL:\n        const [depth, stencil] = value;\n        gl.clearBufferfi(GL_DEPTH_STENCIL, 0, depth, stencil);\n        break;\n\n      default:\n        assert(false, ERR_ARGUMENTS);\n    }\n  });\n}\n","import GL from '@luma.gl/constants';\nimport Buffer from './buffer';\nimport Framebuffer from './framebuffer';\nimport Texture from './texture';\nimport {assertWebGL2Context, withParameters, log} from '@luma.gl/gltools';\nimport {flipRows, scalePixels} from '../webgl-utils/typed-array-utils';\nimport {getTypedArrayFromGLType, getGLTypeFromTypedArray} from '../webgl-utils/typed-array-utils';\nimport {glFormatToComponents, glTypeToBytes} from '../webgl-utils/format-utils';\nimport {toFramebuffer} from '../webgl-utils/texture-utils';\nimport {assert} from '../utils/assert';\n\n// NOTE: Slow requires roundtrip to GPU\n// Copies data from a Framebuffer or a Texture object into ArrayBuffer object.\n// App can provide targetPixelArray or have it auto allocated by this method\n// @returns {Uint8Array|Uint16Array|FloatArray} - pixel array,\n//  newly allocated by this method unless provided by app.\nexport function readPixelsToArray(source, options = {}) {\n  const {sourceX = 0, sourceY = 0, sourceFormat = GL.RGBA} = options;\n  let {\n    sourceAttachment = GL.COLOR_ATTACHMENT0, // TODO - support gl.readBuffer\n    target = null,\n    // following parameters are auto deduced if not provided\n    sourceWidth,\n    sourceHeight,\n    sourceType\n  } = options;\n\n  const {framebuffer, deleteFramebuffer} = getFramebuffer(source);\n  assert(framebuffer);\n  const {gl, handle, attachments} = framebuffer;\n  sourceWidth = sourceWidth || framebuffer.width;\n  sourceHeight = sourceHeight || framebuffer.height;\n\n  // TODO - Set and unset gl.readBuffer\n  if (sourceAttachment === GL.COLOR_ATTACHMENT0 && handle === null) {\n    sourceAttachment = GL.FRONT;\n  }\n\n  assert(attachments[sourceAttachment]);\n\n  // Deduce the type from color attachment if not provided.\n  sourceType = sourceType || attachments[sourceAttachment].type;\n\n  // Deduce type and allocated pixelArray if needed\n  target = getPixelArray(target, sourceType, sourceFormat, sourceWidth, sourceHeight);\n\n  // Pixel array available, if necessary, deduce type from it.\n  sourceType = sourceType || getGLTypeFromTypedArray(target);\n\n  const prevHandle = gl.bindFramebuffer(GL.FRAMEBUFFER, handle);\n  gl.readPixels(sourceX, sourceY, sourceWidth, sourceHeight, sourceFormat, sourceType, target);\n  // @ts-ignore\n  gl.bindFramebuffer(GL.FRAMEBUFFER, prevHandle || null);\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n  return target;\n}\n\n// NOTE: doesn't wait for copy to be complete, it programs GPU to perform a DMA transffer.\n// Copies data from a Framebuffer or a Texture object into a Buffer object.\nexport function readPixelsToBuffer(\n  source,\n  {\n    sourceX = 0,\n    sourceY = 0,\n    sourceFormat = GL.RGBA,\n    target = null, // A new Buffer object is created when not provided.\n    targetByteOffset = 0, // byte offset in buffer object\n    // following parameters are auto deduced if not provided\n    sourceWidth,\n    sourceHeight,\n    sourceType\n  }\n) {\n  const {framebuffer, deleteFramebuffer} = getFramebuffer(source);\n  assert(framebuffer);\n  sourceWidth = sourceWidth || framebuffer.width;\n  sourceHeight = sourceHeight || framebuffer.height;\n\n  // Asynchronus read (PIXEL_PACK_BUFFER) is WebGL2 only feature\n  const gl2 = assertWebGL2Context(framebuffer.gl);\n\n  // deduce type if not available.\n  sourceType = sourceType || (target ? target.type : GL.UNSIGNED_BYTE);\n\n  if (!target) {\n    // Create new buffer with enough size\n    const components = glFormatToComponents(sourceFormat);\n    const byteCount = glTypeToBytes(sourceType);\n    const byteLength = targetByteOffset + sourceWidth * sourceHeight * components * byteCount;\n    target = new Buffer(gl2, {byteLength, accessor: {type: sourceType, size: components}});\n  }\n\n  target.bind({target: GL.PIXEL_PACK_BUFFER});\n  withParameters(gl2, {framebuffer}, () => {\n    gl2.readPixels(\n      sourceX,\n      sourceY,\n      sourceWidth,\n      sourceHeight,\n      sourceFormat,\n      sourceType,\n      targetByteOffset\n    );\n  });\n  target.unbind({target: GL.PIXEL_PACK_BUFFER});\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n\n  return target;\n}\n\n// Reads pixels from a Framebuffer or Texture object to a dataUrl\nexport function copyToDataUrl(\n  source,\n  {\n    sourceAttachment = GL.COLOR_ATTACHMENT0, // TODO - support gl.readBuffer\n    targetMaxHeight = Number.MAX_SAFE_INTEGER\n  } = {}\n) {\n  let data = readPixelsToArray(source, {sourceAttachment});\n\n  // Scale down\n  let {width, height} = source;\n  while (height > targetMaxHeight) {\n    ({data, width, height} = scalePixels({data, width, height}));\n  }\n\n  // Flip to top down coordinate system\n  flipRows({data, width, height});\n\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const context = canvas.getContext('2d');\n\n  // Copy the pixels to a 2D canvas\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(data);\n  context.putImageData(imageData, 0, 0);\n\n  return canvas.toDataURL();\n}\n\n// Reads pixels from a Framebuffer or Texture object into an HTML Image\nexport function copyToImage(\n  source,\n  {\n    sourceAttachment = GL.COLOR_ATTACHMENT0, // TODO - support gl.readBuffer\n    targetImage = null\n  } = {}\n) {\n  const dataUrl = copyToDataUrl(source, {sourceAttachment});\n  targetImage = targetImage || new Image();\n  targetImage.src = dataUrl;\n  return targetImage;\n}\n\n// Copy a rectangle from a Framebuffer or Texture object into a texture (at an offset)\n// eslint-disable-next-line complexity, max-statements\nexport function copyToTexture(source, target, options = {}) {\n  const {\n    sourceX = 0,\n    sourceY = 0,\n    // attachment = GL.COLOR_ATTACHMENT0, // TODO - support gl.readBuffer\n    targetMipmaplevel = 0,\n    targetInternalFormat = GL.RGBA\n  } = options;\n  let {\n    targetX,\n    targetY,\n    targetZ,\n    width, // defaults to target width\n    height // defaults to target height\n  } = options;\n\n  const {framebuffer, deleteFramebuffer} = getFramebuffer(source);\n  assert(framebuffer);\n  const {gl, handle} = framebuffer;\n  const isSubCopy =\n    typeof targetX !== 'undefined' ||\n    typeof targetY !== 'undefined' ||\n    typeof targetZ !== 'undefined';\n  targetX = targetX || 0;\n  targetY = targetY || 0;\n  targetZ = targetZ || 0;\n  const prevHandle = gl.bindFramebuffer(GL.FRAMEBUFFER, handle);\n  // TODO - support gl.readBuffer (WebGL2 only)\n  // const prevBuffer = gl.readBuffer(attachment);\n  assert(target);\n  let texture = null;\n  if (target instanceof Texture) {\n    texture = target;\n    width = Number.isFinite(width) ? width : texture.width;\n    height = Number.isFinite(height) ? height : texture.height;\n    texture.bind(0);\n    target = texture.target;\n  }\n\n  if (!isSubCopy) {\n    gl.copyTexImage2D(\n      target,\n      targetMipmaplevel,\n      targetInternalFormat,\n      sourceX,\n      sourceY,\n      width,\n      height,\n      0 /* border must be 0 */\n    );\n  } else {\n    switch (target) {\n      case GL.TEXTURE_2D:\n      case GL.TEXTURE_CUBE_MAP:\n        gl.copyTexSubImage2D(\n          target,\n          targetMipmaplevel,\n          targetX,\n          targetY,\n          sourceX,\n          sourceY,\n          width,\n          height\n        );\n        break;\n      case GL.TEXTURE_2D_ARRAY:\n      case GL.TEXTURE_3D:\n        const gl2 = assertWebGL2Context(gl);\n        gl2.copyTexSubImage3D(\n          target,\n          targetMipmaplevel,\n          targetX,\n          targetY,\n          targetZ,\n          sourceX,\n          sourceY,\n          width,\n          height\n        );\n        break;\n      default:\n    }\n  }\n  if (texture) {\n    texture.unbind();\n  }\n  // @ts-ignore\n  gl.bindFramebuffer(GL.FRAMEBUFFER, prevHandle || null);\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n  return texture;\n}\n\n// NOTE: WEBLG2 only\n// Copies a rectangle of pixels between Framebuffer or Texture objects\n// eslint-disable-next-line max-statements, complexity\nexport function blit(source, target, options = {}) {\n  const {\n    sourceX0 = 0,\n    sourceY0 = 0,\n    targetX0 = 0,\n    targetY0 = 0,\n    color = true,\n    depth = false,\n    stencil = false,\n    filter = GL.NEAREST\n  } = options;\n\n  let {\n    sourceX1,\n    sourceY1,\n    targetX1,\n    targetY1,\n    sourceAttachment = GL.COLOR_ATTACHMENT0,\n    mask = 0\n  } = options;\n\n  const {framebuffer: srcFramebuffer, deleteFramebuffer: deleteSrcFramebuffer} = getFramebuffer(\n    source\n  );\n  const {framebuffer: dstFramebuffer, deleteFramebuffer: deleteDstFramebuffer} = getFramebuffer(\n    target\n  );\n\n  assert(srcFramebuffer);\n  assert(dstFramebuffer);\n  // @ts-ignore\n  const {gl, handle, width, height, readBuffer} = dstFramebuffer;\n  const gl2 = assertWebGL2Context(gl);\n\n  if (!srcFramebuffer.handle && sourceAttachment === GL.COLOR_ATTACHMENT0) {\n    sourceAttachment = GL.FRONT;\n  }\n\n  if (color) {\n    mask |= GL.COLOR_BUFFER_BIT;\n  }\n  if (depth) {\n    mask |= GL.DEPTH_BUFFER_BIT;\n  }\n  if (stencil) {\n    mask |= GL.STENCIL_BUFFER_BIT;\n  }\n\n  if (deleteSrcFramebuffer || deleteDstFramebuffer) {\n    // Either source or destiantion was a texture object, which is wrapped in a Framebuffer objecgt as color attachment.\n    // Overwrite the mask to `COLOR_BUFFER_BIT`\n    if (mask & (GL.DEPTH_BUFFER_BIT | GL.STENCIL_BUFFER_BIT)) {\n      mask = GL.COLOR_BUFFER_BIT;\n      log.warn('Blitting from or into a Texture object, forcing mask to GL.COLOR_BUFFER_BIT')();\n    }\n  }\n  assert(mask);\n\n  sourceX1 = sourceX1 === undefined ? srcFramebuffer.width : sourceX1;\n  sourceY1 = sourceY1 === undefined ? srcFramebuffer.height : sourceY1;\n  targetX1 = targetX1 === undefined ? width : targetX1;\n  targetY1 = targetY1 === undefined ? height : targetY1;\n\n  const prevDrawHandle = gl.bindFramebuffer(GL.DRAW_FRAMEBUFFER, handle);\n  const prevReadHandle = gl.bindFramebuffer(GL.READ_FRAMEBUFFER, srcFramebuffer.handle);\n  gl2.readBuffer(sourceAttachment);\n  gl2.blitFramebuffer(\n    sourceX0,\n    sourceY0,\n    sourceX1,\n    sourceY1,\n    targetX0,\n    targetY0,\n    targetX1,\n    targetY1,\n    mask,\n    filter\n  );\n  gl2.readBuffer(readBuffer);\n  // @ts-ignore\n  gl2.bindFramebuffer(GL.READ_FRAMEBUFFER, prevReadHandle || null);\n  // @ts-ignore\n  gl2.bindFramebuffer(GL.DRAW_FRAMEBUFFER, prevDrawHandle || null);\n  if (deleteSrcFramebuffer) {\n    srcFramebuffer.delete();\n  }\n  if (deleteDstFramebuffer) {\n    dstFramebuffer.delete();\n  }\n\n  return dstFramebuffer;\n}\n\n// Helper methods\n\nfunction getFramebuffer(source) {\n  if (!(source instanceof Framebuffer)) {\n    return {framebuffer: toFramebuffer(source), deleteFramebuffer: true};\n  }\n  return {framebuffer: source, deleteFramebuffer: false};\n}\n\nfunction getPixelArray(pixelArray, type, format, width, height) {\n  if (pixelArray) {\n    return pixelArray;\n  }\n  // Allocate pixel array if not already available, using supplied type\n  type = type || GL.UNSIGNED_BYTE;\n  const ArrayType = getTypedArrayFromGLType(type, {clamped: false});\n  const components = glFormatToComponents(format);\n  // TODO - check for composite type (components = 1).\n  return new ArrayType(width * height * components);\n}\n","import GL from '@luma.gl/constants';\nimport {getWebGL2Context, assertWebGL2Context, log} from '@luma.gl/gltools';\nimport Resource from './resource';\nimport Texture2D from './texture-2d';\nimport Renderbuffer from './renderbuffer';\nimport {clear, clearBuffer} from './clear';\nimport {copyToDataUrl} from './copy-and-blit.js';\n\nimport {getFeatures} from '../features';\nimport {getKey} from '../webgl-utils/constants-to-keys';\nimport {assert} from '../utils/assert';\n\nconst ERR_MULTIPLE_RENDERTARGETS = 'Multiple render targets not supported';\n\nexport default class Framebuffer extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Framebuffer';\n  }\n  static isSupported(gl, options = {}) {\n    const {\n      colorBufferFloat, // Whether floating point textures can be rendered and read\n      colorBufferHalfFloat // Whether half float textures can be rendered and read\n    } = options;\n    let supported = true;\n\n    if (colorBufferFloat) {\n      supported = Boolean(\n        // WebGL 2\n        gl.getExtension('EXT_color_buffer_float') ||\n          // WebGL 1, not exposed on all platforms\n          gl.getExtension('WEBGL_color_buffer_float') ||\n          // WebGL 1, implicitly enables float render targets https://www.khronos.org/registry/webgl/extensions/OES_texture_float/\n          gl.getExtension('OES_texture_float')\n      );\n    }\n\n    if (colorBufferHalfFloat) {\n      supported =\n        supported &&\n        Boolean(\n          // WebGL 2\n          gl.getExtension('EXT_color_buffer_float') ||\n            // WebGL 1\n            gl.getExtension('EXT_color_buffer_half_float')\n        );\n    }\n\n    return supported;\n  }\n\n  // Create a Framebuffer wrapper for the default framebuffer (target === null)\n  static getDefaultFramebuffer(gl) {\n    gl.luma = gl.luma || {};\n    gl.luma.defaultFramebuffer =\n      gl.luma.defaultFramebuffer ||\n      new Framebuffer(gl, {\n        id: 'default-framebuffer',\n        handle: null,\n        attachments: {}\n      });\n    // TODO - can we query for and get a handle to the GL.FRONT renderbuffer?\n    return gl.luma.defaultFramebuffer;\n  }\n\n  get MAX_COLOR_ATTACHMENTS() {\n    const gl2 = assertWebGL2Context(this.gl);\n    return gl2.getParameter(gl2.MAX_COLOR_ATTACHMENTS);\n  }\n\n  get MAX_DRAW_BUFFERS() {\n    const gl2 = assertWebGL2Context(this.gl);\n    return gl2.getParameter(gl2.MAX_DRAW_BUFFERS);\n  }\n\n  constructor(gl, opts = {}) {\n    super(gl, opts);\n\n    // Public members\n    this.width = null;\n    this.height = null;\n    this.attachments = {};\n    this.readBuffer = GL.COLOR_ATTACHMENT0;\n    this.drawBuffers = [GL.COLOR_ATTACHMENT0];\n    this.ownResources = [];\n    this.initialize(opts);\n\n    Object.seal(this);\n  }\n\n  get color() {\n    return this.attachments[GL.COLOR_ATTACHMENT0] || null;\n  }\n\n  get texture() {\n    return this.attachments[GL.COLOR_ATTACHMENT0] || null;\n  }\n\n  get depth() {\n    return (\n      this.attachments[GL.DEPTH_ATTACHMENT] || this.attachments[GL.DEPTH_STENCIL_ATTACHMENT] || null\n    );\n  }\n\n  get stencil() {\n    return (\n      this.attachments[GL.STENCIL_ATTACHMENT] ||\n      this.attachments[GL.DEPTH_STENCIL_ATTACHMENT] ||\n      null\n    );\n  }\n\n  initialize({\n    width = 1,\n    height = 1,\n    attachments = null,\n    color = true,\n    depth = true,\n    stencil = false,\n    check = true,\n    readBuffer = undefined,\n    drawBuffers = undefined\n  }) {\n    assert(width >= 0 && height >= 0, 'Width and height need to be integers');\n\n    // Store actual width and height for diffing\n    this.width = width;\n    this.height = height;\n\n    // Resize any provided attachments - note that resize only resizes if needed\n    // Note: A framebuffer has no separate size, it is defined by its attachments (which must agree)\n    if (attachments) {\n      for (const attachment in attachments) {\n        const target = attachments[attachment];\n        const object = Array.isArray(target) ? target[0] : target;\n        object.resize({width, height});\n      }\n    } else {\n      // Create any requested default attachments\n      attachments = this._createDefaultAttachments(color, depth, stencil, width, height);\n    }\n\n    this.update({clearAttachments: true, attachments, readBuffer, drawBuffers});\n\n    // Checks that framebuffer was properly set up, if not, throws an explanatory error\n    if (attachments && check) {\n      this.checkStatus();\n    }\n  }\n\n  delete() {\n    for (const resource of this.ownResources) {\n      resource.delete();\n    }\n    super.delete();\n    return this;\n  }\n\n  update({\n    attachments = {},\n    readBuffer,\n    drawBuffers,\n    clearAttachments = false,\n    resizeAttachments = true\n  }) {\n    this.attach(attachments, {clearAttachments, resizeAttachments});\n\n    const {gl} = this;\n    // Multiple render target support, set read buffer and draw buffers\n    const prevHandle = gl.bindFramebuffer(GL.FRAMEBUFFER, this.handle);\n    if (readBuffer) {\n      this._setReadBuffer(readBuffer);\n    }\n    if (drawBuffers) {\n      this._setDrawBuffers(drawBuffers);\n    }\n    // @ts-ignore\n    gl.bindFramebuffer(GL.FRAMEBUFFER, prevHandle || null);\n\n    return this;\n  }\n\n  // Attachment resize is expected to be a noop if size is same\n  resize(options = {}) {\n    let {width, height} = options;\n    // for default framebuffer, just update the stored size\n    if (this.handle === null) {\n      assert(width === undefined && height === undefined);\n      this.width = this.gl.drawingBufferWidth;\n      this.height = this.gl.drawingBufferHeight;\n      return this;\n    }\n\n    if (width === undefined) {\n      width = this.gl.drawingBufferWidth;\n    }\n    if (height === undefined) {\n      height = this.gl.drawingBufferHeight;\n    }\n\n    if (width !== this.width && height !== this.height) {\n      log.log(2, `Resizing framebuffer ${this.id} to ${width}x${height}`)();\n    }\n    for (const attachmentPoint in this.attachments) {\n      this.attachments[attachmentPoint].resize({width, height});\n    }\n    this.width = width;\n    this.height = height;\n    return this;\n  }\n\n  // Attach from a map of attachments\n  attach(attachments, {clearAttachments = false, resizeAttachments = true} = {}) {\n    const newAttachments = {};\n\n    // Any current attachments need to be removed, add null values to map\n    if (clearAttachments) {\n      Object.keys(this.attachments).forEach(key => {\n        newAttachments[key] = null;\n      });\n    }\n\n    // Overlay the new attachments\n    Object.assign(newAttachments, attachments);\n\n    const prevHandle = this.gl.bindFramebuffer(GL.FRAMEBUFFER, this.handle);\n\n    // Walk the attachments\n    for (const key in newAttachments) {\n      // Ensure key is not undefined\n      assert(key !== undefined, 'Misspelled framebuffer binding point?');\n\n      const attachment = Number(key);\n\n      const descriptor = newAttachments[attachment];\n      let object = descriptor;\n      if (!object) {\n        this._unattach(attachment);\n      } else if (object instanceof Renderbuffer) {\n        this._attachRenderbuffer({attachment, renderbuffer: object});\n      } else if (Array.isArray(descriptor)) {\n        const [texture, layer = 0, level = 0] = descriptor;\n        object = texture;\n        this._attachTexture({attachment, texture, layer, level});\n      } else {\n        this._attachTexture({attachment, texture: object, layer: 0, level: 0});\n      }\n\n      // Resize objects\n      if (resizeAttachments && object) {\n        object.resize({width: this.width, height: this.height});\n      }\n    }\n\n    // @ts-ignore\n    this.gl.bindFramebuffer(GL.FRAMEBUFFER, prevHandle || null);\n\n    // Assign to attachments and remove any nulls to get a clean attachment map\n    Object.assign(this.attachments, attachments);\n    Object.keys(this.attachments)\n      .filter(key => !this.attachments[key])\n      .forEach(key => {\n        delete this.attachments[key];\n      });\n  }\n\n  checkStatus() {\n    const {gl} = this;\n    const status = this.getStatus();\n    if (status !== gl.FRAMEBUFFER_COMPLETE) {\n      throw new Error(_getFrameBufferStatus(status));\n    }\n    return this;\n  }\n\n  getStatus() {\n    const {gl} = this;\n    const prevHandle = gl.bindFramebuffer(GL.FRAMEBUFFER, this.handle);\n    const status = gl.checkFramebufferStatus(GL.FRAMEBUFFER);\n    // @ts-ignore\n    gl.bindFramebuffer(GL.FRAMEBUFFER, prevHandle || null);\n    return status;\n  }\n\n  clear(options = {}) {\n    const {color, depth, stencil, drawBuffers = []} = options;\n\n    // Bind framebuffer and delegate to global clear functions\n    const prevHandle = this.gl.bindFramebuffer(GL.FRAMEBUFFER, this.handle);\n\n    if (color || depth || stencil) {\n      clear(this.gl, {color, depth, stencil});\n    }\n\n    drawBuffers.forEach((value, drawBuffer) => {\n      clearBuffer(this.gl, {drawBuffer, value});\n    });\n\n    // @ts-ignore\n    this.gl.bindFramebuffer(GL.FRAMEBUFFER, prevHandle || null);\n\n    return this;\n  }\n\n  // NOTE: Slow requires roundtrip to GPU\n  // App can provide pixelArray or have it auto allocated by this method\n  // @returns {Uint8Array|Uint16Array|FloatArray} - pixel array,\n  //  newly allocated by this method unless provided by app.\n  readPixels(opts = {}) {\n    log.error(\n      'Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)'\n    )();\n    return null;\n  }\n\n  // Reads data into provided buffer object asynchronously\n  // This function doesn't wait for copy to be complete, it programs GPU to perform a DMA transffer.\n  readPixelsToBuffer(opts = {}) {\n    log.error(\n      'Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)'\n    )();\n    return null;\n  }\n\n  // Reads pixels as a dataUrl\n  copyToDataUrl(opts = {}) {\n    log.error(\n      'Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)'\n    )();\n    return null;\n  }\n\n  // Reads pixels into an HTML Image\n  copyToImage(opts = {}) {\n    log.error('Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)')();\n    return null;\n  }\n\n  // copyToFramebuffer({width, height}) {\n  //   const scaleX = width / this.width;\n  //   const scaleY = height / this.height;\n  //   const scale = Math.min(scaleX, scaleY);\n  //   width = width * scale;\n  //   height = height * scale;\n  //   const scaledFramebuffer = new Framebuffer(this.gl, {width, height});\n  //   this.blit();\n  // }\n\n  // Copy a rectangle from a framebuffer attachment into a texture (at an offset)\n  // NOTE: assumes texture has enough storage allocated\n  // eslint-disable-next-line complexity\n  copyToTexture(opts = {}) {\n    log.error(\n      'Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})'\n    )();\n    return null;\n  }\n\n  // WEBGL2 INTERFACE\n\n  // Copies a rectangle of pixels between framebuffers\n  // eslint-disable-next-line complexity\n  blit(opts = {}) {\n    log.error('Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)')();\n    return null;\n  }\n\n  // signals to the GL that it need not preserve all pixels of a specified region of the framebuffer\n  invalidate({attachments = [], x = 0, y = 0, width, height}) {\n    const gl2 = assertWebGL2Context(this.gl);\n    const prevHandle = gl2.bindFramebuffer(GL.READ_FRAMEBUFFER, this.handle);\n    const invalidateAll = x === 0 && y === 0 && width === undefined && height === undefined;\n    if (invalidateAll) {\n      gl2.invalidateFramebuffer(GL.READ_FRAMEBUFFER, attachments);\n    } else {\n      // TODO - why does type checking fail on this line\n      // @ts-ignore\n      gl2.invalidateFramebuffer(GL.READ_FRAMEBUFFER, attachments, x, y, width, height);\n    }\n    // @ts-ignore\n    gl2.bindFramebuffer(GL.READ_FRAMEBUFFER, prevHandle);\n    return this;\n  }\n\n  // Return the value for `pname` of the specified attachment.\n  // The type returned is the type of the requested pname\n  getAttachmentParameter(attachment, pname, keys) {\n    let value = this._getAttachmentParameterFallback(pname);\n    if (value === null) {\n      this.gl.bindFramebuffer(GL.FRAMEBUFFER, this.handle);\n      value = this.gl.getFramebufferAttachmentParameter(GL.FRAMEBUFFER, attachment, pname);\n      this.gl.bindFramebuffer(GL.FRAMEBUFFER, null);\n    }\n    if (keys && value > 1000) {\n      // @ts-ignore\n      value = getKey(this.gl, value);\n    }\n    return value;\n  }\n\n  getAttachmentParameters(\n    attachment = GL.COLOR_ATTACHMENT0,\n    keys,\n    // @ts-ignore\n    parameters = this.constructor.ATTACHMENT_PARAMETERS || []\n  ) {\n    const values = {};\n    for (const pname of parameters) {\n      const key = keys ? getKey(this.gl, pname) : pname;\n      values[key] = this.getAttachmentParameter(attachment, pname, keys);\n    }\n    return values;\n  }\n\n  getParameters(keys = true) {\n    const attachments = Object.keys(this.attachments);\n    // if (this === this.gl.luma.defaultFramebuffer) {\n    //   attachments = [GL.COLOR_ATTACHMENT0, GL.DEPTH_STENCIL_ATTACHMENT];\n    // }\n    const parameters = {};\n    for (const attachmentName of attachments) {\n      const attachment = Number(attachmentName);\n      const key = keys ? getKey(this.gl, attachment) : attachment;\n      parameters[key] = this.getAttachmentParameters(attachment, keys);\n    }\n    return parameters;\n  }\n\n  // DEBUG\n\n  // Note: Will only work when called in an event handler\n  show() {\n    if (typeof window !== 'undefined') {\n      window.open(copyToDataUrl(this), 'luma-debug-texture');\n    }\n    return this;\n  }\n\n  log(logLevel = 0, message = '') {\n    if (logLevel > log.level || typeof window === 'undefined') {\n      return this;\n    }\n    message = message || `Framebuffer ${this.id}`;\n    const image = copyToDataUrl(this, {targetMaxHeight: 100});\n    // @ts-expect-error\n    log.image({logLevel, message, image}, message)();\n    return this;\n  }\n\n  // WEBGL INTERFACE\n  bind({target = GL.FRAMEBUFFER} = {}) {\n    this.gl.bindFramebuffer(target, this.handle);\n    return this;\n  }\n\n  unbind({target = GL.FRAMEBUFFER} = {}) {\n    this.gl.bindFramebuffer(target, null);\n    return this;\n  }\n\n  // PRIVATE METHODS\n\n  _createDefaultAttachments(color, depth, stencil, width, height) {\n    let defaultAttachments = null;\n\n    // Add a color buffer if requested and not supplied\n    if (color) {\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[GL.COLOR_ATTACHMENT0] = new Texture2D(this.gl, {\n        id: `${this.id}-color0`,\n        pixels: null, // reserves texture memory, but texels are undefined\n        format: GL.RGBA,\n        type: GL.UNSIGNED_BYTE,\n        width,\n        height,\n        // Note: Mipmapping can be disabled by texture resource when we resize the texture\n        // to a non-power-of-two dimenstion (NPOT texture) under WebGL1. To have consistant\n        // behavior we always disable mipmaps.\n        mipmaps: false,\n        // Set MIN and MAG filtering parameters so mipmaps are not used in sampling.\n        // Use LINEAR so subpixel algos like fxaa work.\n        // Set WRAP modes that support NPOT textures too.\n        parameters: {\n          [GL.TEXTURE_MIN_FILTER]: GL.LINEAR,\n          [GL.TEXTURE_MAG_FILTER]: GL.LINEAR,\n          [GL.TEXTURE_WRAP_S]: GL.CLAMP_TO_EDGE,\n          [GL.TEXTURE_WRAP_T]: GL.CLAMP_TO_EDGE\n        }\n      });\n      // track to delete later\n      this.ownResources.push(defaultAttachments[GL.COLOR_ATTACHMENT0]);\n    }\n\n    if (depth && stencil) {\n      // TODO - handle separate stencil\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[GL.DEPTH_STENCIL_ATTACHMENT] = new Renderbuffer(this.gl, {\n        id: `${this.id}-depth-stencil`,\n        format: GL.DEPTH24_STENCIL8,\n        width,\n        height: 111\n      });\n      // track to delete later\n      this.ownResources.push(defaultAttachments[GL.DEPTH_STENCIL_ATTACHMENT]);\n      // TODO - optional texture\n      // new Texture2D(this.gl, {\n      //   id: `${this.id}-depth-stencil`,\n      //   format: GL.DEPTH24_STENCIL8,\n      //   dataFormat: GL.DEPTH_STENCIL,\n      //   type: GL.UNSIGNED_INT_24_8,\n      //   width,\n      //   height,\n      //   mipmaps: false\n      // });\n    } else if (depth) {\n      // Add a depth buffer if requested and not supplied\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[GL.DEPTH_ATTACHMENT] = new Renderbuffer(this.gl, {\n        id: `${this.id}-depth`,\n        format: GL.DEPTH_COMPONENT16,\n        width,\n        height\n      });\n      // track to delete later\n      this.ownResources.push(defaultAttachments[GL.DEPTH_ATTACHMENT]);\n    } else if (stencil) {\n      // TODO - handle separate stencil\n      assert(false);\n    }\n\n    return defaultAttachments;\n  }\n\n  _unattach(attachment) {\n    const oldAttachment = this.attachments[attachment];\n    if (!oldAttachment) {\n      return;\n    }\n    if (oldAttachment instanceof Renderbuffer) {\n      // render buffer\n      this.gl.framebufferRenderbuffer(GL.FRAMEBUFFER, attachment, GL.RENDERBUFFER, null);\n    } else {\n      // Must be a texture attachment\n      this.gl.framebufferTexture2D(GL.FRAMEBUFFER, attachment, GL.TEXTURE_2D, null, 0);\n    }\n    delete this.attachments[attachment];\n  }\n\n  _attachRenderbuffer({attachment = GL.COLOR_ATTACHMENT0, renderbuffer}) {\n    const {gl} = this;\n    // TODO - is the bind needed?\n    // gl.bindRenderbuffer(GL.RENDERBUFFER, renderbuffer.handle);\n    gl.framebufferRenderbuffer(GL.FRAMEBUFFER, attachment, GL.RENDERBUFFER, renderbuffer.handle);\n    // TODO - is the unbind needed?\n    // gl.bindRenderbuffer(GL.RENDERBUFFER, null);\n\n    this.attachments[attachment] = renderbuffer;\n  }\n\n  // layer = 0 - index into Texture2DArray and Texture3D or face for `TextureCubeMap`\n  // level = 0 - mipmapLevel (must be 0 in WebGL1)\n  _attachTexture({attachment = GL.COLOR_ATTACHMENT0, texture, layer, level}) {\n    const {gl} = this;\n    gl.bindTexture(texture.target, texture.handle);\n\n    switch (texture.target) {\n      case GL.TEXTURE_2D_ARRAY:\n      case GL.TEXTURE_3D:\n        const gl2 = assertWebGL2Context(gl);\n        gl2.framebufferTextureLayer(GL.FRAMEBUFFER, attachment, texture.target, level, layer);\n        break;\n\n      case GL.TEXTURE_CUBE_MAP:\n        // layer must be a cubemap face (or if index, converted to cube map face)\n        const face = mapIndexToCubeMapFace(layer);\n        gl.framebufferTexture2D(GL.FRAMEBUFFER, attachment, face, texture.handle, level);\n        break;\n\n      case GL.TEXTURE_2D:\n        gl.framebufferTexture2D(GL.FRAMEBUFFER, attachment, GL.TEXTURE_2D, texture.handle, level);\n        break;\n\n      default:\n        assert(false, 'Illegal texture type');\n    }\n\n    gl.bindTexture(texture.target, null);\n    this.attachments[attachment] = texture;\n  }\n\n  // Expects framebuffer to be bound\n  _setReadBuffer(readBuffer) {\n    const gl2 = getWebGL2Context(this.gl);\n    if (gl2) {\n      gl2.readBuffer(readBuffer);\n    } else {\n      // Setting to color attachment 0 is a noop, so allow it in WebGL1\n      assert(\n        readBuffer === GL.COLOR_ATTACHMENT0 || readBuffer === GL.BACK,\n        ERR_MULTIPLE_RENDERTARGETS\n      );\n    }\n    this.readBuffer = readBuffer;\n  }\n\n  // Expects framebuffer to be bound\n  _setDrawBuffers(drawBuffers) {\n    const {gl} = this;\n    const gl2 = assertWebGL2Context(gl);\n    if (gl2) {\n      gl2.drawBuffers(drawBuffers);\n    } else {\n      // TODO - is this not handled by polyfills?\n      const ext = gl.getExtension('WEBGL_draw_buffers');\n      if (ext) {\n        ext.drawBuffersWEBGL(drawBuffers);\n      } else {\n        // Setting a single draw buffer to color attachment 0 is a noop, allow in WebGL1\n        assert(\n          drawBuffers.length === 1 &&\n            (drawBuffers[0] === GL.COLOR_ATTACHMENT0 || drawBuffers[0] === GL.BACK),\n          ERR_MULTIPLE_RENDERTARGETS\n        );\n      }\n    }\n    this.drawBuffers = drawBuffers;\n  }\n\n  // Attempt to provide workable defaults for WebGL2 symbols under WebGL1\n  // null means OK to query\n  // TODO - move to webgl1 polyfills\n  /* eslint-disable complexity */\n  _getAttachmentParameterFallback(pname) {\n    const caps = getFeatures(this.gl);\n\n    switch (pname) {\n      case GL.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER: // GLint\n        return !caps.WEBGL2 ? 0 : null;\n      case GL.FRAMEBUFFER_ATTACHMENT_RED_SIZE: // GLint\n      case GL.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE: // GLint\n      case GL.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE: // GLint\n      case GL.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE: // GLint\n      case GL.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE: // GLint\n      case GL.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE: // GLint\n        return !caps.WEBGL2 ? 8 : null;\n      case GL.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE: // GLenum\n        return !caps.WEBGL2 ? GL.UNSIGNED_INT : null;\n      case GL.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:\n        return !caps.WEBGL2 && !caps.EXT_sRGB ? GL.LINEAR : null;\n      default:\n        return null;\n    }\n  }\n  /* eslint-enable complexity */\n\n  // RESOURCE METHODS\n\n  _createHandle() {\n    return this.gl.createFramebuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteFramebuffer(this.handle);\n  }\n\n  _bindHandle(handle) {\n    return this.gl.bindFramebuffer(GL.FRAMEBUFFER, handle);\n  }\n}\n\n// PUBLIC METHODS\n\n// Map an index to a cube map face constant\nfunction mapIndexToCubeMapFace(layer) {\n  // TEXTURE_CUBE_MAP_POSITIVE_X is a big value (0x8515)\n  // if smaller assume layer is index, otherwise assume it is already a cube map face constant\n  return layer < GL.TEXTURE_CUBE_MAP_POSITIVE_X ? layer + GL.TEXTURE_CUBE_MAP_POSITIVE_X : layer;\n}\n\n// Helper METHODS\n// Get a string describing the framebuffer error if installed\nfunction _getFrameBufferStatus(status) {\n  // Use error mapping if installed\n  // @ts-ignore\n  const STATUS = Framebuffer.STATUS || {};\n  return STATUS[status] || `Framebuffer error ${status}`;\n}\n\nexport const FRAMEBUFFER_ATTACHMENT_PARAMETERS = [\n  GL.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME, // WebGLRenderbuffer or WebGLTexture\n  GL.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE, // GL.RENDERBUFFER, GL.TEXTURE, GL.NONE\n  // GL.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE, // GL.TEXTURE_CUBE_MAP_POSITIVE_X, etc.\n  // GL.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL, // GLint\n  // EXT_sRGB or WebGL2\n  GL.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING, // GL.LINEAR, GL.SRBG\n  // WebGL2\n  // GL.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER, // GLint\n  GL.FRAMEBUFFER_ATTACHMENT_RED_SIZE, // GLint\n  GL.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE, // GLint\n  GL.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE, // GLint\n  GL.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE, // GLint\n  GL.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE, // GLint\n  GL.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE // GLint\n  // GL.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE\n  // GL.FLOAT, GL.INT, GL.UNSIGNED_INT, GL.SIGNED_NORMALIZED, OR GL.UNSIGNED_NORMALIZED.\n];\n\nFramebuffer.ATTACHMENT_PARAMETERS = FRAMEBUFFER_ATTACHMENT_PARAMETERS;\n","// Contains metadata describing attribute configurations for a program's shaders\n// Much of this is automatically extracted from shaders after program linking\nimport Accessor from './accessor';\nimport {isWebGL2} from '@luma.gl/gltools';\nimport {decomposeCompositeGLType} from '../webgl-utils/attribute-utils';\n\nexport default class ProgramConfiguration {\n  constructor(program) {\n    this.id = program.id;\n    this.attributeInfos = [];\n    this.attributeInfosByName = {};\n\n    // Locations may not be contiguous the case of matrix attributes\n    // so keep a separate location->attribute map.\n    this.attributeInfosByLocation = [];\n    this.varyingInfos = [];\n    this.varyingInfosByName = {};\n    Object.seal(this);\n    this._readAttributesFromProgram(program);\n    this._readVaryingsFromProgram(program);\n  }\n\n  getAttributeInfo(locationOrName) {\n    const location = Number(locationOrName);\n    if (Number.isFinite(location)) {\n      return this.attributeInfosByLocation[location];\n    }\n    return this.attributeInfosByName[locationOrName] || null;\n  }\n\n  // Resolves an attribute name or index to an index\n  getAttributeLocation(locationOrName) {\n    const attributeInfo = this.getAttributeInfo(locationOrName);\n    return attributeInfo ? attributeInfo.location : -1;\n  }\n\n  getAttributeAccessor(locationOrName) {\n    const attributeInfo = this.getAttributeInfo(locationOrName);\n    return attributeInfo ? attributeInfo.accessor : null;\n  }\n\n  getVaryingInfo(locationOrName) {\n    const location = Number(locationOrName);\n    if (Number.isFinite(location)) {\n      return this.varyingInfos[location];\n    }\n    return this.varyingInfosByName[locationOrName] || null;\n  }\n\n  getVaryingIndex(locationOrName) {\n    const varying = this.getVaryingInfo();\n    return varying ? varying.location : -1;\n  }\n\n  getVaryingAccessor(locationOrName) {\n    const varying = this.getVaryingInfo();\n    return varying ? varying.accessor : null;\n  }\n\n  // PRIVATE METHODS\n\n  // linkProgram needs to have been called, although linking does not need to have been successful\n  _readAttributesFromProgram(program) {\n    const {gl} = program;\n    const count = gl.getProgramParameter(program.handle, gl.ACTIVE_ATTRIBUTES);\n\n    for (let index = 0; index < count; index++) {\n      const {name, type, size} = gl.getActiveAttrib(program.handle, index);\n      const location = gl.getAttribLocation(program.handle, name);\n      // Add only user provided attributes, for built-in attributes like\n      // `gl_InstanceID` locaiton will be < 0\n      if (location >= 0) {\n        this._addAttribute(location, name, type, size);\n      }\n    }\n\n    this.attributeInfos.sort((a, b) => a.location - b.location);\n  }\n\n  // linkProgram needs to have been called, although linking does not need to have been successful\n  _readVaryingsFromProgram(program) {\n    const {gl} = program;\n    if (!isWebGL2(gl)) {\n      return;\n    }\n\n    const count = gl.getProgramParameter(program.handle, gl.TRANSFORM_FEEDBACK_VARYINGS);\n    for (let location = 0; location < count; location++) {\n      const {name, type, size} = gl.getTransformFeedbackVarying(program.handle, location);\n      this._addVarying(location, name, type, size);\n    }\n\n    this.varyingInfos.sort((a, b) => a.location - b.location);\n  }\n\n  _addAttribute(location, name, compositeType, size) {\n    const {type, components} = decomposeCompositeGLType(compositeType);\n    const accessor = {type, size: size * components};\n    this._inferProperties(location, name, accessor);\n\n    const attributeInfo = {location, name, accessor: new Accessor(accessor)}; // Base values\n    this.attributeInfos.push(attributeInfo);\n    this.attributeInfosByLocation[location] = attributeInfo; // For quick location based lookup\n    this.attributeInfosByName[attributeInfo.name] = attributeInfo; // For quick name based lookup\n  }\n\n  // Extract additional attribute metadata from shader names (based on attribute naming conventions)\n  _inferProperties(location, name, accessor) {\n    if (/instance/i.test(name)) {\n      // Any attribute containing the word \"instance\" will be assumed to be instanced\n      accessor.divisor = 1;\n    }\n  }\n\n  _addVarying(location, name, compositeType, size) {\n    const {type, components} = decomposeCompositeGLType(compositeType);\n    const accessor = new Accessor({type, size: size * components});\n\n    const varying = {location, name, accessor}; // Base values\n    this.varyingInfos.push(varying);\n    this.varyingInfosByName[varying.name] = varying; // For quick name based lookup\n  }\n}\n","import GL from '@luma.gl/constants';\n\nimport Resource from './resource';\nimport Texture from './texture';\nimport Framebuffer from './framebuffer';\nimport {parseUniformName, getUniformSetter} from './uniforms';\nimport {VertexShader, FragmentShader} from './shader';\nimport ProgramConfiguration from './program-configuration';\nimport {copyUniform, checkUniformValues} from './uniforms';\n\nimport {isWebGL2, assertWebGL2Context, withParameters, log} from '@luma.gl/gltools';\nimport {getKey} from '../webgl-utils/constants-to-keys';\nimport {getPrimitiveDrawMode} from '../webgl-utils/attribute-utils';\nimport {assert} from '../utils/assert';\nimport {uid} from '../utils/utils';\n\nconst LOG_PROGRAM_PERF_PRIORITY = 4;\n\nconst GL_SEPARATE_ATTRIBS = 0x8c8d;\n\nconst V6_DEPRECATED_METHODS = [\n  'setVertexArray',\n  'setAttributes',\n  'setBuffers',\n  'unsetBuffers',\n\n  'use',\n  'getUniformCount',\n  'getUniformInfo',\n  'getUniformLocation',\n  'getUniformValue',\n\n  'getVarying',\n  'getFragDataLocation',\n  'getAttachedShaders',\n  'getAttributeCount',\n  'getAttributeLocation',\n  'getAttributeInfo'\n];\n\nexport default class Program extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Program';\n  }\n  constructor(gl, props = {}) {\n    super(gl, props);\n\n    this.stubRemovedMethods('Program', 'v6.0', V6_DEPRECATED_METHODS);\n\n    // Experimental flag to avoid deleting Program object while it is cached\n    this._isCached = false;\n\n    this.initialize(props);\n\n    Object.seal(this);\n\n    this._setId(props.id);\n  }\n\n  initialize(props = {}) {\n    const {hash, vs, fs, varyings, bufferMode = GL_SEPARATE_ATTRIBS} = props;\n\n    this.hash = hash || ''; // Used by ProgramManager\n\n    // Create shaders if needed\n    this.vs =\n      typeof vs === 'string' ? new VertexShader(this.gl, {id: `${props.id}-vs`, source: vs}) : vs;\n    this.fs =\n      typeof fs === 'string' ? new FragmentShader(this.gl, {id: `${props.id}-fs`, source: fs}) : fs;\n    assert(this.vs instanceof VertexShader);\n    assert(this.fs instanceof FragmentShader);\n\n    // uniforms\n    this.uniforms = {};\n\n    this._textureUniforms = {};\n\n    // Setup varyings if supplied\n    if (varyings && varyings.length > 0) {\n      assertWebGL2Context(this.gl);\n      this.varyings = varyings;\n      this.gl2.transformFeedbackVaryings(this.handle, varyings, bufferMode);\n    }\n\n    this._compileAndLink();\n    this._readUniformLocationsFromLinkedProgram();\n    this.configuration = new ProgramConfiguration(this);\n\n    return this.setProps(props);\n  }\n\n  delete(options = {}) {\n    if (this._isCached) {\n      // This object is cached, do not delete\n      return this;\n    }\n    return super.delete(options);\n  }\n\n  setProps(props) {\n    if ('uniforms' in props) {\n      this.setUniforms(props.uniforms);\n    }\n    return this;\n  }\n\n  // A good thing about the WebGL API is that there are so many ways to draw things ;)\n  // This function unifies those ways into a single call using common parameters with sane defaults\n  draw({\n    logPriority, // Probe log priority, enables Model to do more integrated logging\n\n    drawMode = GL.TRIANGLES,\n    vertexCount,\n    offset = 0,\n    start,\n    end,\n    isIndexed = false,\n    indexType = GL.UNSIGNED_SHORT,\n    instanceCount = 0,\n    isInstanced = instanceCount > 0,\n\n    vertexArray = null,\n    transformFeedback,\n    framebuffer,\n    parameters = {},\n\n    // Deprecated\n    uniforms,\n    samplers\n  }) {\n    if (uniforms || samplers) {\n      // DEPRECATED: v7.0 (deprecated earlier but warning not properly implemented)\n      log.deprecated('Program.draw({uniforms})', 'Program.setUniforms(uniforms)')();\n      this.setUniforms(uniforms || {});\n    }\n\n    if (log.priority >= logPriority) {\n      const fb = framebuffer ? framebuffer.id : 'default';\n      const message =\n        `mode=${getKey(this.gl, drawMode)} verts=${vertexCount} ` +\n        `instances=${instanceCount} indexType=${getKey(this.gl, indexType)} ` +\n        `isInstanced=${isInstanced} isIndexed=${isIndexed} ` +\n        `Framebuffer=${fb}`;\n      log.log(logPriority, message)();\n    }\n\n    // TODO - move vertex array binding and transform feedback binding to withParameters?\n    assert(vertexArray);\n\n    this.gl.useProgram(this.handle);\n\n    if (\n      // Note: async textures set as uniforms might still be loading.\n      // Now that all uniforms have been updated, check if any texture\n      // in the uniforms is not yet initialized, then we don't draw\n      !this._areTexturesRenderable() ||\n      // Avoid WebGL draw call when not rendering any data\n      vertexCount === 0 ||\n      (isInstanced && instanceCount === 0)\n    ) {\n      return false;\n    }\n\n    vertexArray.bindForDraw(vertexCount, instanceCount, () => {\n      if (framebuffer !== undefined) {\n        parameters = Object.assign({}, parameters, {framebuffer});\n      }\n\n      if (transformFeedback) {\n        const primitiveMode = getPrimitiveDrawMode(drawMode);\n        transformFeedback.begin(primitiveMode);\n      }\n\n      this._bindTextures();\n\n      withParameters(this.gl, parameters, () => {\n        // TODO - Use polyfilled WebGL2RenderingContext instead of ANGLE extension\n        if (isIndexed && isInstanced) {\n          this.gl2.drawElementsInstanced(drawMode, vertexCount, indexType, offset, instanceCount);\n        } else if (isIndexed && isWebGL2(this.gl) && !isNaN(start) && !isNaN(end)) {\n          this.gl2.drawRangeElements(drawMode, start, end, vertexCount, indexType, offset);\n        } else if (isIndexed) {\n          this.gl.drawElements(drawMode, vertexCount, indexType, offset);\n        } else if (isInstanced) {\n          this.gl2.drawArraysInstanced(drawMode, offset, vertexCount, instanceCount);\n        } else {\n          this.gl.drawArrays(drawMode, offset, vertexCount);\n        }\n      });\n\n      if (transformFeedback) {\n        transformFeedback.end();\n      }\n    });\n\n    return true;\n  }\n\n  setUniforms(uniforms = {}) {\n    if (log.priority >= 2) {\n      checkUniformValues(uniforms, this.id, this._uniformSetters);\n    }\n\n    this.gl.useProgram(this.handle);\n\n    for (const uniformName in uniforms) {\n      const uniform = uniforms[uniformName];\n      const uniformSetter = this._uniformSetters[uniformName];\n\n      if (uniformSetter) {\n        let value = uniform;\n        let textureUpdate = false;\n\n        if (value instanceof Framebuffer) {\n          value = value.texture;\n        }\n        if (value instanceof Texture) {\n          textureUpdate = this.uniforms[uniformName] !== uniform;\n\n          if (textureUpdate) {\n            // eslint-disable-next-line max-depth\n            if (uniformSetter.textureIndex === undefined) {\n              uniformSetter.textureIndex = this._textureIndexCounter++;\n            }\n\n            // Bind texture to index\n            const texture = value;\n            const {textureIndex} = uniformSetter;\n\n            texture.bind(textureIndex);\n            value = textureIndex;\n\n            this._textureUniforms[uniformName] = texture;\n          } else {\n            value = uniformSetter.textureIndex;\n          }\n        } else if (this._textureUniforms[uniformName]) {\n          delete this._textureUniforms[uniformName];\n        }\n\n        // NOTE(Tarek): uniformSetter returns whether\n        //   value had to be updated or not.\n        if (uniformSetter(value) || textureUpdate) {\n          copyUniform(this.uniforms, uniformName, uniform);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  // PRIVATE METHODS\n\n  // Checks if all texture-values uniforms are renderable (i.e. loaded)\n  // Update a texture if needed (e.g. from video)\n  // Note: This is currently done before every draw call\n  _areTexturesRenderable() {\n    let texturesRenderable = true;\n\n    for (const uniformName in this._textureUniforms) {\n      const texture = this._textureUniforms[uniformName];\n      texture.update();\n      texturesRenderable = texturesRenderable && texture.loaded;\n    }\n\n    return texturesRenderable;\n  }\n\n  // Binds textures\n  // Note: This is currently done before every draw call\n  _bindTextures() {\n    for (const uniformName in this._textureUniforms) {\n      const textureIndex = this._uniformSetters[uniformName].textureIndex;\n      this._textureUniforms[uniformName].bind(textureIndex);\n    }\n  }\n\n  // RESOURCE METHODS\n\n  _createHandle() {\n    return this.gl.createProgram();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteProgram(this.handle);\n  }\n\n  // Extract opts needed to initialize a `Program` from an independently created WebGLProgram handle\n  _getOptionsFromHandle(handle) {\n    const shaderHandles = this.gl.getAttachedShaders(handle);\n    const opts = {};\n    for (const shaderHandle of shaderHandles) {\n      const type = this.gl.getShaderParameter(this.handle, GL.SHADER_TYPE);\n      switch (type) {\n        case GL.VERTEX_SHADER:\n          // @ts-ignore\n          opts.vs = new VertexShader({handle: shaderHandle});\n          break;\n        case GL.FRAGMENT_SHADER:\n          // @ts-ignore\n          opts.fs = new FragmentShader({handle: shaderHandle});\n          break;\n        default:\n      }\n    }\n    return opts;\n  }\n\n  _getParameter(pname) {\n    return this.gl.getProgramParameter(this.handle, pname);\n  }\n\n  // If program is not named, name it after shader names\n  // TODO - this.id will already have been initialized\n  _setId(id) {\n    if (!id) {\n      const programName = this._getName();\n      this.id = uid(programName);\n    }\n  }\n\n  // Generate a default name for the program based on names of the shaders\n  _getName() {\n    let programName = this.vs.getName() || this.fs.getName();\n    programName = programName.replace(/shader/i, '');\n    programName = programName ? `${programName}-program` : 'program';\n    return programName;\n  }\n\n  _compileAndLink() {\n    const {gl} = this;\n    gl.attachShader(this.handle, this.vs.handle);\n    gl.attachShader(this.handle, this.fs.handle);\n    log.time(LOG_PROGRAM_PERF_PRIORITY, `linkProgram for ${this._getName()}`)();\n    gl.linkProgram(this.handle);\n    log.timeEnd(LOG_PROGRAM_PERF_PRIORITY, `linkProgram for ${this._getName()}`)();\n\n    // Avoid checking program linking error in production\n    // @ts-ignore\n    if (gl.debug || log.level > 0) {\n      const linked = gl.getProgramParameter(this.handle, gl.LINK_STATUS);\n      if (!linked) {\n        throw new Error(`Error linking: ${gl.getProgramInfoLog(this.handle)}`);\n      }\n\n      gl.validateProgram(this.handle);\n      const validated = gl.getProgramParameter(this.handle, gl.VALIDATE_STATUS);\n      if (!validated) {\n        throw new Error(`Error validating: ${gl.getProgramInfoLog(this.handle)}`);\n      }\n    }\n  }\n\n  // query uniform locations and build name to setter map.\n  // TODO - This overlaps with ProgramConfiguration?\n  _readUniformLocationsFromLinkedProgram() {\n    const {gl} = this;\n    this._uniformSetters = {};\n    this._uniformCount = this._getParameter(GL.ACTIVE_UNIFORMS);\n    for (let i = 0; i < this._uniformCount; i++) {\n      const info = this.gl.getActiveUniform(this.handle, i);\n      const {name} = parseUniformName(info.name);\n      let location = gl.getUniformLocation(this.handle, name);\n      this._uniformSetters[name] = getUniformSetter(gl, location, info);\n      if (info.size > 1) {\n        for (let l = 0; l < info.size; l++) {\n          location = gl.getUniformLocation(this.handle, `${name}[${l}]`);\n          this._uniformSetters[`${name}[${l}]`] = getUniformSetter(gl, location, info);\n        }\n      }\n    }\n    this._textureIndexCounter = 0;\n  }\n\n  // TO BE REMOVED in v7?\n\n  // Rretrieves information about active uniforms identifed by their indices (`uniformIndices`)\n  // https://\n  // developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/getActiveUniforms\n  getActiveUniforms(uniformIndices, pname) {\n    return this.gl2.getActiveUniforms(this.handle, uniformIndices, pname);\n  }\n\n  // Retrieves the index of a uniform block\n  getUniformBlockIndex(blockName) {\n    return this.gl2.getUniformBlockIndex(this.handle, blockName);\n  }\n\n  // Retrieves information about an active uniform block (`blockIndex`)\n  // https://\n  // developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/getActiveUniformBlockParameter\n  getActiveUniformBlockParameter(blockIndex, pname) {\n    return this.gl2.getActiveUniformBlockParameter(this.handle, blockIndex, pname);\n  }\n\n  // Binds a uniform block (`blockIndex`) to a specific binding point (`blockBinding`)\n  uniformBlockBinding(blockIndex, blockBinding) {\n    this.gl2.uniformBlockBinding(this.handle, blockIndex, blockBinding);\n  }\n}\n","import GL from '@luma.gl/constants';\n\n// Define local extension strings to optimize minification\n// const SRGB = 'EXT_sRGB';\n// const EXT_FLOAT_WEBGL1 = 'WEBGL_color_buffer_float';\nconst EXT_FLOAT_WEBGL2 = 'EXT_color_buffer_float';\n// const EXT_HALF_FLOAT_WEBGL1 = 'EXT_color_buffer_half_float';\n\n// NOTE(Tarek): bpp === \"bytes per pixel\", used for\n// memory usage calculations.\nexport default {\n  [GL.DEPTH_COMPONENT16]: {bpp: 2}, // 16 depth bits.\n  [GL.DEPTH_COMPONENT24]: {gl2: true, bpp: 3},\n  [GL.DEPTH_COMPONENT32F]: {gl2: true, bpp: 4},\n\n  [GL.STENCIL_INDEX8]: {bpp: 1}, // 8 stencil bits.\n\n  [GL.DEPTH_STENCIL]: {bpp: 4},\n  [GL.DEPTH24_STENCIL8]: {gl2: true, bpp: 4},\n  [GL.DEPTH32F_STENCIL8]: {gl2: true, bpp: 5},\n\n  // When using a WebGL 1 context, color renderbuffer formats are limited\n  [GL.RGBA4]: {bpp: 2},\n  [GL.RGB565]: {bpp: 2},\n  [GL.RGB5_A1]: {bpp: 2},\n\n  // When using a WebGL 2 context, the following values are available additionally:\n  [GL.R8]: {gl2: true, bpp: 1},\n  [GL.R8UI]: {gl2: true, bpp: 1},\n  [GL.R8I]: {gl2: true, bpp: 1},\n  [GL.R16UI]: {gl2: true, bpp: 2},\n  [GL.R16I]: {gl2: true, bpp: 2},\n  [GL.R32UI]: {gl2: true, bpp: 4},\n  [GL.R32I]: {gl2: true, bpp: 4},\n  [GL.RG8]: {gl2: true, bpp: 2},\n  [GL.RG8UI]: {gl2: true, bpp: 2},\n  [GL.RG8I]: {gl2: true, bpp: 2},\n  [GL.RG16UI]: {gl2: true, bpp: 4},\n  [GL.RG16I]: {gl2: true, bpp: 4},\n  [GL.RG32UI]: {gl2: true, bpp: 8},\n  [GL.RG32I]: {gl2: true, bpp: 8},\n  [GL.RGB8]: {gl2: true, bpp: 3},\n  [GL.RGBA8]: {gl2: true, bpp: 4},\n  // [GL.SRGB8_ALPHA8]: {gl2: true, gl1: SRGB}, // When using the EXT_sRGB WebGL1 extension\n  [GL.RGB10_A2]: {gl2: true, bpp: 4},\n  [GL.RGBA8UI]: {gl2: true, bpp: 4},\n  [GL.RGBA8I]: {gl2: true, bpp: 4},\n  [GL.RGB10_A2UI]: {gl2: true, bpp: 4},\n  [GL.RGBA16UI]: {gl2: true, bpp: 8},\n  [GL.RGBA16I]: {gl2: true, bpp: 8},\n  [GL.RGBA32I]: {gl2: true, bpp: 16},\n  [GL.RGBA32UI]: {gl2: true, bpp: 16},\n\n  // When using a WebGL 2 context and the EXT_color_buffer_float WebGL2 extension\n  [GL.R16F]: {gl2: EXT_FLOAT_WEBGL2, bpp: 2},\n  [GL.RG16F]: {gl2: EXT_FLOAT_WEBGL2, bpp: 4},\n  [GL.RGBA16F]: {gl2: EXT_FLOAT_WEBGL2, bpp: 8},\n  [GL.R32F]: {gl2: EXT_FLOAT_WEBGL2, bpp: 4},\n  [GL.RG32F]: {gl2: EXT_FLOAT_WEBGL2, bpp: 8},\n  // TODO - can't get WEBGL_color_buffer_float to work on renderbuffers\n  [GL.RGBA32F]: {gl2: EXT_FLOAT_WEBGL2, bpp: 16},\n  // [GL.RGBA32F]: {gl2: EXT_FLOAT_WEBGL2, gl1: EXT_FLOAT_WEBGL1},\n  [GL.R11F_G11F_B10F]: {gl2: EXT_FLOAT_WEBGL2, bpp: 4}\n};\n","/* eslint-disable no-inline-comments */\nimport GL from '@luma.gl/constants';\nimport Resource from './resource';\nimport RENDERBUFFER_FORMATS from './renderbuffer-formats';\nimport {isWebGL2} from '@luma.gl/gltools';\nimport {assert} from '../utils/assert';\n\nfunction isFormatSupported(gl, format, formats) {\n  const info = formats[format];\n  if (!info) {\n    return false;\n  }\n  const value = isWebGL2(gl) ? info.gl2 || info.gl1 : info.gl1;\n  if (typeof value === 'string') {\n    return gl.getExtension(value);\n  }\n  return value;\n}\n\nexport default class Renderbuffer extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Renderbuffer';\n  }\n  static isSupported(gl, {format} = {format: null}) {\n    return !format || isFormatSupported(gl, format, RENDERBUFFER_FORMATS);\n  }\n\n  static getSamplesForFormat(gl, {format}) {\n    // Polyfilled to return [0] under WebGL1\n    return gl.getInternalformatParameter(GL.RENDERBUFFER, format, GL.SAMPLES);\n  }\n\n  constructor(gl, opts = {}) {\n    super(gl, opts);\n\n    // @ts-ignore\n    this.initialize(opts);\n\n    Object.seal(this);\n  }\n\n  // Creates and initializes a renderbuffer object's data store\n  initialize({format, width = 1, height = 1, samples = 0}) {\n    assert(format, 'Needs format');\n\n    this._trackDeallocatedMemory();\n\n    this.gl.bindRenderbuffer(GL.RENDERBUFFER, this.handle);\n\n    if (samples !== 0 && isWebGL2(this.gl)) {\n      // @ts-ignore\n      this.gl.renderbufferStorageMultisample(GL.RENDERBUFFER, samples, format, width, height);\n    } else {\n      this.gl.renderbufferStorage(GL.RENDERBUFFER, format, width, height);\n    }\n\n    // this.gl.bindRenderbuffer(GL.RENDERBUFFER, null);\n\n    this.format = format;\n    this.width = width;\n    this.height = height;\n    this.samples = samples;\n\n    this._trackAllocatedMemory(\n      this.width * this.height * (this.samples || 1) * RENDERBUFFER_FORMATS[this.format].bpp\n    );\n\n    return this;\n  }\n\n  resize({width, height}) {\n    // Don't resize if width/height haven't changed\n    if (width !== this.width || height !== this.height) {\n      return this.initialize({width, height, format: this.format, samples: this.samples});\n    }\n    return this;\n  }\n\n  // PRIVATE METHODS\n  _createHandle() {\n    return this.gl.createRenderbuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteRenderbuffer(this.handle);\n    this._trackDeallocatedMemory();\n  }\n\n  _bindHandle(handle) {\n    this.gl.bindRenderbuffer(GL.RENDERBUFFER, handle);\n  }\n\n  _syncHandle(handle) {\n    this.format = this.getParameter(GL.RENDERBUFFER_INTERNAL_FORMAT);\n    this.width = this.getParameter(GL.RENDERBUFFER_WIDTH);\n    this.height = this.getParameter(GL.RENDERBUFFER_HEIGHT);\n    this.samples = this.getParameter(GL.RENDERBUFFER_SAMPLES);\n  }\n\n  // @param {Boolean} opt.autobind=true - method call will bind/unbind object\n  // @returns {GLenum|GLint} - depends on pname\n  _getParameter(pname) {\n    this.gl.bindRenderbuffer(GL.RENDERBUFFER, this.handle);\n    const value = this.gl.getRenderbufferParameter(GL.RENDERBUFFER, pname);\n    // this.gl.bindRenderbuffer(GL.RENDERBUFFER, null);\n    return value;\n  }\n}\n","import {isWebGL2, assertWebGLContext} from '@luma.gl/gltools';\nimport {lumaStats} from '../init';\nimport {getKey, getKeyValue} from '../webgl-utils/constants-to-keys';\nimport {assert} from '../utils/assert';\nimport {uid} from '../utils/utils';\nimport {stubRemovedMethods} from '../utils/stub-methods';\n\nconst ERR_RESOURCE_METHOD_UNDEFINED = 'Resource subclass must define virtual methods';\n\n// TODO - Handle context loss\n// function glGetContextLossCount(gl) {\n//   return (gl.luma && gl.luma.glCount) || 0;\n// }\n\nexport default class Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Resource';\n  }\n  constructor(gl, opts = {}) {\n    assertWebGLContext(gl);\n\n    const {id, userData = {}} = opts;\n    this.gl = gl;\n    // @ts-ignore\n    this.gl2 = gl;\n    // this.ext = polyfillContext(gl);\n    this.id = id || uid(this[Symbol.toStringTag]);\n    this.userData = userData;\n    this._bound = false;\n\n    // Set the handle\n    // If handle was provided, use it, otherwise create a new handle\n\n    // TODO - Stores the handle with context loss information\n    // this.glCount = glGetContextLossCount(this.gl);\n\n    // Default VertexArray needs to be created with null handle, so compare against undefined\n    this._handle = opts.handle;\n    if (this._handle === undefined) {\n      this._handle = this._createHandle();\n    }\n\n    // Only meaningful for resources that allocate GPU memory\n    this.byteLength = 0;\n\n    this._addStats();\n  }\n\n  toString() {\n    return `${this[Symbol.toStringTag] || this.constructor.name}(${this.id})`;\n  }\n\n  get handle() {\n    // TODO - Add context loss handling\n    // Will regenerate and reinitialize the handle if necessary\n    // const glCount = glGetContextLossCount(this.gl);\n    // if (this.glCount !== glCount) {\n    //   this._handle = this._createHandle(this.opts);\n    //   this._glCount = glCount;\n    //   // Reinitialize object\n    //   this.initialize(this.opts);\n    // }\n    return this._handle;\n  }\n\n  delete({deleteChildren = false} = {}) {\n    // Delete this object, and get refs to any children\n    // @ts-ignore\n    const children = this._handle && this._deleteHandle(this._handle);\n    if (this._handle) {\n      this._removeStats();\n    }\n    this._handle = null;\n\n    // Optionally, recursively delete the children\n    // @ts-ignore\n    if (children && deleteChildren) {\n      // @ts-ignore\n      children.filter(Boolean).forEach(child => child.delete());\n    }\n\n    return this;\n  }\n\n  bind(funcOrHandle = this.handle) {\n    if (typeof funcOrHandle !== 'function') {\n      this._bindHandle(funcOrHandle);\n      return this;\n    }\n\n    let value;\n\n    if (!this._bound) {\n      this._bindHandle(this.handle);\n      this._bound = true;\n\n      value = funcOrHandle();\n\n      this._bound = false;\n      this._bindHandle(null);\n    } else {\n      value = funcOrHandle();\n    }\n\n    return value;\n  }\n\n  unbind() {\n    this.bind(null);\n  }\n\n  /**\n   * Query a Resource parameter\n   *\n   * @param {GLenum} pname\n   * @return {GLint|GLfloat|GLenum} param\n   */\n  getParameter(pname, opts = {}) {\n    pname = getKeyValue(this.gl, pname);\n    assert(pname);\n\n    // @ts-ignore\n    const parameters = this.constructor.PARAMETERS || {};\n\n    // Use parameter definitions to handle unsupported parameters\n    const parameter = parameters[pname];\n    if (parameter) {\n      const isWebgl2 = isWebGL2(this.gl);\n\n      // Check if we can query for this parameter\n      const parameterAvailable =\n        (!('webgl2' in parameter) || isWebgl2) &&\n        (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (!parameterAvailable) {\n        const webgl1Default = parameter.webgl1;\n        const webgl2Default = 'webgl2' in parameter ? parameter.webgl2 : parameter.webgl1;\n        const defaultValue = isWebgl2 ? webgl2Default : webgl1Default;\n        return defaultValue;\n      }\n    }\n\n    // If unknown parameter - Could be a valid parameter not covered by PARAMS\n    // Attempt to query for it and let WebGL report errors\n    return this._getParameter(pname, opts);\n  }\n\n  // Many resources support a getParameter call -\n  // getParameters will get all parameters - slow but useful for debugging\n  // eslint-disable-next-line complexity\n  getParameters(options = {}) {\n    const {parameters, keys} = options;\n\n    // Get parameter definitions for this Resource\n    // @ts-ignore\n    const PARAMETERS = this.constructor.PARAMETERS || {};\n\n    const isWebgl2 = isWebGL2(this.gl);\n\n    const values = {};\n\n    // Query all parameters if no list provided\n    const parameterKeys = parameters || Object.keys(PARAMETERS);\n\n    // WEBGL limits\n    for (const pname of parameterKeys) {\n      const parameter = PARAMETERS[pname];\n\n      // Check if this parameter is available on this platform\n      const parameterAvailable =\n        parameter &&\n        (!('webgl2' in parameter) || isWebgl2) &&\n        (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (parameterAvailable) {\n        const key = keys ? getKey(this.gl, pname) : pname;\n        values[key] = this.getParameter(pname, options);\n        if (keys && parameter.type === 'GLenum') {\n          values[key] = getKey(this.gl, values[key]);\n        }\n      }\n    }\n\n    return values;\n  }\n\n  /**\n   * Update a Resource setting\n   *\n   * @todo - cache parameter to avoid issuing WebGL calls?\n   *\n   * @param {string} pname - parameter (GL constant, value or key)\n   * @param {GLint|GLfloat|GLenum} value\n   * @return {Resource} returns self to enable chaining\n   */\n  setParameter(pname, value) {\n    pname = getKeyValue(this.gl, pname);\n    assert(pname);\n\n    // @ts-ignore\n    const parameters = this.constructor.PARAMETERS || {};\n\n    const parameter = parameters[pname];\n    if (parameter) {\n      const isWebgl2 = isWebGL2(this.gl);\n\n      // Check if this parameter is available on this platform\n      const parameterAvailable =\n        (!('webgl2' in parameter) || isWebgl2) &&\n        (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (!parameterAvailable) {\n        throw new Error('Parameter not available on this platform');\n      }\n\n      // Handle string keys\n      if (parameter.type === 'GLenum') {\n        value = getKeyValue(value);\n      }\n    }\n\n    // If unknown parameter - Could be a valid parameter not covered by PARAMS\n    // attempt to set it and let WebGL report errors\n    this._setParameter(pname, value);\n    return this;\n  }\n\n  /*\n   * Batch update resource parameters\n   * Assumes the subclass supports a setParameter call\n   */\n  setParameters(parameters) {\n    for (const pname in parameters) {\n      this.setParameter(pname, parameters[pname]);\n    }\n    return this;\n  }\n\n  // Install stubs for removed methods\n  stubRemovedMethods(className, version, methodNames) {\n    return stubRemovedMethods(this, className, version, methodNames);\n  }\n\n  // PUBLIC VIRTUAL METHODS\n  initialize(opts) {}\n\n  // PROTECTED METHODS - These must be overridden by subclass\n  _createHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _deleteHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _bindHandle(handle) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _getOptsFromHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  /** @returns {number} */\n  _getParameter(pname, opts) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _setParameter(pname, value) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  // PRIVATE METHODS\n\n  _context() {\n    this.gl.luma = this.gl.luma || {};\n    return this.gl.luma;\n  }\n\n  _addStats() {\n    const name = this[Symbol.toStringTag];\n    const stats = lumaStats.get('Resource Counts');\n\n    stats.get('Resources Created').incrementCount();\n    stats.get(`${name}s Created`).incrementCount();\n    stats.get(`${name}s Active`).incrementCount();\n  }\n\n  _removeStats() {\n    const name = this[Symbol.toStringTag];\n    const stats = lumaStats.get('Resource Counts');\n\n    stats.get(`${name}s Active`).decrementCount();\n  }\n\n  /**\n   * Track common allocated memory and memory based on particular gl context.\n   * @param {number} bytes\n   * @param {string} name\n   */\n  _trackAllocatedMemory(bytes, name = this[Symbol.toStringTag]) {\n    this._trackAllocatedMemoryForContext(bytes, name);\n    this._trackAllocatedMemoryForContext(bytes, name, this.gl.canvas && this.gl.canvas.id);\n    this.byteLength = bytes;\n  }\n\n  _trackAllocatedMemoryForContext(bytes, name = this[Symbol.toStringTag], id = '') {\n    const stats = lumaStats.get(`Memory Usage${id}`);\n    stats.get('GPU Memory').addCount(bytes);\n    stats.get(`${name} Memory`).addCount(bytes);\n  }\n\n  /**\n   * Deallocate memory for common statistic and for each gl context as well.\n   * @param {string} name\n   */\n  _trackDeallocatedMemory(name = this[Symbol.toStringTag]) {\n    this._trackDeallocatedMemoryForContext(name);\n    this._trackDeallocatedMemoryForContext(name, this.gl.canvas && this.gl.canvas.id);\n    this.byteLength = 0;\n  }\n\n  _trackDeallocatedMemoryForContext(name = this[Symbol.toStringTag], id = '') {\n    const stats = lumaStats.get(`Memory Usage${id}`);\n\n    stats.get('GPU Memory').subtractCount(this.byteLength);\n    stats.get(`${name} Memory`).subtractCount(this.byteLength);\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {assertWebGLContext, log} from '@luma.gl/gltools';\nimport {parseGLSLCompilerError, getShaderName} from '../glsl-utils';\nimport {assert} from '../utils/assert';\nimport {uid} from '../utils/utils';\nimport Resource from './resource';\n\nconst ERR_SOURCE = 'Shader: GLSL source code must be a JavaScript string';\n\n// For now this is an internal class\nexport class Shader extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Shader';\n  }\n\n  static getTypeName(shaderType) {\n    switch (shaderType) {\n      case GL.VERTEX_SHADER:\n        return 'vertex-shader';\n      case GL.FRAGMENT_SHADER:\n        return 'fragment-shader';\n      default:\n        assert(false);\n        return 'unknown';\n    }\n  }\n\n  /* eslint-disable max-statements */\n  constructor(gl, props) {\n    assertWebGLContext(gl);\n\n    // Validate arguments\n    assert(typeof props.source === 'string', ERR_SOURCE);\n\n    // Deduce an id, from shader source, or supplied id, or shader type\n    const id =\n      getShaderName(props.source, null) ||\n      props.id ||\n      uid(`unnamed ${Shader.getTypeName(props.shaderType)}`);\n\n    super(gl, {id});\n\n    this.shaderType = props.shaderType;\n    this.source = props.source;\n\n    this.initialize(props);\n  }\n\n  initialize({source}) {\n    const shaderName = getShaderName(source, null);\n    if (shaderName) {\n      this.id = uid(shaderName);\n    }\n    this._compile(source);\n  }\n\n  // Accessors\n\n  getParameter(pname) {\n    return this.gl.getShaderParameter(this.handle, pname);\n  }\n\n  toString() {\n    return `${Shader.getTypeName(this.shaderType)}:${this.id}`;\n  }\n\n  getName() {\n    return getShaderName(this.source) || 'unnamed-shader';\n  }\n\n  getSource() {\n    return this.gl.getShaderSource(this.handle);\n  }\n\n  // Debug method - Returns translated source if available\n  getTranslatedSource() {\n    const extension = this.gl.getExtension('WEBGL_debug_shaders');\n    return extension\n      ? extension.getTranslatedShaderSource(this.handle)\n      : 'No translated source available. WEBGL_debug_shaders not implemented';\n  }\n\n  // PRIVATE METHODS\n  _compile(source = this.source) {\n    if (!source.startsWith('#version ')) {\n      source = `#version 100\\n${source}`;\n    }\n    this.source = source;\n    this.gl.shaderSource(this.handle, this.source);\n    this.gl.compileShader(this.handle);\n\n    // TODO - For performance reasons, avoid checking shader compilation errors on production?\n    // TODO - Load log even when no error reported, to catch warnings?\n    // https://gamedev.stackexchange.com/questions/30429/how-to-detect-glsl-warnings\n    const compileStatus = this.getParameter(GL.COMPILE_STATUS);\n    if (!compileStatus) {\n      const infoLog = this.gl.getShaderInfoLog(this.handle);\n      const {shaderName, errors, warnings} = parseGLSLCompilerError(\n        infoLog,\n        this.source,\n        this.shaderType,\n        this.id\n      );\n      log.error(`GLSL compilation errors in ${shaderName}\\n${errors}`)();\n      log.warn(`GLSL compilation warnings in ${shaderName}\\n${warnings}`)();\n      throw new Error(`GLSL compilation errors in ${shaderName}`);\n    }\n  }\n\n  _deleteHandle() {\n    this.gl.deleteShader(this.handle);\n  }\n\n  _getOptsFromHandle() {\n    return {\n      type: this.getParameter(GL.SHADER_TYPE),\n      source: this.getSource()\n    };\n  }\n}\n\nexport class VertexShader extends Shader {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'VertexShader';\n  }\n\n  constructor(gl, props) {\n    // Signature: new VertexShader(gl, source)\n    if (typeof props === 'string') {\n      props = {source: props};\n    }\n    super(gl, Object.assign({}, props, {shaderType: GL.VERTEX_SHADER}));\n  }\n\n  // PRIVATE METHODS\n  _createHandle() {\n    return this.gl.createShader(GL.VERTEX_SHADER);\n  }\n}\n\nexport class FragmentShader extends Shader {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'FragmentShader';\n  }\n  constructor(gl, props) {\n    // Signature: new FragmentShader(gl, source)\n    if (typeof props === 'string') {\n      props = {source: props};\n    }\n\n    super(gl, Object.assign({}, props, {shaderType: GL.FRAGMENT_SHADER}));\n  }\n\n  // PRIVATE METHODS\n  _createHandle() {\n    return this.gl.createShader(GL.FRAGMENT_SHADER);\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {assertWebGLContext} from '@luma.gl/gltools';\nimport Texture from './texture';\nimport {loadImage} from '../utils/load-file';\n\nexport default class Texture2D extends Texture {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Texture2D';\n  }\n\n  static isSupported(gl, opts) {\n    return Texture.isSupported(gl, opts);\n  }\n\n  constructor(gl, props = {}) {\n    assertWebGLContext(gl);\n\n    // Signature: new Texture2D(gl, url | Promise)\n    if (props instanceof Promise || typeof props === 'string') {\n      props = {data: props};\n    }\n\n    // Signature: new Texture2D(gl, {data: url})\n    if (typeof props.data === 'string') {\n      props = Object.assign({}, props, {data: loadImage(props.data)});\n    }\n\n    super(gl, Object.assign({}, props, {target: GL.TEXTURE_2D}));\n\n    this.initialize(props);\n\n    Object.seal(this);\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {isWebGL2, assertWebGL2Context, withParameters} from '@luma.gl/gltools';\nimport Texture from './texture';\nimport {DATA_FORMAT_CHANNELS, TYPE_SIZES} from './texture-formats';\nimport Buffer from './buffer';\n\nexport default class Texture3D extends Texture {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Texture3D';\n  }\n\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  constructor(gl, props = {}) {\n    assertWebGL2Context(gl);\n    props = Object.assign({depth: 1}, props, {target: GL.TEXTURE_3D, unpackFlipY: false});\n    super(gl, props);\n    this.initialize(props);\n\n    Object.seal(this);\n  }\n\n  // Image 3D copies from Typed Array or WebGLBuffer\n  setImageData({\n    level = 0,\n    dataFormat = GL.RGBA,\n    width,\n    height,\n    depth = 1,\n    border = 0,\n    format,\n    type = GL.UNSIGNED_BYTE,\n    offset = 0,\n    data,\n    parameters = {}\n  }) {\n    this._trackDeallocatedMemory('Texture');\n\n    this.gl.bindTexture(this.target, this.handle);\n\n    withParameters(this.gl, parameters, () => {\n      if (ArrayBuffer.isView(data)) {\n        // @ts-ignore\n        this.gl.texImage3D(\n          this.target,\n          level,\n          dataFormat,\n          width,\n          height,\n          depth,\n          border,\n          format,\n          type,\n          data\n        );\n      }\n\n      if (data instanceof Buffer) {\n        this.gl.bindBuffer(GL.PIXEL_UNPACK_BUFFER, data.handle);\n        // @ts-ignore\n        this.gl.texImage3D(\n          this.target,\n          level,\n          dataFormat,\n          width,\n          height,\n          depth,\n          border,\n          format,\n          type,\n          offset\n        );\n      }\n    });\n\n    if (data && data.byteLength) {\n      this._trackAllocatedMemory(data.byteLength, 'Texture');\n    } else {\n      // NOTE(Tarek): Default to RGBA bytes\n      // @ts-ignore\n      const channels = DATA_FORMAT_CHANNELS[this.dataFormat] || 4;\n      // @ts-ignore\n      const channelSize = TYPE_SIZES[this.type] || 1;\n\n      this._trackAllocatedMemory(\n        this.width * this.height * this.depth * channels * channelSize,\n        'Texture'\n      );\n    }\n\n    this.loaded = true;\n\n    return this;\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {log, assertWebGLContext} from '@luma.gl/gltools';\nimport Texture from './texture';\n\nconst FACES = [\n  GL.TEXTURE_CUBE_MAP_POSITIVE_X,\n  GL.TEXTURE_CUBE_MAP_NEGATIVE_X,\n  GL.TEXTURE_CUBE_MAP_POSITIVE_Y,\n  GL.TEXTURE_CUBE_MAP_NEGATIVE_Y,\n  GL.TEXTURE_CUBE_MAP_POSITIVE_Z,\n  GL.TEXTURE_CUBE_MAP_NEGATIVE_Z\n];\n\nexport default class TextureCube extends Texture {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'TextureCube';\n  }\n\n  constructor(gl, props = {}) {\n    assertWebGLContext(gl);\n\n    super(gl, Object.assign({}, props, {target: GL.TEXTURE_CUBE_MAP}));\n\n    this.initialize(props);\n\n    Object.seal(this);\n  }\n\n  initialize(props = {}) {\n    const {mipmaps = true, parameters = {}} = props;\n\n    // Store props for accessors\n    this.opts = props;\n\n    // @ts-ignore\n    this.setCubeMapImageData(props).then(() => {\n      this.loaded = true;\n\n      // TODO - should genMipmap() be called on the cubemap or on the faces?\n      // TODO - without generateMipmap() cube textures do not work at all!!! Why?\n      if (mipmaps) {\n        this.generateMipmap(props);\n      }\n\n      this.setParameters(parameters);\n    });\n    return this;\n  }\n\n  subImage({face, data, x = 0, y = 0, mipmapLevel = 0}) {\n    // @ts-ignore TODO - is this a bug?\n    return this._subImage({target: face, data, x, y, mipmapLevel});\n  }\n\n  /* eslint-disable max-statements, max-len */\n  async setCubeMapImageData({\n    width,\n    height,\n    pixels,\n    data,\n    border = 0,\n    format = GL.RGBA,\n    type = GL.UNSIGNED_BYTE\n  }) {\n    const {gl} = this;\n    const imageDataMap = pixels || data;\n\n    // pixel data (imageDataMap) is an Object from Face to Image or Promise.\n    // For example:\n    // {\n    // GL.TEXTURE_CUBE_MAP_POSITIVE_X : Image-or-Promise,\n    // GL.TEXTURE_CUBE_MAP_NEGATIVE_X : Image-or-Promise,\n    // ... }\n    // To provide multiple level-of-details (LODs) this can be Face to Array\n    // of Image or Promise, like this\n    // {\n    // GL.TEXTURE_CUBE_MAP_POSITIVE_X : [Image-or-Promise-LOD-0, Image-or-Promise-LOD-1],\n    // GL.TEXTURE_CUBE_MAP_NEGATIVE_X : [Image-or-Promise-LOD-0, Image-or-Promise-LOD-1],\n    // ... }\n\n    const resolvedFaces = await Promise.all(\n      FACES.map(face => {\n        const facePixels = imageDataMap[face];\n        return Promise.all(Array.isArray(facePixels) ? facePixels : [facePixels]);\n      })\n    );\n\n    this.bind();\n\n    FACES.forEach((face, index) => {\n      if (resolvedFaces[index].length > 1 && this.opts.mipmaps !== false) {\n        // If the user provides multiple LODs, then automatic mipmap\n        // generation generateMipmap() should be disabled to avoid overwritting them.\n        log.warn(`${this.id} has mipmap and multiple LODs.`)();\n      }\n      resolvedFaces[index].forEach((image, lodLevel) => {\n        // TODO: adjust width & height for LOD!\n        if (width && height) {\n          gl.texImage2D(face, lodLevel, format, width, height, border, format, type, image);\n        } else {\n          gl.texImage2D(face, lodLevel, format, format, type, image);\n        }\n      });\n    });\n\n    this.unbind();\n  }\n\n  // TODO: update this method to accept LODs\n  setImageDataForFace(options) {\n    const {\n      face,\n      width,\n      height,\n      pixels,\n      data,\n      border = 0,\n      format = GL.RGBA,\n      type = GL.UNSIGNED_BYTE\n      // generateMipmap = false // TODO\n    } = options;\n\n    const {gl} = this;\n\n    const imageData = pixels || data;\n\n    this.bind();\n    if (imageData instanceof Promise) {\n      imageData.then(resolvedImageData =>\n        this.setImageDataForFace(\n          Object.assign({}, options, {\n            face,\n            data: resolvedImageData,\n            pixels: resolvedImageData\n          })\n        )\n      );\n    } else if (this.width || this.height) {\n      gl.texImage2D(face, 0, format, width, height, border, format, type, imageData);\n    } else {\n      gl.texImage2D(face, 0, format, format, type, imageData);\n    }\n\n    return this;\n  }\n}\n\nTextureCube.FACES = FACES;\n","import GL from '@luma.gl/constants';\nimport {isWebGL2} from '@luma.gl/gltools';\n\n// const S3TC = 'WEBGL_compressed_texture_s3tc';\n// const PVRTC = 'WEBGL_compressed_texture_pvrtc';\n// const ES3 = 'WEBGL_compressed_texture_es3';\n// const ETC1 = 'WEBGL_compressed_texture_etc1';\n// const SRGB = 'EXT_sRGB';\n// const DEPTH = 'WEBGL_depth_texture';\n\n// Legal combinations for internalFormat, format and type\nexport const TEXTURE_FORMATS = {\n  // Unsized texture format - more performance\n  [GL.RGB]: {dataFormat: GL.RGB, types: [GL.UNSIGNED_BYTE, GL.UNSIGNED_SHORT_5_6_5]},\n  // TODO: format: GL.RGBA type: GL.FLOAT is supported in WebGL1 when 'OES_texure_float' is suported\n  // we need to update this table structure to specify extensions (gl1: 'OES_texure_float', gl2: false) for each type.\n  [GL.RGBA]: {\n    dataFormat: GL.RGBA,\n    types: [GL.UNSIGNED_BYTE, GL.UNSIGNED_SHORT_4_4_4_4, GL.UNSIGNED_SHORT_5_5_5_1]\n  },\n  [GL.ALPHA]: {dataFormat: GL.ALPHA, types: [GL.UNSIGNED_BYTE]},\n  [GL.LUMINANCE]: {dataFormat: GL.LUMINANCE, types: [GL.UNSIGNED_BYTE]},\n  [GL.LUMINANCE_ALPHA]: {dataFormat: GL.LUMINANCE_ALPHA, types: [GL.UNSIGNED_BYTE]},\n\n  // 32 bit floats\n  [GL.R32F]: {dataFormat: GL.RED, types: [GL.FLOAT], gl2: true},\n  [GL.RG32F]: {dataFormat: GL.RG, types: [GL.FLOAT], gl2: true},\n  [GL.RGB32F]: {dataFormat: GL.RGB, types: [GL.FLOAT], gl2: true},\n  [GL.RGBA32F]: {dataFormat: GL.RGBA, types: [GL.FLOAT], gl2: true}\n\n  // [GL.DEPTH_COMPONENT]: {types: [GL.UNSIGNED_SHORT, GL.UNSIGNED_INT, GL.UNSIGNED_INT_24_8], gl1: DEPTH},\n  // [GL.DEPTH_STENCIL]: {gl1: DEPTH},\n\n  // Sized texture format - more performance\n  // R\n  // [GL.R8]: {dataFormat: GL.RED, types: [GL.UNSIGNED_BYTE], gl2: true},\n  // [GL.R16F]: {dataFormat: GL.RED, types: [GL.HALF_FLOAT, GL.FLOAT], gl2: true},\n  // [GL.R8UI]: {dataFormat: GL.RED_INTEGER, types: [GL.UNSIGNED_BYTE], gl2: true},\n  // // RG\n  // [GL.RG8]: {dataFormat: GL.RG, types: [GL.UNSIGNED_BYTE], gl2: true},\n  // [GL.RG16F]: {dataFormat: GL.RG, types: [GL.HALF_FLOAT, GL.FLOAT], gl2: true},\n  // [GL.RG8UI]: {dataFormat: GL.RG_INTEGER, types: [GL.UNSIGNED_BYTE], gl2: true},\n  // // RGB\n  // [GL.RGB8]: {dataFormat: GL.RGB, types: [GL.UNSIGNED_BYTE], gl2: true, gl1: SRGB},\n  // [GL.SRGB8]: {dataFormat: GL.RGB, types: [GL.UNSIGNED_BYTE], gl2: true, gl1: SRGB},\n  // [GL.RGB565]: {dataFormat: GL.RGB, types: [GL.UNSIGNED_BYTE, GL.UNSIGNED_SHORT_5_6_5], gl2: true},\n  // [GL.R11F_G11F_B10F]: {dataFormat: GL.RGB, types: [GL.UNSIGNED_INT_10F_11F_11F_REV, GL.HALF_FLOAT, GL.FLOAT], gl2: true},\n  // [GL.RGB9_E5]: {dataFormat: GL.RGB, types: [GL.HALF_FLOAT, GL.FLOAT], gl2: true, gl1: 'WEBGL_color_buffer_half_float'},\n  // [GL.RGB16F]: {dataFormat: GL.RGB, types: [GL.HALF_FLOAT, GL.FLOAT], gl2: true, gl1: 'WEBGL_color_buffer_float'},\n  // [GL.RGB8UI]: {dataFormat: GL.RGB_INTEGER, types: [GL.UNSIGNED_BYTE], gl2: true},\n  // // RGBA\n  // [GL.RGBA8]: {dataFormat: GL.RGBA, types: [GL.UNSIGNED_BYTE], gl2: true, gl1: SRGB},\n  // [GL.SRGB8_ALPHA8]: {dataFormat: GL.RGBA, types: [GL.UNSIGNED_BYTE], gl2: true, gl1: SRGB},\n  // [GL.RGB5_A1]: {dataFormat: GL.RGBA, types: [GL.UNSIGNED_BYTE, GL.UNSIGNED_SHORT_5_5_5_1], gl2: true},\n  // [GL.RGBA4]: {dataFormat: GL.RGBA, types: [GL.UNSIGNED_BYTE, GL.UNSIGNED_SHORT_4_4_4_4], gl2: true},\n  // [GL.RGBA16F]: {dataFormat: GL.RGBA, types: [GL.HALF_FLOAT, GL.FLOAT], gl2: true},\n  // [GL.RGBA8UI]: {dataFormat: GL.RGBA_INTEGER, types: [GL.UNSIGNED_BYTE], gl2: true}\n\n  // Compressed formats\n\n  // WEBGL_compressed_texture_s3tc\n\n  // [GL.COMPRESSED_RGB_S3TC_DXT1_EXT]: {compressed: true, gl1: S3TC},\n  // [GL.COMPRESSED_RGBA_S3TC_DXT1_EXT]: {compressed: true, gl1: S3TC},\n  // [GL.COMPRESSED_RGBA_S3TC_DXT3_EXT]: {compressed: true, gl1: S3TC},\n  // [GL.COMPRESSED_RGBA_S3TC_DXT5_EXT]: {compressed: true, gl1: S3TC},\n\n  // WEBGL_compressed_texture_es3\n\n  // [GL.COMPRESSED_R11_EAC]: {compressed: true, gl1: ES3}, // RED\n  // [GL.COMPRESSED_SIGNED_R11_EAC]: {compressed: true, gl1: ES3}, // RED\n  // [GL.COMPRESSED_RG11_EAC]: {compressed: true, gl1: ES3}, // RG\n  // [GL.COMPRESSED_SIGNED_RG11_EAC]: {compressed: true, gl1: ES3}, // RG\n  // [GL.COMPRESSED_RGB8_ETC2]: {compressed: true, gl1: ES3}, // RGB\n  // [GL.COMPRESSED_RGBA8_ETC2_EAC]: {compressed: true, gl1: ES3}, // RBG\n  // [GL.COMPRESSED_SRGB8_ETC2]: {compressed: true, gl1: ES3}, // RGB\n  // [GL.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]: {compressed: true, gl1: ES3}, // RGBA\n  // [GL.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]: {compressed: true, gl1: ES3}, // RGBA\n  // [GL.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]: {compressed: true, gl1: ES3}, // RGBA\n  /* WebGL2 guaranteed availability compressed formats?\n  COMPRESSED_R11_EAC RED\n  COMPRESSED_SIGNED_R11_EAC RED\n  COMPRESSED_RG11_EAC RG\n  COMPRESSED_SIGNED_RG11_EAC RG\n  COMPRESSED_RGB8_ETC2 RGB\n  COMPRESSED_SRGB8_ETC2 RGB\n  COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2 RGBA\n  COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2 RGBA\n  COMPRESSED_RGBA8_ETC2_EAC RGBA\n  COMPRESSED_SRGB8_ALPHA8_ETC2_EAC\n  */\n\n  // WEBGL_compressed_texture_pvrtc\n\n  // [GL.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]: {compressed: true, gl1: PVRTC},\n  // [GL.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]: {compressed: true, gl1: PVRTC},\n  // [GL.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]: {compressed: true, gl1: PVRTC},\n  // [GL.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]: {compressed: true, gl1: PVRTC},\n\n  // WEBGL_compressed_texture_etc1\n\n  // [GL.COMPRESSED_RGB_ETC1_WEBGL]: {compressed: true, gl1: ETC1},\n\n  // WEBGL_compressed_texture_atc\n\n  // [GL.COMPRESSED_RGB_ATC_WEBGL]: {compressed: true, gl1: ETC1},\n  // [GL.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]: {compressed: true, gl1: ETC1},\n  // [GL.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]: {compressed: true, gl1: ETC1}\n};\n\nexport const DATA_FORMAT_CHANNELS = {\n  [GL.RED]: 1,\n  [GL.RED_INTEGER]: 1,\n  [GL.RG]: 2,\n  [GL.RG_INTEGER]: 2,\n  [GL.RGB]: 3,\n  [GL.RGB_INTEGER]: 3,\n  [GL.RGBA]: 4,\n  [GL.RGBA_INTEGER]: 4,\n  [GL.DEPTH_COMPONENT]: 1,\n  [GL.DEPTH_STENCIL]: 1,\n  [GL.ALPHA]: 1,\n  [GL.LUMINANCE]: 1,\n  [GL.LUMINANCE_ALPHA]: 2\n};\n\nexport const TYPE_SIZES = {\n  [GL.FLOAT]: 4,\n  [GL.UNSIGNED_INT]: 4,\n  [GL.INT]: 4,\n  [GL.UNSIGNED_SHORT]: 2,\n  [GL.SHORT]: 2,\n  [GL.HALF_FLOAT]: 2,\n  [GL.BYTE]: 1,\n  [GL.UNSIGNED_BYTE]: 1\n};\n\nexport function isFormatSupported(gl, format) {\n  const info = TEXTURE_FORMATS[format];\n  if (!info) {\n    return false;\n  }\n  if (info.gl1 === undefined && info.gl2 === undefined) {\n    // No info - always supported\n    return true;\n  }\n  const value = isWebGL2(gl) ? info.gl2 || info.gl1 : info.gl1;\n  return typeof value === 'string' ? gl.getExtension(value) : value;\n}\n\nexport function isLinearFilteringSupported(gl, format) {\n  const info = TEXTURE_FORMATS[format];\n  switch (info && info.types[0]) {\n    // Both WebGL1 and WebGL2?\n    case GL.FLOAT:\n      return gl.getExtension('OES_texture_float_linear');\n    // Not in WebGL2?\n    case GL.HALF_FLOAT:\n      return gl.getExtension('OES_texture_half_float_linear');\n    default:\n      return true;\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {isWebGL2, assertWebGL2Context, withParameters, log} from '@luma.gl/gltools';\n\nimport Resource from './resource';\nimport Buffer from './buffer';\nimport {\n  TEXTURE_FORMATS,\n  DATA_FORMAT_CHANNELS,\n  TYPE_SIZES,\n  isFormatSupported,\n  isLinearFilteringSupported\n} from './texture-formats';\nimport {assert} from '../utils/assert';\nimport {uid, isPowerOfTwo} from '../utils/utils';\n\n// Supported min filters for NPOT texture.\nconst NPOT_MIN_FILTERS = [GL.LINEAR, GL.NEAREST];\n\n// Polyfill\n// Note (Tarek): Do we really need to support this API?\nconst WebGLBuffer = globalThis.WebGLBuffer || function WebGLBuffer() {};\n\nexport default class Texture extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'Texture';\n  }\n  static isSupported(gl, opts = {}) {\n    const {format, linearFiltering} = opts;\n    let supported = true;\n    if (format) {\n      supported = supported && isFormatSupported(gl, format);\n      supported = supported && (!linearFiltering || isLinearFilteringSupported(gl, format));\n    }\n    return supported;\n  }\n\n  // target cannot be modified by bind:\n  // textures are special because when you first bind them to a target,\n  // they get special information. When you first bind a texture as a\n  // GL_TEXTURE_2D, you are actually setting special state in the texture.\n  // You are saying that this texture is a 2D texture.\n  // And it will always be a 2D texture; this state cannot be changed ever.\n  // If you have a texture that was first bound as a GL_TEXTURE_2D,\n  // you must always bind it as a GL_TEXTURE_2D;\n  // attempting to bind it as GL_TEXTURE_1D will give rise to an error\n  // (while run-time).\n  constructor(gl, props) {\n    const {\n      id = uid('texture'),\n      handle,\n      target\n      // , magFilter, minFilter, wrapS, wrapT\n    } = props;\n\n    super(gl, {id, handle});\n\n    this.target = target;\n    this.textureUnit = undefined;\n\n    // Program.draw() checks the loaded flag of all textures to avoid\n    // Textures that are still loading from promises\n    // Set to true as soon as texture has been initialized with valid data\n    this.loaded = false;\n\n    this.width = undefined;\n    this.height = undefined;\n    this.depth = undefined;\n    this.format = undefined;\n    this.type = undefined;\n    this.dataFormat = undefined;\n    this.border = undefined;\n    this.textureUnit = undefined;\n    this.mipmaps = undefined;\n  }\n\n  toString() {\n    return `Texture(${this.id},${this.width}x${this.height})`;\n  }\n\n  /* eslint-disable max-len, max-statements */\n  initialize(props = {}) {\n    let data = props.data;\n\n    if (data instanceof Promise) {\n      data.then(resolvedImageData =>\n        this.initialize(\n          Object.assign({}, props, {\n            pixels: resolvedImageData,\n            data: resolvedImageData\n          })\n        )\n      );\n      return this;\n    }\n    const isVideo = typeof HTMLVideoElement !== 'undefined' && data instanceof HTMLVideoElement;\n    // @ts-ignore\n    if (isVideo && data.readyState < HTMLVideoElement.HAVE_METADATA) {\n      this._video = null; // Declare member before the object is sealed\n      data.addEventListener('loadeddata', () => this.initialize(props));\n      return this;\n    }\n\n    const {\n      pixels = null,\n      format = GL.RGBA,\n      border = 0,\n      recreate = false,\n      parameters = {},\n      pixelStore = {},\n      textureUnit = undefined\n    } = props;\n\n    // pixels variable is for API compatibility purpose\n    if (!data) {\n      // TODO - This looks backwards? Commenting out for now until we decide\n      // which prop to use\n      // log.deprecated('data', 'pixels')();\n      data = pixels;\n    }\n\n    let {width, height, dataFormat, type, compressed = false, mipmaps = true} = props;\n    const {depth = 0} = props;\n\n    // Deduce width and height\n    ({width, height, compressed, dataFormat, type} = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n\n    // Store opts for accessors\n    this.width = width;\n    this.height = height;\n    this.depth = depth;\n    this.format = format;\n    this.type = type;\n    this.dataFormat = dataFormat;\n    this.border = border;\n    this.textureUnit = textureUnit;\n\n    if (Number.isFinite(this.textureUnit)) {\n      this.gl.activeTexture(GL.TEXTURE0 + this.textureUnit);\n      this.gl.bindTexture(this.target, this.handle);\n    }\n\n    if (mipmaps && this._isNPOT()) {\n      log.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)();\n      mipmaps = false;\n\n      this._updateForNPOT(parameters);\n    }\n\n    this.mipmaps = mipmaps;\n\n    this.setImageData({\n      data,\n      width,\n      height,\n      depth,\n      format,\n      type,\n      dataFormat,\n      border,\n      mipmaps,\n      parameters: pixelStore,\n      compressed\n    });\n\n    if (mipmaps) {\n      this.generateMipmap();\n    }\n\n    // Set texture sampler parameters\n    this.setParameters(parameters);\n\n    // TODO - Store data to enable auto recreate on context loss\n    if (recreate) {\n      this.data = data;\n    }\n    if (isVideo) {\n      this._video = {\n        video: data,\n        parameters,\n        // @ts-ignore\n        lastTime: data.readyState >= HTMLVideoElement.HAVE_CURRENT_DATA ? data.currentTime : -1\n      };\n    }\n\n    return this;\n  }\n\n  update() {\n    if (this._video) {\n      const {video, parameters, lastTime} = this._video;\n      // @ts-ignore\n      if (lastTime === video.currentTime || video.readyState < HTMLVideoElement.HAVE_CURRENT_DATA) {\n        return;\n      }\n      this.setSubImageData({\n        data: video,\n        parameters\n      });\n      if (this.mipmaps) {\n        this.generateMipmap();\n      }\n      this._video.lastTime = video.currentTime;\n    }\n  }\n\n  // If size has changed, reinitializes with current format\n  // note clears image and mipmaps\n  resize({height, width, mipmaps = false}) {\n    if (width !== this.width || height !== this.height) {\n      return this.initialize({\n        width,\n        height,\n        format: this.format,\n        type: this.type,\n        dataFormat: this.dataFormat,\n        border: this.border,\n        mipmaps\n      });\n    }\n    return this;\n  }\n\n  // Call to regenerate mipmaps after modifying texture(s)\n  generateMipmap(params = {}) {\n    if (this._isNPOT()) {\n      log.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)();\n      return this;\n    }\n\n    this.mipmaps = true;\n\n    this.gl.bindTexture(this.target, this.handle);\n    withParameters(this.gl, params, () => {\n      this.gl.generateMipmap(this.target);\n    });\n    this.gl.bindTexture(this.target, null);\n    return this;\n  }\n\n  /*\n   * Allocates storage\n   * @param {*} pixels -\n   *  null - create empty texture of specified format\n   *  Typed array - init from image data in typed array\n   *  Buffer|WebGLBuffer - (WEBGL2) init from image data in WebGLBuffer\n   *  HTMLImageElement|Image - Inits with content of image. Auto width/height\n   *  HTMLCanvasElement - Inits with contents of canvas. Auto width/height\n   *  HTMLVideoElement - Creates video texture. Auto width/height\n   *\n   * @param {GLint} width -\n   * @param {GLint} height -\n   * @param {GLint} mipMapLevel -\n   * @param {GLenum} format - format of image data.\n   * @param {GLenum} type\n   *  - format of array (autodetect from type) or\n   *  - (WEBGL2) format of buffer\n   * @param {Number} offset - (WEBGL2) offset from start of buffer\n   * @param {GLint} border - must be 0.\n   * @parameters - temporary settings to be applied, can be used to supply pixel store settings.\n   */\n  /* eslint-disable max-len, max-statements, complexity */\n  setImageData(options) {\n    this._trackDeallocatedMemory('Texture');\n\n    const {\n      target = this.target,\n      pixels = null,\n      level = 0,\n      format = this.format,\n      border = this.border,\n      offset = 0,\n      parameters = {}\n    } = options;\n\n    let {\n      data = null,\n      type = this.type,\n      width = this.width,\n      height = this.height,\n      dataFormat = this.dataFormat,\n      compressed = false\n    } = options;\n\n    // pixels variable is  for API compatibility purpose\n    if (!data) {\n      data = pixels;\n    }\n\n    ({type, dataFormat, compressed, width, height} = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n\n    const {gl} = this;\n    gl.bindTexture(this.target, this.handle);\n\n    let dataType = null;\n    ({data, dataType} = this._getDataType({data, compressed}));\n\n    let gl2;\n\n    let compressedTextureSize = 0;\n\n    withParameters(this.gl, parameters, () => {\n      switch (dataType) {\n        case 'null':\n          gl.texImage2D(target, level, format, width, height, border, dataFormat, type, data);\n          break;\n        case 'typed-array':\n          // Looks like this assert is not necessary, as offset is ignored under WebGL1\n          // assert((offset === 0 || isWebGL2(gl)), 'offset supported in WebGL2 only');\n          // @ts-ignore\n          gl.texImage2D(\n            target,\n            level,\n            format,\n            width,\n            height,\n            border,\n            dataFormat,\n            type,\n            data,\n            // @ts-ignore\n            offset\n          );\n          break;\n        case 'buffer':\n          // WebGL2 enables creating textures directly from a WebGL buffer\n          gl2 = assertWebGL2Context(gl);\n          gl2.bindBuffer(GL.PIXEL_UNPACK_BUFFER, data.handle || data);\n          gl2.texImage2D(target, level, format, width, height, border, dataFormat, type, offset);\n          gl2.bindBuffer(GL.PIXEL_UNPACK_BUFFER, null);\n          break;\n        case 'browser-object':\n          if (isWebGL2(gl)) {\n            gl.texImage2D(target, level, format, width, height, border, dataFormat, type, data);\n          } else {\n            gl.texImage2D(target, level, format, dataFormat, type, data);\n          }\n          break;\n        case 'compressed':\n          for (const [levelIndex, levelData] of data.entries()) {\n            gl.compressedTexImage2D(\n              target,\n              levelIndex,\n              levelData.format,\n              levelData.width,\n              levelData.height,\n              border,\n              levelData.data\n            );\n            compressedTextureSize += levelData.levelSize;\n          }\n          break;\n        default:\n          assert(false, 'Unknown image data type');\n      }\n    });\n\n    if (dataType === 'compressed') {\n      this._trackAllocatedMemory(compressedTextureSize, 'Texture');\n    } else if (data && data.byteLength) {\n      this._trackAllocatedMemory(data.byteLength, 'Texture');\n    } else {\n      // NOTE(Tarek): Default to RGBA bytes\n      const channels = DATA_FORMAT_CHANNELS[this.dataFormat] || 4;\n      const channelSize = TYPE_SIZES[this.type] || 1;\n\n      this._trackAllocatedMemory(this.width * this.height * channels * channelSize, 'Texture');\n    }\n\n    this.loaded = true;\n\n    return this;\n  }\n  /* eslint-enable max-len, max-statements, complexity */\n\n  /**\n   * Redefines an area of an existing texture\n   * Note: does not allocate storage\n   */\n  /*\n   * Redefines an area of an existing texture\n   * @param {*} pixels, data -\n   *  null - create empty texture of specified format\n   *  Typed array - init from image data in typed array\n   *  Buffer|WebGLBuffer - (WEBGL2) init from image data in WebGLBuffer\n   *  HTMLImageElement|Image - Inits with content of image. Auto width/height\n   *  HTMLCanvasElement - Inits with contents of canvas. Auto width/height\n   *  HTMLVideoElement - Creates video texture. Auto width/height\n   *\n   * @param {GLint} x - xOffset from where texture to be updated\n   * @param {GLint} y - yOffset from where texture to be updated\n   * @param {GLint} width - width of the sub image to be updated\n   * @param {GLint} height - height of the sub image to be updated\n   * @param {GLint} level - mip level to be updated\n   * @param {GLenum} format - internal format of image data.\n   * @param {GLenum} type\n   *  - format of array (autodetect from type) or\n   *  - (WEBGL2) format of buffer or ArrayBufferView\n   * @param {GLenum} dataFormat - format of image data.\n   * @param {Number} offset - (WEBGL2) offset from start of buffer\n   * @param {GLint} border - must be 0.\n   * @parameters - temporary settings to be applied, can be used to supply pixel store settings.\n   */\n  setSubImageData({\n    target = this.target,\n    pixels = null,\n    data = null,\n    x = 0,\n    y = 0,\n    width = this.width,\n    height = this.height,\n    level = 0,\n    format = this.format,\n    type = this.type,\n    dataFormat = this.dataFormat,\n    compressed = false,\n    offset = 0,\n    border = this.border,\n    parameters = {}\n  }) {\n    ({type, dataFormat, compressed, width, height} = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n\n    assert(this.depth === 0, 'texSubImage not supported for 3D textures');\n\n    // pixels variable is  for API compatibility purpose\n    if (!data) {\n      data = pixels;\n    }\n\n    // Support ndarrays\n    if (data && data.data) {\n      const ndarray = data;\n      data = ndarray.data;\n      width = ndarray.shape[0];\n      height = ndarray.shape[1];\n    }\n\n    // Support buffers\n    if (data instanceof Buffer) {\n      data = data.handle;\n    }\n\n    this.gl.bindTexture(this.target, this.handle);\n\n    withParameters(this.gl, parameters, () => {\n      // TODO - x,y parameters\n      if (compressed) {\n        this.gl.compressedTexSubImage2D(target, level, x, y, width, height, format, data);\n      } else if (data === null) {\n        this.gl.texSubImage2D(target, level, x, y, width, height, dataFormat, type, null);\n      } else if (ArrayBuffer.isView(data)) {\n        // const gl2 = assertWebGL2Context(this.gl);\n        // @ts-ignore last offset parameter is ignored under WebGL1\n        this.gl.texSubImage2D(target, level, x, y, width, height, dataFormat, type, data, offset);\n      } else if (data instanceof WebGLBuffer) {\n        // WebGL2 allows us to create texture directly from a WebGL buffer\n        const gl2 = assertWebGL2Context(this.gl);\n        // This texImage2D signature uses currently bound GL.PIXEL_UNPACK_BUFFER\n        gl2.bindBuffer(GL.PIXEL_UNPACK_BUFFER, data);\n        gl2.texSubImage2D(target, level, x, y, width, height, dataFormat, type, offset);\n        gl2.bindBuffer(GL.PIXEL_UNPACK_BUFFER, null);\n      } else if (isWebGL2(this.gl)) {\n        // Assume data is a browser supported object (ImageData, Canvas, ...)\n        const gl2 = assertWebGL2Context(this.gl);\n        gl2.texSubImage2D(target, level, x, y, width, height, dataFormat, type, data);\n      } else {\n        this.gl.texSubImage2D(target, level, x, y, dataFormat, type, data);\n      }\n    });\n\n    this.gl.bindTexture(this.target, null);\n  }\n  /* eslint-enable max-len, max-statements, complexity */\n\n  /**\n   * Defines a two-dimensional texture image or cube-map texture image with\n   * pixels from the current framebuffer (rather than from client memory).\n   * (gl.copyTexImage2D wrapper)\n   *\n   * Note that binding a texture into a Framebuffer's color buffer and\n   * rendering can be faster.\n   */\n  copyFramebuffer(opts = {}) {\n    log.error(\n      'Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})'\n    )();\n    return null;\n  }\n\n  getActiveUnit() {\n    return this.gl.getParameter(GL.ACTIVE_TEXTURE) - GL.TEXTURE0;\n  }\n\n  // target cannot be modified by bind:\n  // textures are special because when you first bind them to a target,\n  // they get special information. When you first bind a texture as a\n  // GL_TEXTURE_2D, you are actually setting special state in the texture.\n  // You are saying that this texture is a 2D texture.\n  // And it will always be a 2D texture; this state cannot be changed ever.\n  // If you have a texture that was first bound as a GL_TEXTURE_2D,\n  // you must always bind it as a GL_TEXTURE_2D;\n  // attempting to bind it as GL_TEXTURE_1D will give rise to an error\n  // (while run-time).\n\n  bind(textureUnit = this.textureUnit) {\n    const {gl} = this;\n\n    if (textureUnit !== undefined) {\n      this.textureUnit = textureUnit;\n      gl.activeTexture(gl.TEXTURE0 + textureUnit);\n    }\n\n    gl.bindTexture(this.target, this.handle);\n    return textureUnit;\n  }\n\n  unbind(textureUnit = this.textureUnit) {\n    const {gl} = this;\n\n    if (textureUnit !== undefined) {\n      this.textureUnit = textureUnit;\n      gl.activeTexture(gl.TEXTURE0 + textureUnit);\n    }\n\n    gl.bindTexture(this.target, null);\n    return textureUnit;\n  }\n\n  // PRIVATE METHODS\n\n  _getDataType({data, compressed = false}) {\n    if (compressed) {\n      return {data, dataType: 'compressed'};\n    }\n    if (data === null) {\n      return {data, dataType: 'null'};\n    }\n    if (ArrayBuffer.isView(data)) {\n      return {data, dataType: 'typed-array'};\n    }\n    if (data instanceof Buffer) {\n      return {data: data.handle, dataType: 'buffer'};\n    }\n    if (data instanceof WebGLBuffer) {\n      return {data, dataType: 'buffer'};\n    }\n    // Assume data is a browser supported object (ImageData, Canvas, ...)\n    return {data, dataType: 'browser-object'};\n  }\n\n  /* Copied from texture-2d.js\n  // WebGL2\n  setPixels(opts = {}) {\n    const {\n      buffer,\n      width = null,\n      height = null,\n      mipmapLevel = 0,\n      format = GL.RGBA,\n      type = GL.UNSIGNED_BYTE,\n      border = 0\n    } = opts;\n\n    const {gl} = this;\n\n    // This signature of texImage2D uses currently bound GL.PIXEL_UNPACK_BUFFER\n    gl.bindBuffer(GL.PIXEL_UNPACK_BUFFER, buffer.target);\n    // And as always, we must also bind the texture itself\n    this.bind();\n\n    gl.texImage2D(gl.TEXTURE_2D,\n      mipmapLevel, format, width, height, border, format, type, buffer.target);\n\n    this.unbind();\n    gl.bindBuffer(GL.GL.PIXEL_UNPACK_BUFFER, null);\n    return this;\n  }\n\n  setImageDataFromCompressedBuffer(opts) {\n    const {\n      buffer,\n      // offset = 0,\n      width = null,\n      height = null,\n      mipmapLevel = 0,\n      internalFormat = GL.RGBA,\n      // format = GL.RGBA,\n      // type = GL.UNSIGNED_BYTE,\n      border = 0\n    } = opts;\n\n    const {gl} = this;\n    gl.compressedTexImage2D(this.target,\n      mipmapLevel, internalFormat, width, height, border, buffer);\n    // gl.compressedTexSubImage2D(target,\n    //   level, xoffset, yoffset, width, height, format, ArrayBufferView? pixels);\n    return this;\n  }\n\n  copySubImage(opts) {\n    const {\n      // pixels,\n      // offset = 0,\n      // x,\n      // y,\n      // width,\n      // height,\n      // mipmapLevel = 0,\n      // internalFormat = GL.RGBA,\n      // type = GL.UNSIGNED_BYTE,\n      // border = 0\n    } = opts;\n\n    // if (pixels instanceof ArrayBufferView) {\n    //   gl.texSubImage2D(target, level, x, y, width, height, format, type, pixels);\n    // }\n    // gl.texSubImage2D(target, level, x, y, format, type, ? pixels);\n    // gl.texSubImage2D(target, level, x, y, format, type, HTMLImageElement pixels);\n    // gl.texSubImage2D(target, level, x, y, format, type, HTMLCanvasElement pixels);\n    // gl.texSubImage2D(target, level, x, y, format, type, HTMLVideoElement pixels);\n    // // Additional signature in a WebGL 2 context:\n    // gl.texSubImage2D(target, level, x, y, format, type, GLintptr offset);\n  }\n  */\n\n  // HELPER METHODS\n\n  _deduceParameters(opts) {\n    const {format, data} = opts;\n    let {width, height, dataFormat, type, compressed} = opts;\n\n    // Deduce format and type from format\n    const textureFormat = TEXTURE_FORMATS[format];\n    dataFormat = dataFormat || (textureFormat && textureFormat.dataFormat);\n    type = type || (textureFormat && textureFormat.types[0]);\n\n    // Deduce compression from format\n    compressed = compressed || (textureFormat && textureFormat.compressed);\n\n    ({width, height} = this._deduceImageSize(data, width, height));\n\n    return {dataFormat, type, compressed, width, height, format, data};\n  }\n\n  // eslint-disable-next-line complexity\n  _deduceImageSize(data, width, height) {\n    let size;\n\n    if (typeof ImageData !== 'undefined' && data instanceof ImageData) {\n      size = {width: data.width, height: data.height};\n    } else if (typeof HTMLImageElement !== 'undefined' && data instanceof HTMLImageElement) {\n      size = {width: data.naturalWidth, height: data.naturalHeight};\n    } else if (typeof HTMLCanvasElement !== 'undefined' && data instanceof HTMLCanvasElement) {\n      size = {width: data.width, height: data.height};\n    } else if (typeof ImageBitmap !== 'undefined' && data instanceof ImageBitmap) {\n      size = {width: data.width, height: data.height};\n    } else if (typeof HTMLVideoElement !== 'undefined' && data instanceof HTMLVideoElement) {\n      size = {width: data.videoWidth, height: data.videoHeight};\n    } else if (!data) {\n      size = {width: width >= 0 ? width : 1, height: height >= 0 ? height : 1};\n    } else {\n      size = {width, height};\n    }\n\n    assert(size, 'Could not deduced texture size');\n    assert(\n      width === undefined || size.width === width,\n      'Deduced texture width does not match supplied width'\n    );\n    assert(\n      height === undefined || size.height === height,\n      'Deduced texture height does not match supplied height'\n    );\n\n    return size;\n  }\n\n  // RESOURCE METHODS\n\n  _createHandle() {\n    return this.gl.createTexture();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteTexture(this.handle);\n    this._trackDeallocatedMemory('Texture');\n  }\n\n  _getParameter(pname) {\n    switch (pname) {\n      case GL.TEXTURE_WIDTH:\n        return this.width;\n      case GL.TEXTURE_HEIGHT:\n        return this.height;\n      default:\n        this.gl.bindTexture(this.target, this.handle);\n        const value = this.gl.getTexParameter(this.target, pname);\n        this.gl.bindTexture(this.target, null);\n        return value;\n    }\n  }\n\n  _setParameter(pname, param) {\n    this.gl.bindTexture(this.target, this.handle);\n\n    // NOTE: Apply NPOT workaround\n    param = this._getNPOTParam(pname, param);\n\n    // Apparently there are some integer/float conversion rules that made\n    // the WebGL committe expose two parameter setting functions in JavaScript.\n    // For now, pick the float version for parameters specified as GLfloat.\n    switch (pname) {\n      case GL.TEXTURE_MIN_LOD:\n      case GL.TEXTURE_MAX_LOD:\n        this.gl.texParameterf(this.handle, pname, param);\n        break;\n\n      case GL.TEXTURE_WIDTH:\n      case GL.TEXTURE_HEIGHT:\n        assert(false);\n        break;\n\n      default:\n        this.gl.texParameteri(this.target, pname, param);\n        break;\n    }\n\n    this.gl.bindTexture(this.target, null);\n    return this;\n  }\n\n  _isNPOT() {\n    if (isWebGL2(this.gl)) {\n      // NPOT restriction is only for WebGL1\n      return false;\n    }\n    // Width and height not available, consider it is not NPOT texture\n    if (!this.width || !this.height) {\n      return false;\n    }\n    return !isPowerOfTwo(this.width) || !isPowerOfTwo(this.height);\n  }\n\n  // Update default settings which are not supported by NPOT textures.\n  _updateForNPOT(parameters) {\n    if (parameters[this.gl.TEXTURE_MIN_FILTER] === undefined) {\n      // log.warn(`texture: ${this} is Non-Power-Of-Two, forcing TEXTURE_MIN_FILTER to LINEAR`)();\n      parameters[this.gl.TEXTURE_MIN_FILTER] = this.gl.LINEAR;\n    }\n    if (parameters[this.gl.TEXTURE_WRAP_S] === undefined) {\n      // log.warn(`texture: ${this} is Non-Power-Of-Two, forcing TEXTURE_WRAP_S to CLAMP_TO_EDGE`)();\n      parameters[this.gl.TEXTURE_WRAP_S] = this.gl.CLAMP_TO_EDGE;\n    }\n    if (parameters[this.gl.TEXTURE_WRAP_T] === undefined) {\n      // log.warn(`texture: ${this} is Non-Power-Of-Two, forcing TEXTURE_WRAP_T to CLAMP_TO_EDGE`)();\n      parameters[this.gl.TEXTURE_WRAP_T] = this.gl.CLAMP_TO_EDGE;\n    }\n  }\n\n  _getNPOTParam(pname, param) {\n    if (this._isNPOT()) {\n      switch (pname) {\n        case GL.TEXTURE_MIN_FILTER:\n          if (NPOT_MIN_FILTERS.indexOf(param) === -1) {\n            // log.warn(`texture: ${this} is Non-Power-Of-Two, forcing TEXTURE_MIN_FILTER to LINEAR`)();\n            param = GL.LINEAR;\n          }\n          break;\n        case GL.TEXTURE_WRAP_S:\n        case GL.TEXTURE_WRAP_T:\n          if (param !== GL.CLAMP_TO_EDGE) {\n            // log.warn(`texture: ${this} is Non-Power-Of-Two, ${getKey(this.gl, pname)} to CLAMP_TO_EDGE`)();\n            param = GL.CLAMP_TO_EDGE;\n          }\n          break;\n        default:\n          break;\n      }\n    }\n    return param;\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {isWebGL2, assertWebGL2Context, log} from '@luma.gl/gltools';\nimport Resource from './resource';\nimport Buffer from './buffer';\nimport {isObjectEmpty} from '../utils/utils';\n\n// NOTE: The `bindOnUse` flag is a major workaround:\n// See https://github.com/KhronosGroup/WebGL/issues/2346\n\nexport default class TransformFeedback extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'TransformFeedback';\n  }\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  constructor(gl, props = {}) {\n    assertWebGL2Context(gl);\n    super(gl, props);\n\n    this.initialize(props);\n    this.stubRemovedMethods('TransformFeedback', 'v6.0', ['pause', 'resume']);\n    Object.seal(this);\n  }\n\n  initialize(props = {}) {\n    this.buffers = {};\n    this.unused = {};\n    this.configuration = null;\n    this.bindOnUse = true;\n\n    // Unbind any currently bound buffers\n    if (!isObjectEmpty(this.buffers)) {\n      this.bind(() => this._unbindBuffers());\n    }\n\n    this.setProps(props);\n    return this;\n  }\n\n  setProps(props) {\n    if ('program' in props) {\n      this.configuration = props.program && props.program.configuration;\n    }\n    if ('configuration' in props) {\n      this.configuration = props.configuration;\n    }\n    if ('bindOnUse' in props) {\n      props = props.bindOnUse;\n    }\n    if ('buffers' in props) {\n      this.setBuffers(props.buffers);\n    }\n  }\n\n  setBuffers(buffers = {}) {\n    this.bind(() => {\n      for (const bufferName in buffers) {\n        this.setBuffer(bufferName, buffers[bufferName]);\n      }\n    });\n    return this;\n  }\n\n  setBuffer(locationOrName, bufferOrParams) {\n    const location = this._getVaryingIndex(locationOrName);\n    const {buffer, byteSize, byteOffset} = this._getBufferParams(bufferOrParams);\n\n    if (location < 0) {\n      this.unused[locationOrName] = buffer;\n      log.warn(`${this.id} unused varying buffer ${locationOrName}`)();\n      return this;\n    }\n\n    this.buffers[location] = bufferOrParams;\n\n    // Need to avoid chrome bug where buffer that is already bound to a different target\n    // cannot be bound to 'TRANSFORM_FEEDBACK_BUFFER' target.\n    if (!this.bindOnUse) {\n      this._bindBuffer(location, buffer, byteOffset, byteSize);\n    }\n\n    return this;\n  }\n\n  begin(primitiveMode = GL.POINTS) {\n    // @ts-ignore\n    this.gl.bindTransformFeedback(GL.TRANSFORM_FEEDBACK, this.handle);\n    this._bindBuffers();\n    // @ts-ignore\n    this.gl.beginTransformFeedback(primitiveMode);\n    return this;\n  }\n\n  end() {\n    // @ts-ignore\n    this.gl.endTransformFeedback();\n    this._unbindBuffers();\n    // @ts-ignore\n    this.gl.bindTransformFeedback(GL.TRANSFORM_FEEDBACK, null);\n    return this;\n  }\n\n  // PRIVATE METHODS\n\n  _getBufferParams(bufferOrParams) {\n    let byteOffset;\n    let byteSize;\n    let buffer;\n    if (bufferOrParams instanceof Buffer === false) {\n      buffer = bufferOrParams.buffer;\n      byteSize = bufferOrParams.byteSize;\n      byteOffset = bufferOrParams.byteOffset;\n    } else {\n      buffer = bufferOrParams;\n    }\n    // to use bindBufferRange, either offset or size must be specified, use default value for the other.\n    if (byteOffset !== undefined || byteSize !== undefined) {\n      byteOffset = byteOffset || 0;\n      byteSize = byteSize || buffer.byteLength - byteOffset;\n    }\n    return {buffer, byteOffset, byteSize};\n  }\n\n  _getVaryingInfo(locationOrName) {\n    return this.configuration && this.configuration.getVaryingInfo(locationOrName);\n  }\n\n  _getVaryingIndex(locationOrName) {\n    if (this.configuration) {\n      return this.configuration.getVaryingInfo(locationOrName).location;\n    }\n    const location = Number(locationOrName);\n    return Number.isFinite(location) ? location : -1;\n  }\n\n  // Need to avoid chrome bug where buffer that is already bound to a different target\n  // cannot be bound to 'TRANSFORM_FEEDBACK_BUFFER' target.\n  _bindBuffers() {\n    if (this.bindOnUse) {\n      for (const bufferIndex in this.buffers) {\n        const {buffer, byteSize, byteOffset} = this._getBufferParams(this.buffers[bufferIndex]);\n        this._bindBuffer(bufferIndex, buffer, byteOffset, byteSize);\n      }\n    }\n  }\n\n  _unbindBuffers() {\n    if (this.bindOnUse) {\n      for (const bufferIndex in this.buffers) {\n        this._bindBuffer(bufferIndex, null);\n      }\n    }\n  }\n\n  _bindBuffer(index, buffer, byteOffset = 0, byteSize) {\n    const handle = buffer && buffer.handle;\n    if (!handle || byteSize === undefined) {\n      // @ts-ignore\n      this.gl.bindBufferBase(GL.TRANSFORM_FEEDBACK_BUFFER, index, handle);\n    } else {\n      // @ts-ignore\n      this.gl.bindBufferRange(GL.TRANSFORM_FEEDBACK_BUFFER, index, handle, byteOffset, byteSize);\n    }\n    return this;\n  }\n\n  // RESOURCE METHODS\n\n  _createHandle() {\n    // @ts-ignore\n    return this.gl.createTransformFeedback();\n  }\n\n  _deleteHandle() {\n    // @ts-ignore\n    this.gl.deleteTransformFeedback(this.handle);\n  }\n\n  _bindHandle(handle) {\n    // @ts-ignore\n    this.gl.bindTransformFeedback(GL.TRANSFORM_FEEDBACK, this.handle);\n  }\n}\n","/** @typedef {import('./uniforms')} types */\n\nimport GL from '@luma.gl/constants';\nimport {log} from '@luma.gl/gltools';\n\nimport Framebuffer from './framebuffer';\nimport Renderbuffer from './renderbuffer';\nimport Texture from './texture';\nimport {assert} from '../utils/assert';\n\nconst UNIFORM_SETTERS = {\n  // WEBGL1\n\n  /* eslint-disable max-len */\n  [GL.FLOAT]: getArraySetter.bind(null, 'uniform1fv', toFloatArray, 1, setVectorUniform),\n  [GL.FLOAT_VEC2]: getArraySetter.bind(null, 'uniform2fv', toFloatArray, 2, setVectorUniform),\n  [GL.FLOAT_VEC3]: getArraySetter.bind(null, 'uniform3fv', toFloatArray, 3, setVectorUniform),\n  [GL.FLOAT_VEC4]: getArraySetter.bind(null, 'uniform4fv', toFloatArray, 4, setVectorUniform),\n\n  [GL.INT]: getArraySetter.bind(null, 'uniform1iv', toIntArray, 1, setVectorUniform),\n  [GL.INT_VEC2]: getArraySetter.bind(null, 'uniform2iv', toIntArray, 2, setVectorUniform),\n  [GL.INT_VEC3]: getArraySetter.bind(null, 'uniform3iv', toIntArray, 3, setVectorUniform),\n  [GL.INT_VEC4]: getArraySetter.bind(null, 'uniform4iv', toIntArray, 4, setVectorUniform),\n\n  [GL.BOOL]: getArraySetter.bind(null, 'uniform1iv', toIntArray, 1, setVectorUniform),\n  [GL.BOOL_VEC2]: getArraySetter.bind(null, 'uniform2iv', toIntArray, 2, setVectorUniform),\n  [GL.BOOL_VEC3]: getArraySetter.bind(null, 'uniform3iv', toIntArray, 3, setVectorUniform),\n  [GL.BOOL_VEC4]: getArraySetter.bind(null, 'uniform4iv', toIntArray, 4, setVectorUniform),\n\n  // uniformMatrix(false): don't transpose the matrix\n  [GL.FLOAT_MAT2]: getArraySetter.bind(null, 'uniformMatrix2fv', toFloatArray, 4, setMatrixUniform),\n  [GL.FLOAT_MAT3]: getArraySetter.bind(null, 'uniformMatrix3fv', toFloatArray, 9, setMatrixUniform),\n  [GL.FLOAT_MAT4]: getArraySetter.bind(\n    null,\n    'uniformMatrix4fv',\n    toFloatArray,\n    16,\n    setMatrixUniform\n  ),\n\n  [GL.SAMPLER_2D]: getSamplerSetter,\n  [GL.SAMPLER_CUBE]: getSamplerSetter,\n\n  // WEBGL2 - unsigned integers, irregular matrices, additional texture samplers\n\n  [GL.UNSIGNED_INT]: getArraySetter.bind(null, 'uniform1uiv', toUIntArray, 1, setVectorUniform),\n  [GL.UNSIGNED_INT_VEC2]: getArraySetter.bind(\n    null,\n    'uniform2uiv',\n    toUIntArray,\n    2,\n    setVectorUniform\n  ),\n  [GL.UNSIGNED_INT_VEC3]: getArraySetter.bind(\n    null,\n    'uniform3uiv',\n    toUIntArray,\n    3,\n    setVectorUniform\n  ),\n  [GL.UNSIGNED_INT_VEC4]: getArraySetter.bind(\n    null,\n    'uniform4uiv',\n    toUIntArray,\n    4,\n    setVectorUniform\n  ),\n\n  // uniformMatrix(false): don't transpose the matrix\n  [GL.FLOAT_MAT2x3]: getArraySetter.bind(\n    null,\n    'uniformMatrix2x3fv',\n    toFloatArray,\n    6,\n    setMatrixUniform\n  ),\n  [GL.FLOAT_MAT2x4]: getArraySetter.bind(\n    null,\n    'uniformMatrix2x4fv',\n    toFloatArray,\n    8,\n    setMatrixUniform\n  ),\n  [GL.FLOAT_MAT3x2]: getArraySetter.bind(\n    null,\n    'uniformMatrix3x2fv',\n    toFloatArray,\n    6,\n    setMatrixUniform\n  ),\n  [GL.FLOAT_MAT3x4]: getArraySetter.bind(\n    null,\n    'uniformMatrix3x4fv',\n    toFloatArray,\n    12,\n    setMatrixUniform\n  ),\n  [GL.FLOAT_MAT4x2]: getArraySetter.bind(\n    null,\n    'uniformMatrix4x2fv',\n    toFloatArray,\n    8,\n    setMatrixUniform\n  ),\n  [GL.FLOAT_MAT4x3]: getArraySetter.bind(\n    null,\n    'uniformMatrix4x3fv',\n    toFloatArray,\n    12,\n    setMatrixUniform\n  ),\n\n  [GL.SAMPLER_2D]: getSamplerSetter,\n  [GL.SAMPLER_CUBE]: getSamplerSetter,\n\n  [GL.SAMPLER_3D]: getSamplerSetter,\n  [GL.SAMPLER_2D_SHADOW]: getSamplerSetter,\n  [GL.SAMPLER_2D_ARRAY]: getSamplerSetter,\n  [GL.SAMPLER_2D_ARRAY_SHADOW]: getSamplerSetter,\n  [GL.SAMPLER_CUBE_SHADOW]: getSamplerSetter,\n  [GL.INT_SAMPLER_2D]: getSamplerSetter,\n  [GL.INT_SAMPLER_3D]: getSamplerSetter,\n  [GL.INT_SAMPLER_CUBE]: getSamplerSetter,\n  [GL.INT_SAMPLER_2D_ARRAY]: getSamplerSetter,\n  [GL.UNSIGNED_INT_SAMPLER_2D]: getSamplerSetter,\n  [GL.UNSIGNED_INT_SAMPLER_3D]: getSamplerSetter,\n  [GL.UNSIGNED_INT_SAMPLER_CUBE]: getSamplerSetter,\n  [GL.UNSIGNED_INT_SAMPLER_2D_ARRAY]: getSamplerSetter\n  /* eslint-enable max-len */\n};\n\n// Pre-allocated typed arrays for temporary conversion\nconst FLOAT_ARRAY = {};\nconst INT_ARRAY = {};\nconst UINT_ARRAY = {};\n\nconst array1 = [0];\n\n// Functions to ensure the type of uniform values\n// This is done because uniform*v functions\n// are extremely slow when consuming JS arrays directly.\nfunction toTypedArray(value, uniformLength, Type, cache) {\n  // convert boolean uniforms to Number\n  if (uniformLength === 1 && typeof value === 'boolean') {\n    value = value ? 1 : 0;\n  }\n  if (Number.isFinite(value)) {\n    array1[0] = value;\n    value = array1;\n  }\n  const length = value.length;\n  if (length % uniformLength) {\n    log.warn(`Uniform size should be multiples of ${uniformLength}`, value)();\n  }\n\n  if (value instanceof Type) {\n    return value;\n  }\n  let result = cache[length];\n  if (!result) {\n    result = new Type(length);\n    cache[length] = result;\n  }\n  for (let i = 0; i < length; i++) {\n    result[i] = value[i];\n  }\n  return result;\n}\n\nfunction toFloatArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Float32Array, FLOAT_ARRAY);\n}\n\nfunction toIntArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Int32Array, INT_ARRAY);\n}\n\nfunction toUIntArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Uint32Array, UINT_ARRAY);\n} // Returns a Magic Uniform Setter\n\n// PUBLIC API\n\n/** @type {types['getUniformSetter']} */ export function getUniformSetter(gl, location, info) {\n  const setter = UNIFORM_SETTERS[info.type];\n  if (!setter) {\n    throw new Error(`Unknown GLSL uniform type ${info.type}`);\n  }\n\n  // NOTE(Tarek): This construction is the ensure\n  // separate caches for all setters.\n  return setter().bind(null, gl, location);\n}\n\n/** @type {types['parseUniformName']} */\nexport function parseUniformName(name) {\n  // Shortcut to avoid redundant or bad matches\n  if (name[name.length - 1] !== ']') {\n    return {\n      name,\n      length: 1,\n      isArray: false\n    };\n  }\n\n  // if array name then clean the array brackets\n  const UNIFORM_NAME_REGEXP = /([^[]*)(\\[[0-9]+\\])?/;\n  const matches = name.match(UNIFORM_NAME_REGEXP);\n  if (!matches || matches.length < 2) {\n    throw new Error(`Failed to parse GLSL uniform name ${name}`);\n  }\n\n  return {\n    name: matches[1],\n    length: matches[2] || 1,\n    isArray: Boolean(matches[2])\n  };\n} // To facilitate early detection of e.g. undefined values in JavaScript\n\n// Basic checks of uniform values (with or without knowledge of program)\n\n/** @type {types['checkUniformValues']} */\nexport function checkUniformValues(uniforms, source, uniformMap) {\n  for (const uniformName in uniforms) {\n    const value = uniforms[uniformName];\n    const shouldCheck = !uniformMap || Boolean(uniformMap[uniformName]);\n    if (shouldCheck && !checkUniformValue(value)) {\n      // Add space to source\n      source = source ? `${source} ` : '';\n      // Value could be unprintable so write the object on console\n      console.error(`${source} Bad uniform ${uniformName}`, value); // eslint-disable-line\n      /* eslint-enable no-console */\n      throw new Error(`${source} Bad uniform ${uniformName}`);\n    }\n  }\n  return true;\n}\n\n// TODO use type information during validation\nfunction checkUniformValue(value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    return checkUniformArray(value);\n  }\n\n  // Check if single value is a number\n  if (isFinite(value)) {\n    return true;\n  } else if (value === true || value === false) {\n    return true;\n  } else if (value instanceof Texture) {\n    return true;\n  } else if (value instanceof Renderbuffer) {\n    return true;\n  } else if (value instanceof Framebuffer) {\n    return Boolean(value.texture);\n  }\n  return false;\n}\n\n/** @type {types['copyUniform']} */\nexport function copyUniform(uniforms, key, value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    if (uniforms[key]) {\n      const dest = uniforms[key];\n      // @ts-ignore\n      for (let i = 0, len = value.length; i < len; ++i) {\n        dest[i] = value[i];\n      }\n    } else {\n      // @ts-ignore\n      uniforms[key] = value.slice();\n    }\n  } else {\n    uniforms[key] = value;\n  }\n}\n\n// HELPERS\n\nfunction checkUniformArray(value) {\n  // Check that every element in array is a number, and at least 1 element\n  if (value.length === 0) {\n    return false;\n  }\n\n  const checkLength = Math.min(value.length, 16);\n\n  for (let i = 0; i < checkLength; ++i) {\n    if (!Number.isFinite(value[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n// NOTE(Tarek): Setters maintain a cache\n// of the previously set value, and\n// avoid resetting it if it's the same.\nfunction getSamplerSetter() {\n  let cache = null;\n  return (gl, location, value) => {\n    const update = cache !== value;\n    if (update) {\n      gl.uniform1i(location, value);\n      cache = value;\n    }\n\n    return update;\n  };\n}\n\nfunction getArraySetter(functionName, toArray, size, uniformSetter) {\n  let cache = null;\n  let cacheLength = null;\n  return (gl, location, value) => {\n    const arrayValue = toArray(value, size);\n    const length = arrayValue.length;\n    let update = false;\n    if (cache === null) {\n      cache = new Float32Array(length);\n      cacheLength = length;\n      update = true;\n    } else {\n      assert(cacheLength === length, 'Uniform length cannot change.');\n      for (let i = 0; i < length; ++i) {\n        if (arrayValue[i] !== cache[i]) {\n          update = true;\n          break;\n        }\n      }\n    }\n    if (update) {\n      uniformSetter(gl, functionName, location, arrayValue);\n      cache.set(arrayValue);\n    }\n\n    return update;\n  };\n}\n\nfunction setVectorUniform(gl, functionName, location, value) {\n  gl[functionName](location, value);\n}\n\nfunction setMatrixUniform(gl, functionName, location, value) {\n  gl[functionName](location, false, value);\n}\n","import GL from '@luma.gl/constants';\nimport Resource from './resource';\nimport Buffer from './buffer';\nimport {isWebGL2} from '@luma.gl/gltools';\nimport {getScratchArray, fillArray} from '../utils/array-utils-flat';\nimport {assert} from '../utils/assert';\nimport {getBrowser} from '@probe.gl/env';\n\nconst ERR_ELEMENTS = 'elements must be GL.ELEMENT_ARRAY_BUFFER';\n\nexport default class VertexArrayObject extends Resource {\n  // eslint-disable-next-line accessor-pairs\n  get [Symbol.toStringTag]() {\n    return 'VertexArrayObject';\n  }\n  static isSupported(gl, options = {}) {\n    // Attribute 0 can not be disable on most desktop OpenGL based browsers\n    // and on iOS Safari browser.\n    if (options.constantAttributeZero) {\n      return isWebGL2(gl) || getBrowser() === 'Chrome';\n    }\n\n    // Whether additional objects can be created\n    return true;\n  }\n\n  // Returns the global (null) vertex array object. Exists even when no extension available\n  // TODO(Tarek): VAOs are now polyfilled. Deprecate this in 9.0\n  static getDefaultArray(gl) {\n    gl.luma = gl.luma || {};\n    if (!gl.luma.defaultVertexArray) {\n      gl.luma.defaultVertexArray = new VertexArrayObject(gl, {handle: null, isDefaultArray: true});\n    }\n    return gl.luma.defaultVertexArray;\n  }\n\n  static getMaxAttributes(gl) {\n    // TODO - should be cached per context\n    // @ts-ignore\n    VertexArrayObject.MAX_ATTRIBUTES =\n      // @ts-ignore\n      VertexArrayObject.MAX_ATTRIBUTES || gl.getParameter(gl.MAX_VERTEX_ATTRIBS);\n    // @ts-ignore\n    return VertexArrayObject.MAX_ATTRIBUTES;\n  }\n\n  // Note: Constants are stored globally on the WebGL context, not the VAO\n  // So they need to be updated before every render\n  // TODO - use known type (in configuration or passed in) to allow non-typed arrays?\n  // TODO - remember/cache values to avoid setting them unnecessarily?\n  static setConstant(gl, location, array) {\n    switch (array.constructor) {\n      case Float32Array:\n        VertexArrayObject._setConstantFloatArray(gl, location, array);\n        break;\n      case Int32Array:\n        VertexArrayObject._setConstantIntArray(gl, location, array);\n        break;\n      case Uint32Array:\n        VertexArrayObject._setConstantUintArray(gl, location, array);\n        break;\n      default:\n        assert(false);\n    }\n  }\n\n  // Create a VertexArray\n  constructor(gl, opts = {}) {\n    // Use program's id if program but no id is supplied\n    const id = opts.id || (opts.program && opts.program.id);\n    super(gl, Object.assign({}, opts, {id}));\n\n    this.buffer = null;\n    this.bufferValue = null;\n    this.isDefaultArray = opts.isDefaultArray || false;\n\n    /** @type {WebGL2RenderingContext} */\n    this.gl2 = gl;\n\n    this.initialize(opts);\n\n    Object.seal(this);\n  }\n\n  delete() {\n    super.delete();\n    if (this.buffer) {\n      this.buffer.delete();\n    }\n    return this;\n  }\n\n  get MAX_ATTRIBUTES() {\n    return VertexArrayObject.getMaxAttributes(this.gl);\n  }\n\n  initialize(props = {}) {\n    return this.setProps(props);\n  }\n\n  setProps(props) {\n    // TODO: decide which props should be supported\n    return this;\n  }\n\n  // Set (bind) an elements buffer, for indexed rendering.\n  // Must be a Buffer bound to GL.ELEMENT_ARRAY_BUFFER. Constants not supported\n  setElementBuffer(elementBuffer = null, opts = {}) {\n    assert(!elementBuffer || elementBuffer.target === GL.ELEMENT_ARRAY_BUFFER, ERR_ELEMENTS);\n\n    // The GL.ELEMENT_ARRAY_BUFFER_BINDING is stored on the VertexArrayObject...\n    this.bind(() => {\n      this.gl.bindBuffer(GL.ELEMENT_ARRAY_BUFFER, elementBuffer ? elementBuffer.handle : null);\n    });\n\n    return this;\n  }\n\n  // Set a location in vertex attributes array to a bufferk, enables the location, sets divisor\n  setBuffer(location, buffer, accessor) {\n    // Check target\n    if (buffer.target === GL.ELEMENT_ARRAY_BUFFER) {\n      return this.setElementBuffer(buffer, accessor);\n    }\n\n    const {size, type, stride, offset, normalized, integer, divisor} = accessor;\n\n    const {gl, gl2} = this;\n    location = Number(location);\n\n    this.bind(() => {\n      // A non-zero buffer object must be bound to the GL_ARRAY_BUFFER target\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer.handle);\n\n      // WebGL2 supports *integer* data formats, i.e. GPU will see integer values\n      if (integer) {\n        assert(isWebGL2(gl));\n        gl2.vertexAttribIPointer(location, size, type, stride, offset);\n      } else {\n        // Attaches ARRAY_BUFFER with specified buffer format to location\n        gl.vertexAttribPointer(location, size, type, normalized, stride, offset);\n      }\n      gl.enableVertexAttribArray(location);\n      gl2.vertexAttribDivisor(location, divisor || 0);\n\n      // NOTE We don't unbind buffer here, typically another buffer will be bound just after\n    });\n\n    return this;\n  }\n\n  // Enabling an attribute location makes it reference the currently bound buffer\n  // Disabling an attribute location makes it reference the global constant value\n  // TODO - handle single values for size 1 attributes?\n  // TODO - convert classic arrays based on known type?\n  enable(location, enable = true) {\n    // Attribute 0 cannot be disabled in most desktop OpenGL based browsers\n    const disablingAttributeZero =\n      !enable &&\n      location === 0 &&\n      !VertexArrayObject.isSupported(this.gl, {constantAttributeZero: true});\n\n    if (!disablingAttributeZero) {\n      location = Number(location);\n      this.bind(\n        () =>\n          enable\n            ? this.gl.enableVertexAttribArray(location)\n            : this.gl.disableVertexAttribArray(location)\n      );\n    }\n    return this;\n  }\n\n  // Provide a means to create a buffer that is equivalent to a constant.\n  // NOTE: Desktop OpenGL cannot disable attribute 0.\n  // https://stackoverflow.com/questions/20305231/webgl-warning-attribute-0-is-disabled-\n  // this-has-significant-performance-penalt\n  getConstantBuffer(elementCount, value) {\n    // Create buffer only when needed, and reuse it (avoids inflating buffer creation statistics)\n\n    const constantValue = this._normalizeConstantArrayValue(value);\n\n    const byteLength = constantValue.byteLength * elementCount;\n    const length = constantValue.length * elementCount;\n\n    let updateNeeded = !this.buffer;\n\n    this.buffer = this.buffer || new Buffer(this.gl, byteLength);\n    updateNeeded = updateNeeded || this.buffer.reallocate(byteLength);\n\n    // Reallocate and update contents if needed\n    updateNeeded =\n      updateNeeded || !this._compareConstantArrayValues(constantValue, this.bufferValue);\n\n    if (updateNeeded) {\n      // Create a typed array that is big enough, and fill it with the required data\n      const typedArray = getScratchArray(value.constructor, length);\n      fillArray({target: typedArray, source: constantValue, start: 0, count: length});\n      this.buffer.subData(typedArray);\n      this.bufferValue = value;\n    }\n\n    return this.buffer;\n  }\n\n  // PRIVATE\n\n  // TODO - convert Arrays based on known type? (read type from accessor, don't assume Float32Array)\n  // TODO - handle single values for size 1 attributes?\n  _normalizeConstantArrayValue(arrayValue) {\n    if (Array.isArray(arrayValue)) {\n      return new Float32Array(arrayValue);\n    }\n    return arrayValue;\n  }\n\n  _compareConstantArrayValues(v1, v2) {\n    if (!v1 || !v2 || v1.length !== v2.length || v1.constructor !== v2.constructor) {\n      return false;\n    }\n    for (let i = 0; i < v1.length; ++i) {\n      if (v1[i] !== v2[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  static _setConstantFloatArray(gl, location, array) {\n    switch (array.length) {\n      case 1:\n        gl.vertexAttrib1fv(location, array);\n        break;\n      case 2:\n        gl.vertexAttrib2fv(location, array);\n        break;\n      case 3:\n        gl.vertexAttrib3fv(location, array);\n        break;\n      case 4:\n        gl.vertexAttrib4fv(location, array);\n        break;\n      default:\n        assert(false);\n    }\n  }\n\n  static _setConstantIntArray(gl, location, array) {\n    assert(isWebGL2(gl));\n    switch (array.length) {\n      case 1:\n        gl.vertexAttribI1iv(location, array);\n        break;\n      case 2:\n        gl.vertexAttribI2iv(location, array);\n        break;\n      case 3:\n        gl.vertexAttribI3iv(location, array);\n        break;\n      case 4:\n        gl.vertexAttribI4iv(location, array);\n        break;\n      default:\n        assert(false);\n    }\n  }\n\n  static _setConstantUintArray(gl, location, array) {\n    assert(isWebGL2(gl));\n    switch (array.length) {\n      case 1:\n        gl.vertexAttribI1uiv(location, array);\n        break;\n      case 2:\n        gl.vertexAttribI2uiv(location, array);\n        break;\n      case 3:\n        gl.vertexAttribI3uiv(location, array);\n        break;\n      case 4:\n        gl.vertexAttribI4uiv(location, array);\n        break;\n      default:\n        assert(false);\n    }\n  }\n\n  // RESOURCE IMPLEMENTATION\n\n  _createHandle() {\n    /** @type {WebGL2RenderingContext} */\n    // @ts-ignore\n    const gl2 = this.gl;\n    return gl2.createVertexArray();\n  }\n\n  _deleteHandle(handle) {\n    this.gl2.deleteVertexArray(handle);\n    // @ts-ignore\n    return [this.elements];\n    // return [this.elements, ...this.buffers];\n  }\n\n  _bindHandle(handle) {\n    this.gl2.bindVertexArray(handle);\n  }\n\n  // Generic getter for information about a vertex attribute at a given position\n  _getParameter(pname, {location}) {\n    assert(Number.isFinite(location));\n    return this.bind(() => {\n      switch (pname) {\n        case GL.VERTEX_ATTRIB_ARRAY_POINTER:\n          return this.gl.getVertexAttribOffset(location, pname);\n        default:\n          return this.gl.getVertexAttrib(location, pname);\n      }\n    });\n  }\n}\n","import GL from '@luma.gl/constants';\nimport {log} from '@luma.gl/gltools';\nimport Accessor from './accessor';\nimport Buffer from './buffer';\nimport VertexArrayObject from './vertex-array-object';\nimport {assert} from '../utils/assert';\nimport {stubRemovedMethods} from '../utils/stub-methods';\n\nconst ERR_ATTRIBUTE_TYPE =\n  'VertexArray: attributes must be Buffers or constants (i.e. typed array)';\n\n// This is done to support mat type attributes.\n// See section \"Notes about setting mat type attributes\"\n// in vertex-array.md\nconst MULTI_LOCATION_ATTRIBUTE_REGEXP = /^(.+)__LOCATION_([0-9]+)$/;\n\nconst DEPRECATIONS_V6 = [\n  'setBuffers',\n  'setGeneric',\n  'clearBindings',\n  'setLocations',\n  'setGenericValues',\n  'setDivisor',\n  'enable',\n  'disable'\n];\n\nexport default class VertexArray {\n  constructor(gl, opts = {}) {\n    // Use program's id if program is supplied but no id is supplied\n    const id = opts.id || (opts.program && opts.program.id);\n    // super(gl, Object.assign({}, opts, {id}));\n\n    this.id = id;\n    this.gl = gl;\n    this.configuration = null;\n\n    // Extracted information\n    this.elements = null;\n    this.elementsAccessor = null;\n    this.values = null;\n    this.accessors = null;\n    this.unused = null;\n    this.drawParams = null;\n    this.buffer = null; // For attribute 0 on desktops, and created when unbinding buffers\n\n    this.attributes = {};\n\n    this.vertexArrayObject = new VertexArrayObject(gl);\n\n    // Issue errors when using removed methods\n    stubRemovedMethods(this, 'VertexArray', 'v6.0', DEPRECATIONS_V6);\n\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  delete() {\n    if (this.buffer) {\n      this.buffer.delete();\n    }\n\n    this.vertexArrayObject.delete();\n  }\n\n  initialize(props = {}) {\n    this.reset();\n    this.configuration = null;\n    this.bindOnUse = false;\n    return this.setProps(props);\n  }\n\n  // Resets all attributes (to default valued constants)\n  reset() {\n    // this.vertexArrayObject.reset();\n\n    this.elements = null;\n    this.elementsAccessor = null;\n    const {MAX_ATTRIBUTES} = this.vertexArrayObject;\n    this.values = new Array(MAX_ATTRIBUTES).fill(null);\n    this.accessors = new Array(MAX_ATTRIBUTES).fill(null);\n    this.unused = {};\n\n    // Auto detects draw params\n    this.drawParams = null;\n\n    return this;\n  }\n\n  setProps(props) {\n    if ('program' in props) {\n      this.configuration = props.program && props.program.configuration;\n    }\n    if ('configuration' in props) {\n      this.configuration = props.configuration;\n    }\n    if ('attributes' in props) {\n      this.setAttributes(props.attributes);\n    }\n    if ('elements' in props) {\n      this.setElementBuffer(props.elements);\n    }\n    if ('bindOnUse' in props) {\n      props = props.bindOnUse;\n    }\n    return this;\n  }\n\n  // Automatically called if buffers changed through VertexArray API\n  clearDrawParams() {\n    this.drawParams = null;\n  }\n\n  getDrawParams() {\n    // Auto deduced draw parameters\n    this.drawParams = this.drawParams || this._updateDrawParams();\n\n    return this.drawParams;\n  }\n\n  // Set (bind) an array or map of vertex array buffers, either in numbered or named locations.\n  // For names that are not present in `location`, the supplied buffers will be ignored.\n  // if a single buffer of type GL.ELEMENT_ARRAY_BUFFER is present, it will be set as elements\n  //   Signatures:\n  //     {attributeName: buffer}\n  //     {attributeName: [buffer, accessor]}\n  //     {attributeName: (typed) array} => constant\n  setAttributes(attributes) {\n    Object.assign(this.attributes, attributes);\n    this.vertexArrayObject.bind(() => {\n      for (const locationOrName in attributes) {\n        const value = attributes[locationOrName];\n        this._setAttribute(locationOrName, value);\n      }\n      // Make sure we don't leave any bindings\n      this.gl.bindBuffer(GL.ARRAY_BUFFER, null);\n    });\n\n    return this;\n  }\n\n  // Set (bind) an elements buffer, for indexed rendering.\n  // Must be a Buffer bound to GL.ELEMENT_ARRAY_BUFFER. Constants not supported\n  setElementBuffer(elementBuffer = null, accessor = {}) {\n    this.elements = elementBuffer; // Save value for debugging\n    this.elementsAccessor = accessor;\n    this.clearDrawParams();\n    this.vertexArrayObject.setElementBuffer(elementBuffer, accessor);\n\n    return this;\n  }\n\n  // Set a location in vertex attributes array to a buffer\n  setBuffer(locationOrName, buffer, appAccessor = {}) {\n    // Check target\n    if (buffer.target === GL.ELEMENT_ARRAY_BUFFER) {\n      return this.setElementBuffer(buffer, appAccessor);\n    }\n\n    const {location, accessor} = this._resolveLocationAndAccessor(\n      locationOrName,\n      buffer,\n      buffer.accessor,\n      appAccessor\n    );\n\n    if (location >= 0) {\n      this.values[location] = buffer;\n      this.accessors[location] = accessor;\n      this.clearDrawParams();\n      this.vertexArrayObject.setBuffer(location, buffer, accessor);\n    }\n\n    return this;\n  }\n\n  // Set attribute to constant value (small typed array corresponding to one vertex' worth of data)\n  setConstant(locationOrName, arrayValue, appAccessor = {}) {\n    const {location, accessor} = this._resolveLocationAndAccessor(\n      locationOrName,\n      arrayValue,\n      // Ensure that size isn't taken from program for multi-column\n      // attributes\n      Object.assign({size: arrayValue.length}, appAccessor)\n    );\n\n    if (location >= 0) {\n      arrayValue = this.vertexArrayObject._normalizeConstantArrayValue(arrayValue);\n\n      this.values[location] = arrayValue;\n      this.accessors[location] = accessor;\n      this.clearDrawParams();\n\n      // NOTE: We set the actual constant value later on bind. We can't set the value now since\n      // constants are global and affect all other VertexArrays that have disabled attributes\n      // in the same location.\n      // We do disable the attribute which makes it use the global constant value at that location\n      this.vertexArrayObject.enable(location, false);\n    }\n\n    return this;\n  }\n\n  // Workaround for Chrome TransformFeedback binding issue\n  // If required, unbind temporarily to avoid conflicting with TransformFeedback\n  unbindBuffers() {\n    this.vertexArrayObject.bind(() => {\n      if (this.elements) {\n        this.vertexArrayObject.setElementBuffer(null);\n      }\n\n      // Chrome does not like buffers that are bound to several binding points,\n      // so we need to offer and unbind facility\n      // WebGL offers disabling, but no clear way to set a VertexArray buffer to `null`\n      // So we just bind all the attributes to the dummy \"attribute zero\" buffer\n      this.buffer = this.buffer || new Buffer(this.gl, {accessor: {size: 4}});\n\n      for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n        if (this.values[location] instanceof Buffer) {\n          this.gl.disableVertexAttribArray(location);\n          this.gl.bindBuffer(GL.ARRAY_BUFFER, this.buffer.handle);\n          this.gl.vertexAttribPointer(location, 1, GL.FLOAT, false, 0, 0);\n        }\n      }\n    });\n    return this;\n  }\n\n  // Workaround for Chrome TransformFeedback binding issue\n  // If required, rebind rebind after temporary unbind\n  bindBuffers() {\n    this.vertexArrayObject.bind(() => {\n      if (this.elements) {\n        this.setElementBuffer(this.elements);\n      }\n\n      for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n        const buffer = this.values[location];\n        if (buffer instanceof Buffer) {\n          this.setBuffer(location, buffer);\n        }\n      }\n    });\n    return this;\n  }\n\n  // Bind for use\n  // When a vertex array is about to be used, we must:\n  // - Set constant attributes (since these are stored on the context and reset on bind)\n  // - Check if we need to initialize the buffer\n  bindForDraw(vertexCount, instanceCount, func) {\n    let value;\n\n    this.vertexArrayObject.bind(() => {\n      // Make sure that any constant attributes are updated (stored on the context, not the VAO)\n      // Also handles attribute 0\n      this._setConstantAttributes(vertexCount, instanceCount);\n\n      value = func();\n    });\n\n    return value;\n  }\n\n  // PRIVATE\n\n  // Resolve locations and accessors\n  _resolveLocationAndAccessor(locationOrName, value, valueAccessor, appAccessor) {\n    const INVALID_RESULT = {\n      location: -1,\n      accessor: null\n    };\n\n    const {location, name} = this._getAttributeIndex(locationOrName);\n    if (!Number.isFinite(location) || location < 0) {\n      this.unused[locationOrName] = value;\n      log.once(3, () => `unused value ${locationOrName} in ${this.id}`)();\n      return INVALID_RESULT;\n    }\n\n    const accessInfo = this._getAttributeInfo(name || location);\n\n    // Attribute location wasn't directly found.\n    // Likely due to multi-location attributes (e.g. matrix)\n    if (!accessInfo) {\n      return INVALID_RESULT;\n    }\n\n    // Resolve the partial accessors into a final accessor\n    const currentAccessor = this.accessors[location] || {};\n    const accessor = Accessor.resolve(\n      accessInfo.accessor,\n      currentAccessor,\n      valueAccessor,\n      appAccessor\n    );\n\n    const {size, type} = accessor;\n    assert(Number.isFinite(size) && Number.isFinite(type));\n\n    return {location, accessor};\n  }\n\n  _getAttributeInfo(attributeName) {\n    return this.configuration && this.configuration.getAttributeInfo(attributeName);\n  }\n\n  _getAttributeIndex(locationOrName) {\n    const location = Number(locationOrName);\n    if (Number.isFinite(location)) {\n      return {location};\n    }\n\n    const multiLocation = MULTI_LOCATION_ATTRIBUTE_REGEXP.exec(locationOrName);\n    const name = multiLocation ? multiLocation[1] : locationOrName;\n    const locationOffset = multiLocation ? Number(multiLocation[2]) : 0;\n\n    if (this.configuration) {\n      return {\n        location: this.configuration.getAttributeLocation(name) + locationOffset,\n        name\n      };\n    }\n\n    return {location: -1};\n  }\n\n  _setAttribute(locationOrName, value) {\n    if (value instanceof Buffer) {\n      //  Signature: {attributeName: Buffer}\n      this.setBuffer(locationOrName, value);\n    } else if (Array.isArray(value) && value.length && value[0] instanceof Buffer) {\n      // Signature: {attributeName: [buffer, accessor]}\n      const buffer = value[0];\n      const accessor = value[1];\n      this.setBuffer(locationOrName, buffer, accessor);\n    } else if (ArrayBuffer.isView(value) || Array.isArray(value)) {\n      // Signature: {attributeName: constant}, constant == short (typed) array\n      const constant = value;\n      this.setConstant(locationOrName, constant);\n    } else if (value.buffer instanceof Buffer) {\n      // luma.gl v7: Support accessor objects with 'buffer' field\n      // for interleaved data\n      // Signature: {attributeName: {...accessor, buffer}}\n      const accessor = value;\n      this.setBuffer(locationOrName, accessor.buffer, accessor);\n    } else {\n      throw new Error(ERR_ATTRIBUTE_TYPE);\n    }\n  }\n\n  // Updates all constant attribute values (constants are used when vertex attributes are disabled).\n  // This needs to be done repeatedly since in contrast to buffer bindings,\n  // constants are stored on the WebGL context, not the VAO\n  _setConstantAttributes(vertexCount, instanceCount) {\n    // TODO - use accessor to determine what length to use\n    const elementCount = Math.max(vertexCount | 0, instanceCount | 0);\n    let constant = this.values[0];\n    if (ArrayBuffer.isView(constant)) {\n      this._setConstantAttributeZero(constant, elementCount);\n    }\n\n    for (let location = 1; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n      constant = this.values[location];\n      if (ArrayBuffer.isView(constant)) {\n        this._setConstantAttribute(location, constant);\n      }\n    }\n  }\n\n  _setConstantAttributeZero(constant, elementCount) {\n    if (VertexArrayObject.isSupported(this.gl, {constantAttributeZero: true})) {\n      this._setConstantAttribute(0, constant);\n      return;\n    }\n\n    // Get a dummy buffer populated with repeated constants\n    const buffer = this.vertexArrayObject.getConstantBuffer(elementCount, constant);\n\n    // Set the buffer on location 0\n    this.vertexArrayObject.setBuffer(0, buffer, this.accessors[0]);\n  }\n\n  _setConstantAttribute(location, constant) {\n    VertexArrayObject.setConstant(this.gl, location, constant);\n  }\n\n  // Walks the buffers and updates draw parameters\n  _updateDrawParams() {\n    const drawParams = {\n      isIndexed: false,\n      isInstanced: false,\n      indexCount: Infinity,\n      vertexCount: Infinity,\n      instanceCount: Infinity\n    };\n\n    for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n      this._updateDrawParamsForLocation(drawParams, location);\n    }\n\n    if (this.elements) {\n      // indexing is autodetected - buffer with target GL.ELEMENT_ARRAY_BUFFER\n      // index type is saved for drawElement calls\n      drawParams.elementCount = this.elements.getElementCount(this.elements.accessor);\n      drawParams.isIndexed = true;\n      drawParams.indexType = this.elementsAccessor.type || this.elements.accessor.type;\n      drawParams.indexOffset = this.elementsAccessor.offset || 0;\n    }\n\n    // Post-calculation checks\n    if (drawParams.indexCount === Infinity) {\n      drawParams.indexCount = 0;\n    }\n    if (drawParams.vertexCount === Infinity) {\n      drawParams.vertexCount = 0;\n    }\n    if (drawParams.instanceCount === Infinity) {\n      drawParams.instanceCount = 0;\n    }\n\n    return drawParams;\n  }\n\n  _updateDrawParamsForLocation(drawParams, location) {\n    const value = this.values[location];\n    const accessor = this.accessors[location];\n\n    if (!value) {\n      return;\n    }\n\n    // Check if instanced (whether buffer or constant)\n    const {divisor} = accessor;\n    const isInstanced = divisor > 0;\n    drawParams.isInstanced = drawParams.isInstanced || isInstanced;\n\n    if (value instanceof Buffer) {\n      const buffer = value;\n\n      if (isInstanced) {\n        // instance attribute\n        const instanceCount = buffer.getVertexCount(accessor);\n        drawParams.instanceCount = Math.min(drawParams.instanceCount, instanceCount);\n      } else {\n        // normal attribute\n        const vertexCount = buffer.getVertexCount(accessor);\n        drawParams.vertexCount = Math.min(drawParams.vertexCount, vertexCount);\n      }\n    }\n  }\n\n  // DEPRECATED in v6.x - but not warnings not properly implemented\n\n  setElements(elementBuffer = null, accessor = {}) {\n    log.deprecated('setElements', 'setElementBuffer')();\n    return this.setElementBuffer(elementBuffer, accessor);\n  }\n}\n","import {getCompositeGLType} from '../webgl-utils/attribute-utils';\n\nexport function getDebugTableForProgramConfiguration(config) {\n  const table = {};\n\n  const header = `Accessors for ${config.id}`;\n\n  for (const attributeInfo of config.attributeInfos) {\n    if (attributeInfo) {\n      const glslDeclaration = getGLSLDeclaration(attributeInfo);\n      table[`in ${glslDeclaration}`] = {[header]: JSON.stringify(attributeInfo.accessor)};\n    }\n  }\n\n  for (const varyingInfo of config.varyingInfos) {\n    if (varyingInfo) {\n      const glslDeclaration = getGLSLDeclaration(varyingInfo);\n      table[`out ${glslDeclaration}`] = {[header]: JSON.stringify(varyingInfo.accessor)};\n    }\n  }\n\n  return table;\n}\n\nfunction getGLSLDeclaration(attributeInfo) {\n  const {type, size} = attributeInfo.accessor;\n  const typeAndName = getCompositeGLType(type, size);\n  if (typeAndName) {\n    return `${typeAndName.name} ${attributeInfo.name}`;\n  }\n  return attributeInfo.name;\n}\n","import {assert} from '../utils/assert';\nimport {formatValue} from '../utils/format-value';\n\n// Prepares a table suitable for console.table\n/* eslint-disable max-statements, complexity */\nexport function getDebugTableForUniforms({\n  header = 'Uniforms',\n  program,\n  uniforms,\n  undefinedOnly = false\n}) {\n  assert(program);\n\n  const SHADER_MODULE_UNIFORM_REGEXP = '.*_.*';\n  const PROJECT_MODULE_UNIFORM_REGEXP = '.*Matrix'; // TODO - Use explicit list\n\n  const uniformLocations = program._uniformSetters;\n  const table = {}; // {[header]: {}};\n\n  // Add program's provided uniforms (in alphabetical order)\n  const uniformNames = Object.keys(uniformLocations).sort();\n\n  let count = 0;\n\n  // First add non-underscored uniforms (assumed not coming from shader modules)\n  for (const uniformName of uniformNames) {\n    if (\n      !uniformName.match(SHADER_MODULE_UNIFORM_REGEXP) &&\n      !uniformName.match(PROJECT_MODULE_UNIFORM_REGEXP)\n    ) {\n      if (addUniformToTable({table, header, uniforms, uniformName, undefinedOnly})) {\n        count++;\n      }\n    }\n  }\n\n  // add underscored uniforms (assumed from shader modules)\n  for (const uniformName of uniformNames) {\n    if (uniformName.match(PROJECT_MODULE_UNIFORM_REGEXP)) {\n      if (addUniformToTable({table, header, uniforms, uniformName, undefinedOnly})) {\n        count++;\n      }\n    }\n  }\n\n  for (const uniformName of uniformNames) {\n    if (!table[uniformName]) {\n      if (addUniformToTable({table, header, uniforms, uniformName, undefinedOnly})) {\n        count++;\n      }\n    }\n  }\n\n  // Create a table of unused uniforms\n  let unusedCount = 0;\n  const unusedTable = {};\n  if (!undefinedOnly) {\n    for (const uniformName in uniforms) {\n      const uniform = uniforms[uniformName];\n      if (!table[uniformName]) {\n        unusedCount++;\n        unusedTable[uniformName] = {\n          Type: `NOT USED: ${uniform}`,\n          [header]: formatValue(uniform)\n        };\n      }\n    }\n  }\n\n  return {table, count, unusedTable, unusedCount};\n}\n\n// Helper\nfunction addUniformToTable({table, header, uniforms, uniformName, undefinedOnly}) {\n  const value = uniforms[uniformName];\n  const isDefined = isUniformDefined(value);\n  if (!undefinedOnly || !isDefined) {\n    table[uniformName] = {\n      // Add program's unprovided uniforms\n      [header]: isDefined ? formatValue(value) : 'N/A',\n      'Uniform Type': isDefined ? value : 'NOT PROVIDED'\n    };\n    return true;\n  }\n  return false;\n}\n\nfunction isUniformDefined(value) {\n  return value !== undefined && value !== null;\n}\n","import Buffer from '../classes/buffer';\nimport {getKey} from '../webgl-utils/constants-to-keys';\nimport {getCompositeGLType} from '../webgl-utils/attribute-utils';\nimport {formatValue} from '../utils/format-value';\n\n// Creates object suitable as input for console.table\nexport function getDebugTableForVertexArray({vertexArray, header = 'Attributes'}) {\n  if (!vertexArray.configuration) {\n    return {};\n  }\n\n  const table = {}; // {[header]: {}};\n\n  // Add index (elements) if available\n  if (vertexArray.elements) {\n    // const elements = Object.assign({size: 1}, vertexArray.elements);\n    table.ELEMENT_ARRAY_BUFFER = getDebugTableRow(vertexArray, vertexArray.elements, null, header);\n  }\n\n  // Add used attributes\n  const attributes = vertexArray.values;\n\n  for (const attributeLocation in attributes) {\n    const info = vertexArray._getAttributeInfo(attributeLocation);\n    if (info) {\n      let rowHeader = `${attributeLocation}: ${info.name}`;\n      const accessor = vertexArray.accessors[info.location];\n      if (accessor) {\n        rowHeader = `${attributeLocation}: ${getGLSLDeclaration(info.name, accessor)}`;\n      }\n      table[rowHeader] = getDebugTableRow(\n        vertexArray,\n        attributes[attributeLocation],\n        accessor,\n        header\n      );\n    }\n  }\n\n  return table;\n}\n\n/* eslint-disable max-statements */\nfunction getDebugTableRow(vertexArray, attribute, accessor, header) {\n  const {gl} = vertexArray;\n\n  if (!attribute) {\n    return {\n      [header]: 'null',\n      'Format ': 'N/A'\n    };\n  }\n\n  let type = 'NOT PROVIDED';\n  let size = 1;\n  let verts = 0;\n  let bytes = 0;\n\n  let isInteger;\n  let marker;\n  let value;\n\n  if (accessor) {\n    type = accessor.type;\n    size = accessor.size;\n\n    // Generate a type name by dropping Array from Float32Array etc.\n    type = String(type).replace('Array', '');\n\n    // Look for 'nt' to detect integer types, e.g. Int32Array, Uint32Array\n    isInteger = type.indexOf('nt') !== -1;\n  }\n\n  if (attribute instanceof Buffer) {\n    const buffer = attribute;\n\n    const {data, changed} = buffer.getDebugData();\n    marker = changed ? '*' : '';\n\n    value = data;\n    // @ts-ignore\n    bytes = buffer.byteLength;\n    // @ts-ignore\n    verts = bytes / data.BYTES_PER_ELEMENT / size;\n\n    let format;\n\n    if (accessor) {\n      const instanced = accessor.divisor > 0;\n      format = `${instanced ? 'I ' : 'P '} ${verts} (x${size}=${bytes} bytes ${getKey(gl, type)})`;\n    } else {\n      // element buffer\n      isInteger = true;\n      format = `${bytes} bytes`;\n    }\n\n    return {\n      [header]: `${marker}${formatValue(value, {size, isInteger})}`,\n      'Format ': format\n    };\n  }\n\n  // CONSTANT VALUE\n  value = attribute;\n  size = attribute.length;\n  // Generate a type name by dropping Array from Float32Array etc.\n  type = String(attribute.constructor.name).replace('Array', '');\n  // Look for 'nt' to detect integer types, e.g. Int32Array, Uint32Array\n  isInteger = type.indexOf('nt') !== -1;\n\n  return {\n    [header]: `${formatValue(value, {size, isInteger})} (constant)`,\n    'Format ': `${size}x${type} (constant)`\n  };\n}\n/* eslint-ensable max-statements */\n\nfunction getGLSLDeclaration(name, accessor) {\n  const {type, size} = accessor;\n  const typeAndName = getCompositeGLType(type, size);\n  return typeAndName ? `${name} (${typeAndName.name})` : name;\n}\n","// Feature detection for WebGL\n//\n// Provides a function that enables simple checking of which WebGL features are\n// available in an WebGL1 or WebGL2 environment.\n\nimport WEBGL_FEATURES from './webgl-features-table';\nimport {isWebGL2, log} from '@luma.gl/gltools';\nimport {assert} from '../utils/assert';\n\nconst LOG_UNSUPPORTED_FEATURE = 2;\n\n// Check one feature\nexport function hasFeature(gl, feature) {\n  return hasFeatures(gl, feature);\n}\n\n// Check one or more features\nexport function hasFeatures(gl, features) {\n  features = Array.isArray(features) ? features : [features];\n  return features.every(feature => {\n    return isFeatureSupported(gl, feature);\n  });\n}\n\n// Return a list of supported features\nexport function getFeatures(gl) {\n  gl.luma = gl.luma || {};\n  gl.luma.caps = gl.luma.caps || {};\n  for (const cap in WEBGL_FEATURES) {\n    if (gl.luma.caps[cap] === undefined) {\n      gl.luma.caps[cap] = isFeatureSupported(gl, cap);\n    }\n  }\n  return gl.luma.caps;\n}\n\n// TODO - cache the value\nfunction isFeatureSupported(gl, cap) {\n  gl.luma = gl.luma || {};\n  gl.luma.caps = gl.luma.caps || {};\n\n  if (gl.luma.caps[cap] === undefined) {\n    gl.luma.caps[cap] = queryFeature(gl, cap);\n  }\n\n  if (!gl.luma.caps[cap]) {\n    log.log(LOG_UNSUPPORTED_FEATURE, `Feature: ${cap} not supported`)();\n  }\n\n  return gl.luma.caps[cap];\n}\n\nfunction queryFeature(gl, cap) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n\n  let isSupported;\n\n  // Get extension name from table\n  const featureDefinition = isWebGL2(gl) ? feature[1] || feature[0] : feature[0];\n\n  // Check if the value is dependent on checking one or more extensions\n  if (typeof featureDefinition === 'function') {\n    isSupported = featureDefinition(gl);\n  } else if (Array.isArray(featureDefinition)) {\n    isSupported = true;\n    for (const extension of featureDefinition) {\n      isSupported = isSupported && Boolean(gl.getExtension(extension));\n    }\n  } else if (typeof featureDefinition === 'string') {\n    isSupported = Boolean(gl.getExtension(featureDefinition));\n  } else if (typeof featureDefinition === 'boolean') {\n    isSupported = featureDefinition;\n  } else {\n    assert(false);\n  }\n\n  return isSupported;\n}\n","import Framebuffer from '../classes/framebuffer';\nimport Texture2D from '../classes/texture-2d';\n// TODO - this should be the default export, test cases need updating\nexport const FEATURES = {\n  WEBGL2: 'WEBGL2',\n\n  // API SUPPORT\n  VERTEX_ARRAY_OBJECT: 'VERTEX_ARRAY_OBJECT',\n  TIMER_QUERY: 'TIMER_QUERY',\n  INSTANCED_RENDERING: 'INSTANCED_RENDERING',\n  MULTIPLE_RENDER_TARGETS: 'MULTIPLE_RENDER_TARGETS',\n\n  // FEATURES\n  ELEMENT_INDEX_UINT32: 'ELEMENT_INDEX_UINT32',\n\n  // BLENDING\n  BLEND_EQUATION_MINMAX: 'BLEND_EQUATION_MINMAX',\n  FLOAT_BLEND: 'FLOAT_BLEND',\n\n  // TEXTURES: '// TEXTURES', RENDERBUFFERS\n  COLOR_ENCODING_SRGB: 'COLOR_ENCODING_SRGB',\n\n  // TEXTURES\n  TEXTURE_DEPTH: 'TEXTURE_DEPTH',\n  TEXTURE_FLOAT: 'TEXTURE_FLOAT',\n  TEXTURE_HALF_FLOAT: 'TEXTURE_HALF_FLOAT',\n\n  TEXTURE_FILTER_LINEAR_FLOAT: 'TEXTURE_FILTER_LINEAR_FLOAT',\n  TEXTURE_FILTER_LINEAR_HALF_FLOAT: 'TEXTURE_FILTER_LINEAR_HALF_FLOAT',\n  TEXTURE_FILTER_ANISOTROPIC: 'TEXTURE_FILTER_ANISOTROPIC',\n\n  // FRAMEBUFFERS: '// FRAMEBUFFERS', TEXTURES AND RENDERBUFFERS\n  COLOR_ATTACHMENT_RGBA32F: 'COLOR_ATTACHMENT_RGBA32F',\n  COLOR_ATTACHMENT_FLOAT: 'COLOR_ATTACHMENT_FLOAT',\n  COLOR_ATTACHMENT_HALF_FLOAT: 'COLOR_ATTACHMENT_HALF_FLOAT',\n\n  // GLSL extensions\n  GLSL_FRAG_DATA: 'GLSL_FRAG_DATA',\n  GLSL_FRAG_DEPTH: 'GLSL_FRAG_DEPTH',\n  GLSL_DERIVATIVES: 'GLSL_DERIVATIVES',\n  GLSL_TEXTURE_LOD: 'GLSL_TEXTURE_LOD'\n};\n\n// function to test if Float 32 bit format texture can be bound as color attachment\nfunction checkFloat32ColorAttachment(gl) {\n  const testTexture = new Texture2D(gl, {\n    format: gl.RGBA,\n    type: gl.FLOAT,\n    dataFormat: gl.RGBA\n  });\n  const testFb = new Framebuffer(gl, {\n    id: `test-framebuffer`,\n    check: false,\n    attachments: {\n      [gl.COLOR_ATTACHMENT0]: testTexture\n    }\n  });\n  const status = testFb.getStatus();\n  testTexture.delete();\n  testFb.delete();\n  return status === gl.FRAMEBUFFER_COMPLETE;\n}\n\n// Defines luma.gl \"feature\" names and semantics\n// Format: 'feature-name: [WebGL1 support, WebGL2 support] / [WebGL1 and WebGL2 support]', when support is 'string' it is the name of the extension\nexport default {\n  [FEATURES.WEBGL2]: [false, true],\n\n  // API SUPPORT\n  [FEATURES.VERTEX_ARRAY_OBJECT]: ['OES_vertex_array_object', true],\n  [FEATURES.TIMER_QUERY]: ['EXT_disjoint_timer_query', 'EXT_disjoint_timer_query_webgl2'],\n  [FEATURES.INSTANCED_RENDERING]: ['ANGLE_instanced_arrays', true],\n  [FEATURES.MULTIPLE_RENDER_TARGETS]: ['WEBGL_draw_buffers', true],\n\n  // FEATURES\n  [FEATURES.ELEMENT_INDEX_UINT32]: ['OES_element_index_uint', true],\n\n  // BLENDING\n  [FEATURES.BLEND_EQUATION_MINMAX]: ['EXT_blend_minmax', true],\n  [FEATURES.FLOAT_BLEND]: ['EXT_float_blend'],\n\n  // TEXTURES, RENDERBUFFERS\n  [FEATURES.COLOR_ENCODING_SRGB]: ['EXT_sRGB', true],\n\n  // TEXTURES\n  [FEATURES.TEXTURE_DEPTH]: ['WEBGL_depth_texture', true],\n  [FEATURES.TEXTURE_FLOAT]: ['OES_texture_float', true],\n  [FEATURES.TEXTURE_HALF_FLOAT]: ['OES_texture_half_float', true],\n\n  [FEATURES.TEXTURE_FILTER_LINEAR_FLOAT]: ['OES_texture_float_linear'],\n  [FEATURES.TEXTURE_FILTER_LINEAR_HALF_FLOAT]: ['OES_texture_half_float_linear'],\n  [FEATURES.TEXTURE_FILTER_ANISOTROPIC]: ['EXT_texture_filter_anisotropic'],\n\n  // FRAMEBUFFERS, TEXTURES AND RENDERBUFFERS\n  [FEATURES.COLOR_ATTACHMENT_RGBA32F]: [checkFloat32ColorAttachment, 'EXT_color_buffer_float'],\n  [FEATURES.COLOR_ATTACHMENT_FLOAT]: [false, 'EXT_color_buffer_float'],\n  [FEATURES.COLOR_ATTACHMENT_HALF_FLOAT]: ['EXT_color_buffer_half_float'],\n\n  // GLSL extensions\n  [FEATURES.GLSL_FRAG_DATA]: ['WEBGL_draw_buffers', true],\n  [FEATURES.GLSL_FRAG_DEPTH]: ['EXT_frag_depth', true],\n  [FEATURES.GLSL_DERIVATIVES]: ['OES_standard_derivatives', true],\n  [FEATURES.GLSL_TEXTURE_LOD]: ['EXT_shader_texture_lod', true]\n};\n","// TODO - formatGLSLCompilerError should not depend on this\nimport getShaderName from './get-shader-name';\nimport getShaderTypeName from './get-shader-type-name';\n\n// Formats GLSL compiler error log into single string\nexport default function formatGLSLCompilerError(errLog, src, shaderType) {\n  const {shaderName, errors, warnings} = parseGLSLCompilerError(errLog, src, shaderType);\n  return `GLSL compilation error in ${shaderName}\\n\\n${errors}\\n${warnings}`;\n}\n\n/**\n * Parse a GLSL compiler error log into a string showing the source code around each error.\n * Based on https://github.com/wwwtyro/gl-format-compiler-error (public domain)\n */\n/* eslint-disable no-continue, max-statements */\nexport function parseGLSLCompilerError(errLog, src, shaderType, shaderName) {\n  const errorStrings = errLog.split(/\\r?\\n/);\n  const errors = {};\n  const warnings = {};\n\n  // Patch the shader name\n  const name = shaderName || getShaderName(src) || '(unnamed)';\n  const shaderDescription = `${getShaderTypeName(shaderType)} shader ${name}`;\n\n  // Parse the error - note: browser and driver dependent\n  for (let i = 0; i < errorStrings.length; i++) {\n    const errorString = errorStrings[i];\n    if (errorString.length <= 1) {\n      continue;\n    }\n    const segments = errorString.split(':');\n    const type = segments[0];\n    const line = parseInt(segments[2], 10);\n    if (isNaN(line)) {\n      throw new Error(`GLSL compilation error in ${shaderDescription}: ${errLog}`);\n    }\n    if (type !== 'WARNING') {\n      errors[line] = errorString;\n    } else {\n      warnings[line] = errorString;\n    }\n  }\n\n  // Format the error inline with the code\n  const lines = addLineNumbers(src);\n\n  return {\n    shaderName: shaderDescription,\n    errors: formatErrors(errors, lines),\n    warnings: formatErrors(warnings, lines)\n  };\n}\n\n// helper function, outputs annotated errors or warnings\nfunction formatErrors(errors, lines) {\n  let message = '';\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    if (!errors[i + 3] && !errors[i + 2] && !errors[i + 1]) {\n      continue;\n    }\n    message += `${line}\\n`;\n    if (errors[i + 1]) {\n      const error = errors[i + 1];\n      const segments = error.split(':', 3);\n      const type = segments[0];\n      const column = parseInt(segments[1], 10) || 0;\n      const err = error.substring(segments.join(':').length + 1).trim();\n      message += padLeft(`^^^ ${type}: ${err}\\n\\n`, column);\n    }\n  }\n  return message;\n}\n\n/**\n * Prepends line numbers to each line of a string.\n * The line numbers will be left-padded with spaces to ensure an\n * aligned layout when rendered using monospace fonts.\n * @param {String} string - multi-line string to add line numbers to\n * @param {Number} start=1 - number of spaces to add\n * @param {String} delim =': ' - injected between line number and original line\n * @return {String[]} strings - array of string, one per line, with line numbers added\n */\nfunction addLineNumbers(string, start = 1, delim = ': ') {\n  const lines = string.split(/\\r?\\n/);\n  const maxDigits = String(lines.length + start - 1).length;\n  return lines.map((line, i) => {\n    const lineNumber = String(i + start);\n    const digits = lineNumber.length;\n    const prefix = padLeft(lineNumber, maxDigits - digits);\n    return prefix + delim + line;\n  });\n}\n\n/**\n * Pads a string with a number of spaces (space characters) to the left\n * @param {String} string - string to pad\n * @param {Number} digits - number of spaces to add\n * @return {String} string - The padded string\n */\nfunction padLeft(string, digits) {\n  let result = '';\n  for (let i = 0; i < digits; ++i) {\n    result += ' ';\n  }\n  return `${result}${string}`;\n}\n","// Supports GLSLIFY style naming of shaders\n// #define SHADER_NAME ...\nexport default function getShaderName(shader, defaultName = 'unnamed') {\n  const SHADER_NAME_REGEXP = /#define[\\s*]SHADER_NAME[\\s*]([A-Za-z0-9_-]+)[\\s*]/;\n  const match = shader.match(SHADER_NAME_REGEXP);\n  return match ? match[1] : defaultName;\n}\n","const GL_FRAGMENT_SHADER = 0x8b30;\nconst GL_VERTEX_SHADER = 0x8b31;\n\nexport default function getShaderTypeName(type) {\n  switch (type) {\n    case GL_FRAGMENT_SHADER:\n      return 'fragment';\n    case GL_VERTEX_SHADER:\n      return 'vertex';\n    default:\n      return 'unknown type';\n  }\n}\n","import {log} from '@luma.gl/gltools';\nimport {Stats} from '@probe.gl/stats';\nimport {isBrowser} from '@probe.gl/env';\n\n// Version detection using babel plugin\n/* global __VERSION__ */\n// @ts-ignore\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\n\nconst STARTUP_MESSAGE = 'set luma.log.level=1 (or higher) to trace rendering';\n// Assign luma.log.level in console to control logging: \\\n// 0: none, 1: minimal, 2: verbose, 3: attribute/uniforms, 4: gl logs\n// luma.log.break[], set to gl funcs, luma.log.profile[] set to model names`;\n\nexport class StatsManager {\n  constructor() {\n    this.stats = new Map();\n  }\n\n  get(name) {\n    if (!this.stats.has(name)) {\n      this.stats.set(name, new Stats({id: name}));\n    }\n\n    return this.stats.get(name);\n  }\n}\n\nconst lumaStats = new StatsManager();\n\nif (globalThis.luma && globalThis.luma.VERSION !== VERSION) {\n  throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${VERSION}`);\n}\n\nif (!globalThis.luma) {\n  if (isBrowser()) {\n    log.log(1, `luma.gl ${VERSION} - ${STARTUP_MESSAGE}`)();\n  }\n\n  globalThis.luma = globalThis.luma || {\n    VERSION,\n    version: VERSION,\n    log,\n\n    // A global stats object that various components can add information to\n    // E.g. see webgl/resource.js\n    stats: lumaStats,\n\n    // Keep some luma globals in a sub-object\n    // This allows us to dynamically detect if certain modules have been\n    // included (such as IO and headless) and enable related functionality,\n    // without unconditionally requiring and thus bundling big dependencies\n    // into the app.\n    globals: {\n      modules: {},\n      nodeIO: {}\n    }\n  };\n}\n\nexport {lumaStats};\nexport default globalThis.luma;\n","let arrayBuffer = null;\n\nexport function getScratchArrayBuffer(byteLength) {\n  if (!arrayBuffer || arrayBuffer.byteLength < byteLength) {\n    arrayBuffer = new ArrayBuffer(byteLength);\n  }\n  return arrayBuffer;\n}\n\nexport function getScratchArray(Type, length) {\n  const scratchArrayBuffer = getScratchArrayBuffer(Type.BYTES_PER_ELEMENT * length);\n  return new Type(scratchArrayBuffer, 0, length); // arrayBuffer, byteOffset, length (in elements)\n}\n\n// Uses copyWithin to significantly speed up typed array value filling\nexport function fillArray({target, source, start = 0, count = 1}) {\n  const length = source.length;\n  const total = count * length;\n  let copied = 0;\n  for (let i = start; copied < length; copied++) {\n    target[i++] = source[copied];\n  }\n\n  while (copied < total) {\n    // If we have copied less than half, copy everything we got\n    // else copy remaining in one operation\n    if (copied < total - copied) {\n      target.copyWithin(start + copied, start, start + copied);\n      copied *= 2;\n    } else {\n      target.copyWithin(start + copied, start, start + total - copied);\n      copied = total;\n    }\n  }\n\n  return target;\n}\n\n/*\n\n// Creates a new Uint8Array based on two different ArrayBuffers\n// @private\n// @param {ArrayBuffers} buffer1 The first buffer.\n// @param {ArrayBuffers} buffer2 The second buffer.\n// @return {ArrayBuffers} The new ArrayBuffer created out of the two.\n//\nexport function copyArrayBuffer(\n  targetBuffer, sourceBuffer, byteOffset, byteLength = sourceBuffer.byteLength\n) {\n  const targetArray = new Uint8Array(targetBuffer, byteOffset, byteLength);\n  const sourceArray = new Uint8Array(sourceBuffer);\n  targetArray.set(sourceArray);\n  return targetBuffer;\n}\n\n*/\n","// Recommendation is to ignore message but current test suite checks agains the\n// message so keep it for now.\nexport function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'luma.gl: assertion failed.');\n  }\n}\n","/* Use as\nimport {checkProps} from '../util/check-props;'\n\nconst PROP_CHECKS = {\n  // Removed props no longer supported, print error and link to upgrade guide\n  removedProps: {\n  },\n  // Deprecated props\n  deprecatedProps: {\n    offset: 'accessor',\n    stride: 'accessor',\n    type: 'accessor',\n    size: 'accessor',\n    divisor: 'accessor',\n    normalized: 'accessor',\n    integer: 'accessor'\n  },\n  // Deprecated props that can be autosubstituted, print warning and return updated props object\n  replacedProps: {\n    bytes: 'byteLength'\n  }\n}\n\nclass Buffer {\n  setProps(props) {\n    checkProps('Buffer', props, PROP_CHECKS);\n  }\n}\n*/\nimport {log} from '@luma.gl/gltools';\n\nexport function checkProps(className, props, propChecks) {\n  const {removedProps = {}, deprecatedProps = {}, replacedProps = {}} = propChecks;\n\n  // removedProps: Removed props no longer supported\n  // print error and link to upgrade guide\n  for (const propName in removedProps) {\n    if (propName in props) {\n      const replacementProp = removedProps[propName];\n      const replacement = replacementProp ? `${className}.${removedProps[propName]}` : 'N/A';\n      log.removed(`${className}.${propName}`, replacement)();\n    }\n  }\n\n  // deprecatedProps: Deprecated props that can not be autosubstituted\n  // print warning and rely on caller to substitute\n  for (const propName in deprecatedProps) {\n    if (propName in props) {\n      const replacementProp = deprecatedProps[propName];\n      log.deprecated(`${className}.${propName}`, `${className}.${replacementProp}`)();\n    }\n  }\n\n  // replacedProps: Deprecated props that can be autosubstituted\n  // print warning and return updated props object\n  let newProps = null;\n  for (const propName in replacedProps) {\n    if (propName in props) {\n      const replacementProp = replacedProps[propName];\n      log.deprecated(`${className}.${propName}`, `${className}.${replacementProp}`)();\n      newProps = newProps || Object.assign({}, props);\n      newProps[replacementProp] = props[propName];\n      delete newProps[propName];\n    }\n  }\n\n  return newProps || props;\n}\n","// TODO / DEPRECATED - delete when confident that probe.gl logging implements all opts\n/* eslint-disable no-console */\nfunction formatArrayValue(v, opts) {\n  const {maxElts = 16, size = 1} = opts;\n  let string = '[';\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += `,${i % size === 0 ? ' ' : ''}`;\n    }\n    string += formatValue(v[i], opts);\n  }\n  const terminator = v.length > maxElts ? '...' : ']';\n  return `${string}${terminator}`;\n}\n\nexport function formatValue(v, opts = {}) {\n  const EPSILON = 1e-16;\n  const {isInteger = false} = opts;\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, opts);\n  }\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n  if (isInteger) {\n    return v.toFixed(0);\n  }\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    return v.toFixed(0);\n  }\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n","import {assert} from '../utils/assert';\n\nlet pathPrefix = '';\n\n/*\n * Set a relative path prefix\n */\nexport function setPathPrefix(prefix) {\n  pathPrefix = prefix;\n}\n\n// Reads raw file data from:\nexport function loadFile(url, options = {}) {\n  assert(typeof url === 'string');\n  url = pathPrefix + url;\n  const dataType = options.dataType || 'text';\n  return fetch(url, options).then(res => res[dataType]());\n}\n\n/*\n * Loads images asynchronously\n * image.crossOrigin can be set via opts.crossOrigin, default to 'anonymous'\n * returns a promise tracking the load\n */\nexport function loadImage(url, opts) {\n  assert(typeof url === 'string');\n  url = pathPrefix + url;\n  return new Promise((resolve, reject) => {\n    try {\n      const image = new Image();\n      image.onload = () => resolve(image);\n      image.onerror = () => reject(new Error(`Could not load image ${url}.`));\n      image.crossOrigin = (opts && opts.crossOrigin) || 'anonymous';\n      image.src = url;\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n","import {log} from '@luma.gl/gltools';\n\n// Install stubs for removed methods\nexport function stubRemovedMethods(instance, className, version, methodNames) {\n  const upgradeMessage = `See luma.gl ${version} Upgrade Guide at \\\nhttps://luma.gl/docs/upgrade-guide`;\n\n  const prototype = Object.getPrototypeOf(instance);\n\n  methodNames.forEach(methodName => {\n    if (prototype.methodName) {\n      return;\n    }\n\n    prototype[methodName] = () => {\n      log.removed(`Calling removed method ${className}.${methodName}: `, upgradeMessage)();\n      throw new Error(methodName);\n    };\n  });\n}\n","import {assert} from './assert';\n\nconst uidCounters = {};\n\n/**\n * Returns a UID.\n * @param {string} id= - Identifier base name\n * @return {string} uid\n **/\nexport function uid(id = 'id') {\n  uidCounters[id] = uidCounters[id] || 1;\n  const count = uidCounters[id]++;\n  return `${id}-${count}`;\n}\n\n/**\n * Verifies if a given number is power of two or not.\n * @param {object} n - The number to check.\n * @return {boolean} Returns true if the given number is power of 2, false otherwise.\n **/\nexport function isPowerOfTwo(n) {\n  assert(typeof n === 'number', 'Input must be a number');\n  return n && (n & (n - 1)) === 0;\n}\n\n// Returns true if given object is empty, false otherwise.\nexport function isObjectEmpty(obj) {\n  let isEmpty = true;\n  /* eslint-disable no-unused-vars  */\n  for (const key in obj) {\n    isEmpty = false;\n    break;\n  }\n  /* eslint-enable no-unused-vars  */\n  return isEmpty;\n}\n","/* eslint-disable camelcase */\nimport {assert} from '../utils/assert';\n\nconst GL_BYTE = 0x1400;\nconst GL_UNSIGNED_BYTE = 0x1401;\nconst GL_SHORT = 0x1402;\nconst GL_UNSIGNED_SHORT = 0x1403;\n\nconst GL_POINTS = 0x0;\nconst GL_LINES = 0x1;\nconst GL_LINE_LOOP = 0x2;\nconst GL_LINE_STRIP = 0x3;\nconst GL_TRIANGLES = 0x4;\nconst GL_TRIANGLE_STRIP = 0x5;\nconst GL_TRIANGLE_FAN = 0x6;\n\n// Local constants - these will \"collapse\" during minification\nconst GL_FLOAT = 0x1406;\nconst GL_FLOAT_VEC2 = 0x8b50;\nconst GL_FLOAT_VEC3 = 0x8b51;\nconst GL_FLOAT_VEC4 = 0x8b52;\n\nconst GL_INT = 0x1404;\nconst GL_INT_VEC2 = 0x8b53;\nconst GL_INT_VEC3 = 0x8b54;\nconst GL_INT_VEC4 = 0x8b55;\n\nconst GL_UNSIGNED_INT = 0x1405;\nconst GL_UNSIGNED_INT_VEC2 = 0x8dc6;\nconst GL_UNSIGNED_INT_VEC3 = 0x8dc7;\nconst GL_UNSIGNED_INT_VEC4 = 0x8dc8;\n\nconst GL_BOOL = 0x8b56;\nconst GL_BOOL_VEC2 = 0x8b57;\nconst GL_BOOL_VEC3 = 0x8b58;\nconst GL_BOOL_VEC4 = 0x8b59;\n\nconst GL_FLOAT_MAT2 = 0x8b5a;\nconst GL_FLOAT_MAT3 = 0x8b5b;\nconst GL_FLOAT_MAT4 = 0x8b5c;\n\nconst GL_FLOAT_MAT2x3 = 0x8b65;\nconst GL_FLOAT_MAT2x4 = 0x8b66;\nconst GL_FLOAT_MAT3x2 = 0x8b67;\nconst GL_FLOAT_MAT3x4 = 0x8b68;\nconst GL_FLOAT_MAT4x2 = 0x8b69;\nconst GL_FLOAT_MAT4x3 = 0x8b6a;\n\n// Composite types table\nconst COMPOSITE_GL_TYPES = {\n  [GL_FLOAT]: [GL_FLOAT, 1, 'float'],\n  [GL_FLOAT_VEC2]: [GL_FLOAT, 2, 'vec2'],\n  [GL_FLOAT_VEC3]: [GL_FLOAT, 3, 'vec3'],\n  [GL_FLOAT_VEC4]: [GL_FLOAT, 4, 'vec4'],\n\n  [GL_INT]: [GL_INT, 1, 'int'],\n  [GL_INT_VEC2]: [GL_INT, 2, 'ivec2'],\n  [GL_INT_VEC3]: [GL_INT, 3, 'ivec3'],\n  [GL_INT_VEC4]: [GL_INT, 4, 'ivec4'],\n\n  [GL_UNSIGNED_INT]: [GL_UNSIGNED_INT, 1, 'uint'],\n  [GL_UNSIGNED_INT_VEC2]: [GL_UNSIGNED_INT, 2, 'uvec2'],\n  [GL_UNSIGNED_INT_VEC3]: [GL_UNSIGNED_INT, 3, 'uvec3'],\n  [GL_UNSIGNED_INT_VEC4]: [GL_UNSIGNED_INT, 4, 'uvec4'],\n\n  [GL_BOOL]: [GL_FLOAT, 1, 'bool'],\n  [GL_BOOL_VEC2]: [GL_FLOAT, 2, 'bvec2'],\n  [GL_BOOL_VEC3]: [GL_FLOAT, 3, 'bvec3'],\n  [GL_BOOL_VEC4]: [GL_FLOAT, 4, 'bvec4'],\n\n  [GL_FLOAT_MAT2]: [GL_FLOAT, 8, 'mat2'], // 4\n  [GL_FLOAT_MAT2x3]: [GL_FLOAT, 8, 'mat2x3'], // 6\n  [GL_FLOAT_MAT2x4]: [GL_FLOAT, 8, 'mat2x4'], // 8\n\n  [GL_FLOAT_MAT3]: [GL_FLOAT, 12, 'mat3'], // 9\n  [GL_FLOAT_MAT3x2]: [GL_FLOAT, 12, 'mat3x2'], // 6\n  [GL_FLOAT_MAT3x4]: [GL_FLOAT, 12, 'mat3x4'], // 12\n\n  [GL_FLOAT_MAT4]: [GL_FLOAT, 16, 'mat4'], // 16\n  [GL_FLOAT_MAT4x2]: [GL_FLOAT, 16, 'mat4x2'], // 8\n  [GL_FLOAT_MAT4x3]: [GL_FLOAT, 16, 'mat4x3'] // 12\n};\n\n// Counts the number of complete primitives given a number of vertices and a drawMode\nexport function getPrimitiveDrawMode(drawMode) {\n  switch (drawMode) {\n    case GL_POINTS:\n      return GL_POINTS;\n    case GL_LINES:\n      return GL_LINES;\n    case GL_LINE_STRIP:\n      return GL_LINES;\n    case GL_LINE_LOOP:\n      return GL_LINES;\n    case GL_TRIANGLES:\n      return GL_TRIANGLES;\n    case GL_TRIANGLE_STRIP:\n      return GL_TRIANGLES;\n    case GL_TRIANGLE_FAN:\n      return GL_TRIANGLES;\n    default:\n      assert(false);\n      return 0;\n  }\n}\n\n// Counts the number of complete \"primitives\" given a number of vertices and a drawMode\nexport function getPrimitiveCount({drawMode, vertexCount}) {\n  switch (drawMode) {\n    case GL_POINTS:\n    case GL_LINE_LOOP:\n      return vertexCount;\n    case GL_LINES:\n      return vertexCount / 2;\n    case GL_LINE_STRIP:\n      return vertexCount - 1;\n    case GL_TRIANGLES:\n      return vertexCount / 3;\n    case GL_TRIANGLE_STRIP:\n    case GL_TRIANGLE_FAN:\n      return vertexCount - 2;\n    default:\n      assert(false);\n      return 0;\n  }\n}\n\n// Counts the number of vertices after splitting the vertex stream into separate \"primitives\"\nexport function getVertexCount({drawMode, vertexCount}) {\n  const primitiveCount = getPrimitiveCount({drawMode, vertexCount});\n  switch (getPrimitiveDrawMode(drawMode)) {\n    case GL_POINTS:\n      return primitiveCount;\n    case GL_LINES:\n      return primitiveCount * 2;\n    case GL_TRIANGLES:\n      return primitiveCount * 3;\n    default:\n      assert(false);\n      return 0;\n  }\n}\n\n// Decomposes a composite type GL.VEC3 into a basic type (GL.FLOAT) and components (3)\nexport function decomposeCompositeGLType(compositeGLType) {\n  const typeAndSize = COMPOSITE_GL_TYPES[compositeGLType];\n  if (!typeAndSize) {\n    return null;\n  }\n  const [type, components] = typeAndSize;\n  return {type, components};\n}\n\nexport function getCompositeGLType(type, components) {\n  switch (type) {\n    case GL_BYTE:\n    case GL_UNSIGNED_BYTE:\n    case GL_SHORT:\n    case GL_UNSIGNED_SHORT:\n      type = GL_FLOAT;\n      break;\n    default:\n  }\n\n  for (const glType in COMPOSITE_GL_TYPES) {\n    const [compType, compComponents, name] = COMPOSITE_GL_TYPES[glType];\n    if (compType === type && compComponents === components) {\n      return {glType, name};\n    }\n  }\n  return null;\n}\n","import {assert} from '../utils/assert';\n\n// Resolve a WebGL enumeration name (returns itself if already a number)\nexport function getKeyValue(gl, name) {\n  // If not a string, return (assume number)\n  if (typeof name !== 'string') {\n    return name;\n  }\n\n  // If string converts to number, return number\n  const number = Number(name);\n  if (!isNaN(number)) {\n    return number;\n  }\n\n  // Look up string, after removing any 'GL.' or 'gl.' prefix\n  name = name.replace(/^.*\\./, '');\n  const value = gl[name];\n  assert(value !== undefined, `Accessing undefined constant GL.${name}`);\n  return value;\n}\n\nexport function getKey(gl, value) {\n  value = Number(value);\n  for (const key in gl) {\n    if (gl[key] === value) {\n      return `GL.${key}`;\n    }\n  }\n  return String(value);\n}\n\nexport function getKeyType(gl, value) {\n  assert(value !== undefined, 'undefined key');\n  value = Number(value);\n  for (const key in gl) {\n    if (gl[key] === value) {\n      return `GL.${key}`;\n    }\n  }\n  return String(value);\n}\n","import GL from '@luma.gl/constants';\nimport {assert} from '../utils/assert';\n\n// Returns number of components in a specific readPixels WebGL format\nexport function glFormatToComponents(format) {\n  switch (format) {\n    case GL.ALPHA:\n    case GL.R32F:\n    case GL.RED:\n      return 1;\n    case GL.RG32F:\n    case GL.RG:\n      return 2;\n    case GL.RGB:\n    case GL.RGB32F:\n      return 3;\n    case GL.RGBA:\n    case GL.RGBA32F:\n      return 4;\n    // TODO: Add support for additional WebGL2 formats\n    default:\n      assert(false);\n      return 0;\n  }\n}\n\n// Return byte count for given readPixels WebGL type\nexport function glTypeToBytes(type) {\n  switch (type) {\n    case GL.UNSIGNED_BYTE:\n      return 1;\n    case GL.UNSIGNED_SHORT_5_6_5:\n    case GL.UNSIGNED_SHORT_4_4_4_4:\n    case GL.UNSIGNED_SHORT_5_5_5_1:\n      return 2;\n    case GL.FLOAT:\n      return 4;\n    // TODO: Add support for additional WebGL2 types\n    default:\n      assert(false);\n      return 0;\n  }\n}\n","// TODO: Two subdirectories must not depend on each other (classes vs utils)!\nimport Texture2D from '../classes/texture-2d';\nimport TextureCube from '../classes/texture-cube';\nimport Texture3D from '../classes/texture-3d';\nimport Framebuffer from '../classes/framebuffer';\nimport GL from '@luma.gl/constants';\nimport {assert} from '../utils/assert';\n\n// Clone a new texture object from a reference texture object.\n/** @type {import('./texture-utils').cloneTextureFrom} */\nexport function cloneTextureFrom(refTexture, overrides) {\n  assert(\n    refTexture instanceof Texture2D ||\n      refTexture instanceof TextureCube ||\n      refTexture instanceof Texture3D\n  );\n\n  const TextureType = refTexture.constructor;\n\n  // @ts-expect-error\n  const {gl, width, height, format, type, dataFormat, border, mipmaps} = refTexture;\n\n  const textureOptions = Object.assign(\n    {\n      width,\n      height,\n      format,\n      type,\n      dataFormat,\n      border,\n      mipmaps\n    },\n    overrides\n  );\n\n  // TODO: move this to `Texture` class as instance method and use this.constructor\n  // @ts-expect-error\n  return new TextureType(gl, textureOptions);\n}\n\n// Wraps a given texture into a framebuffer object, that can be further used\n// to read data from the texture object.\n/** @type {import('./texture-utils').toFramebuffer} */\nexport function toFramebuffer(texture, opts) {\n  const {gl, width, height, id} = texture;\n  const framebuffer = new Framebuffer(\n    gl,\n    Object.assign({}, opts, {\n      id: `framebuffer-for-${id}`,\n      width,\n      height,\n      attachments: {\n        [GL.COLOR_ATTACHMENT0]: texture\n      }\n    })\n  );\n  return framebuffer;\n}\n","import GL from '@luma.gl/constants';\n\nconst ERR_TYPE_DEDUCTION = 'Failed to deduce GL constant from typed array';\n\n// Converts TYPED ARRAYS to corresponding GL constant\n// Used to auto deduce gl parameter types\nexport function getGLTypeFromTypedArray(arrayOrType) {\n  // If typed array, look up constructor\n  const type = ArrayBuffer.isView(arrayOrType) ? arrayOrType.constructor : arrayOrType;\n  switch (type) {\n    case Float32Array:\n      return GL.FLOAT;\n    case Uint16Array:\n      return GL.UNSIGNED_SHORT;\n    case Uint32Array:\n      return GL.UNSIGNED_INT;\n    case Uint8Array:\n      return GL.UNSIGNED_BYTE;\n    case Uint8ClampedArray:\n      return GL.UNSIGNED_BYTE;\n    case Int8Array:\n      return GL.BYTE;\n    case Int16Array:\n      return GL.SHORT;\n    case Int32Array:\n      return GL.INT;\n    default:\n      throw new Error(ERR_TYPE_DEDUCTION);\n  }\n}\n\n// Converts GL constant to corresponding TYPED ARRAY\n// Used to auto deduce gl parameter types\n\n/* eslint-disable complexity */\nexport function getTypedArrayFromGLType(glType, {clamped = true} = {}) {\n  // Sorted in some order of likelihood to reduce amount of comparisons\n  switch (glType) {\n    case GL.FLOAT:\n      return Float32Array;\n    case GL.UNSIGNED_SHORT:\n    case GL.UNSIGNED_SHORT_5_6_5:\n    case GL.UNSIGNED_SHORT_4_4_4_4:\n    case GL.UNSIGNED_SHORT_5_5_5_1:\n      return Uint16Array;\n    case GL.UNSIGNED_INT:\n      return Uint32Array;\n    case GL.UNSIGNED_BYTE:\n      return clamped ? Uint8ClampedArray : Uint8Array;\n    case GL.BYTE:\n      return Int8Array;\n    case GL.SHORT:\n      return Int16Array;\n    case GL.INT:\n      return Int32Array;\n    default:\n      throw new Error('Failed to deduce typed array type from GL constant');\n  }\n}\n/* eslint-enable complexity */\n\n// Flip rows (can be used on arrays returned from `Framebuffer.readPixels`)\n// https://stackoverflow.com/questions/41969562/\n// how-can-i-flip-the-result-of-webglrenderingcontext-readpixels\nexport function flipRows({data, width, height, bytesPerPixel = 4, temp}) {\n  const bytesPerRow = width * bytesPerPixel;\n\n  // make a temp buffer to hold one row\n  temp = temp || new Uint8Array(bytesPerRow);\n  for (let y = 0; y < height / 2; ++y) {\n    const topOffset = y * bytesPerRow;\n    const bottomOffset = (height - y - 1) * bytesPerRow;\n    // make copy of a row on the top half\n    temp.set(data.subarray(topOffset, topOffset + bytesPerRow));\n    // copy a row from the bottom half to the top\n    data.copyWithin(topOffset, bottomOffset, bottomOffset + bytesPerRow);\n    // copy the copy of the top half row to the bottom half\n    data.set(temp, bottomOffset);\n  }\n}\n\nexport function scalePixels({data, width, height}) {\n  const newWidth = Math.round(width / 2);\n  const newHeight = Math.round(height / 2);\n  const newData = new Uint8Array(newWidth * newHeight * 4);\n  for (let y = 0; y < newHeight; y++) {\n    for (let x = 0; x < newWidth; x++) {\n      for (let c = 0; c < 4; c++) {\n        newData[(y * newWidth + x) * 4 + c] = data[(y * 2 * width + x * 2) * 4 + c];\n      }\n    }\n  }\n  return {data: newData, width: newWidth, height: newHeight};\n}\n","export default function assert(condition: unknown, message?: string): void {\n  if (!condition) {\n    throw new Error(`math.gl assertion ${message}`);\n  }\n}\n","// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport {NumericArray} from '@math.gl/types';\nimport assert from './assert';\n\nimport type MathArray from '../classes/base/math-array';\n\nexport type ConfigurationOptions = {\n  EPSILON: number;\n  debug?: boolean;\n  precision: number;\n  printTypes?: boolean;\n  printDegrees?: boolean;\n  printRowMajor?: boolean;\n  _cartographicRadians?: boolean;\n};\n\nconst RADIANS_TO_DEGREES = (1 / Math.PI) * 180;\nconst DEGREES_TO_RADIANS = (1 / 180) * Math.PI;\n\n// TODO - remove\nexport const config: ConfigurationOptions = {\n  EPSILON: 1e-12,\n  debug: false,\n  precision: 4,\n  printTypes: false,\n  printDegrees: false,\n  printRowMajor: true\n};\n\nexport function configure(options?: Partial<ConfigurationOptions>): ConfigurationOptions {\n  // Only copy existing keys\n  for (const key in options) {\n    assert(key in config);\n    config[key] = options[key];\n  }\n  return config;\n}\n\n/**\n * Formats a value into a string\n * @param value\n * @param param1\n * @returns\n */\nexport function formatValue(\n  value: number,\n  {precision = config.precision}: {precision?: number} = {}\n): string {\n  value = round(value);\n  // get rid of trailing zeros\n  return `${parseFloat(value.toPrecision(precision))}`;\n}\n\n/**\n * Check if value is an \"array\"\n * Returns `true` if value is either an array or a typed array\n *\n * Note: returns `false` for `ArrayBuffer` and `DataView` instances\n */\nexport function isArray(value: unknown): boolean {\n  return Array.isArray(value) || (ArrayBuffer.isView(value) && !(value instanceof DataView));\n}\n\nexport function clone(array: NumericArray | MathArray): NumericArray {\n  return 'clone' in array ? array.clone() : array.slice();\n}\n\nexport function toRadians(degrees: number): number;\nexport function toRadians(degrees: NumericArray): NumericArray;\n\nexport function toRadians(degrees: number | NumericArray): number | NumericArray {\n  return radians(degrees as NumericArray);\n}\n\nexport function toDegrees(degrees: number): number;\nexport function toDegrees(degrees: NumericArray): NumericArray;\n\nexport function toDegrees(radians: number | NumericArray): number | NumericArray {\n  return degrees(radians as NumericArray);\n}\n\n// GLSL math function equivalents - Works on both single values and vectors\n\n/**\n * \"GLSL equivalent\" radians: Works on single values and vectors\n */\nexport function radians(degrees: number): number;\nexport function radians(degrees: NumericArray, result?: NumericArray): NumericArray;\n\nexport function radians(\n  degrees: number | NumericArray,\n  result?: NumericArray\n): number | NumericArray {\n  return map(degrees, (degrees) => degrees * DEGREES_TO_RADIANS, result);\n}\n\n/**\n * \"GLSL equivalent\" degrees: Works on single values and vectors\n */\nexport function degrees(radians: number): number;\nexport function degrees(radians: NumericArray, result?: NumericArray): NumericArray;\n\nexport function degrees(\n  radians: number | NumericArray,\n  result?: NumericArray\n): number | NumericArray {\n  return map(radians, (radians) => radians * RADIANS_TO_DEGREES, result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.sin`: Works on single values and vectors\n * @deprecated\n */\nexport function sin(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.sin(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.cos`: Works on single values and vectors\n * @deprecated\n */\nexport function cos(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.cos(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.tan`: Works on single values and vectors\n * @deprecated\n */\nexport function tan(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.tan(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.asin`: Works on single values and vectors\n * @deprecated\n */\nexport function asin(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.asin(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.acos`: Works on single values and vectors\n * @deprecated\n */\nexport function acos(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.acos(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.atan`: Works on single values and vectors\n * @deprecated\n */\nexport function atan(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.atan(angle), result);\n}\n\n/**\n * GLSL style value clamping: Works on single values and vectors\n */\nexport function clamp(value: number, min: number, max: number): number;\nexport function clamp(value: NumericArray, min: number, max: number): NumericArray;\n\nexport function clamp(\n  value: number | NumericArray,\n  min: number,\n  max: number\n): number | NumericArray {\n  return map(value, (value) => Math.max(min, Math.min(max, value)));\n}\n\n/**\n * Interpolate between two numbers or two arrays\n */\nexport function lerp(a: number, b: number, t: number): number;\nexport function lerp(a: NumericArray, b: NumericArray, t: number): NumericArray;\n\nexport function lerp(\n  a: number | NumericArray,\n  b: number | NumericArray,\n  t: number\n): number | NumericArray {\n  if (isArray(a)) {\n    return (a as NumericArray).map((ai: number, i: number) => lerp(ai, (b as NumericArray)[i], t));\n  }\n  return t * (b as number) + (1 - t) * (a as number);\n}\n\n/* eslint-disable */\n\n/**\n * Compares any two math objects, using `equals` method if available.\n * @param a\n * @param b\n * @param epsilon\n * @returns\n */\nexport function equals(a: any, b: any, epsilon?: number): boolean {\n  const oldEpsilon = config.EPSILON;\n  if (epsilon) {\n    config.EPSILON = epsilon;\n  }\n  try {\n    if (a === b) {\n      return true;\n    }\n    if (isArray(a) && isArray(b)) {\n      if (a.length !== b.length) {\n        return false;\n      }\n      for (let i = 0; i < a.length; ++i) {\n        // eslint-disable-next-line max-depth\n        if (!equals(a[i], b[i])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    if (a && a.equals) {\n      return a.equals(b);\n    }\n    if (b && b.equals) {\n      return b.equals(a);\n    }\n    if (typeof a === 'number' && typeof b === 'number') {\n      return Math.abs(a - b) <= config.EPSILON * Math.max(1, Math.abs(a), Math.abs(b));\n    }\n    return false;\n  } finally {\n    config.EPSILON = oldEpsilon;\n  }\n}\n\nexport function exactEquals(a: any, b: any): boolean {\n  if (a === b) {\n    return true;\n  }\n  if (a && typeof a === 'object' && b && typeof b === 'object') {\n    if (a.constructor !== b.constructor) {\n      return false;\n    }\n    if (a.exactEquals) {\n      return a.exactEquals(b);\n    }\n  }\n  if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; ++i) {\n      if (!exactEquals(a[i], b[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n/* eslint-enable */\n\nexport function withEpsilon<T>(epsilon: number, func: () => T): T {\n  const oldPrecision = config.EPSILON;\n  config.EPSILON = epsilon;\n  let value: T;\n  try {\n    value = func();\n  } finally {\n    config.EPSILON = oldPrecision;\n  }\n  return value;\n}\n\n// HELPERS\n\nfunction round(value: number): number {\n  return Math.round(value / config.EPSILON) * config.EPSILON;\n}\n\n// If the array has a clone function, calls it, otherwise returns a copy\nfunction duplicateArray(array: NumericArray): NumericArray {\n  // @ts-expect-error We check for math.gl class methods\n  return array.clone ? array.clone() : (new Array(array.length) as number[]);\n}\n\n// If the argument value is an array, applies the func element wise,\n// otherwise applies func to the argument value\nfunction map(\n  value: number | NumericArray,\n  func: (x: number, index?: number, result?: NumericArray) => number,\n  result?: NumericArray\n): number | NumericArray {\n  if (isArray(value)) {\n    const array = value as NumericArray;\n    result = result || duplicateArray(array);\n    for (let i = 0; i < result.length && i < array.length; ++i) {\n      result[i] = func(value[i], i, result);\n    }\n    return result;\n  }\n  return func(value as number);\n}\n","// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n// This function is needed in initialization stages,\n// make sure it can be imported in isolation\n\nimport isBrowser from './is-browser';\nimport isElectron from './is-electron';\n\nconst window = globalThis;\n\nexport function isMobile(): boolean {\n  return typeof window.orientation !== 'undefined';\n}\n\n// Simple browser detection\n// `mockUserAgent` parameter allows user agent to be overridden for testing\n/* eslint-disable complexity */\nexport default function getBrowser(\n  mockUserAgent?: string\n): 'Node' | 'Electron' | 'Chrome' | 'Firefox' | 'Safari' | 'Edge' | 'IE' | 'Unknown' {\n  if (!mockUserAgent && !isBrowser()) {\n    return 'Node';\n  }\n\n  if (isElectron(mockUserAgent)) {\n    return 'Electron';\n  }\n\n  const navigator_ = typeof navigator !== 'undefined' ? navigator : {};\n  // @ts-expect-error\n  const userAgent = mockUserAgent || navigator_.userAgent || '';\n  // const appVersion = navigator_.appVersion || '';\n\n  // NOTE: Order of tests matter, as many agents list Chrome etc.\n  if (userAgent.indexOf('Edge') > -1) {\n    return 'Edge';\n  }\n  const isMSIE = userAgent.indexOf('MSIE ') !== -1;\n  const isTrident = userAgent.indexOf('Trident/') !== -1;\n  if (isMSIE || isTrident) {\n    return 'IE';\n  }\n  if (window.chrome) {\n    return 'Chrome';\n  }\n  if (window.safari) {\n    return 'Safari';\n  }\n  if (window.mozInnerScreenX) {\n    return 'Firefox';\n  }\n  return 'Unknown';\n}\n","/* eslint-disable no-restricted-globals */\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document,\n  process: typeof process === 'object' && process\n};\n\nconst global_ = globalThis;\nconst self_ = globals.self || globals.window || globals.global;\nconst window_ = globals.window || globals.self || globals.global;\nconst document_ = globals.document || {};\nconst process_ = globals.process || {};\nconst console_ = console;\n\nexport {\n  self_ as self,\n  window_ as window,\n  global_ as global,\n  document_ as document,\n  process_ as process,\n  console_ as console\n};\n","// This function is needed in initialization stages,\n// make sure it can be imported in isolation\n\nimport isElectron from './is-electron';\n\nexport default function isBrowser(): boolean {\n  // Check if in browser by duck-typing Node context\n  const isNode =\n    // @ts-expect-error\n    typeof process === 'object' && String(process) === '[object process]' && !process.browser;\n\n  return !isNode || isElectron();\n}\n\n// document does not exist on worker thread\nexport function isBrowserMainThread(): boolean {\n  return isBrowser() && typeof document !== 'undefined';\n}\n","// based on https://github.com/cheton/is-electron\n// https://github.com/electron/electron/issues/2288\n/* eslint-disable complexity */\nexport default function isElectron(mockUserAgent?: string): boolean {\n  // Renderer process\n  if (\n    typeof window !== 'undefined' &&\n    typeof window.process === 'object' &&\n    // @ts-expect-error\n    window.process.type === 'renderer'\n  ) {\n    return true;\n  }\n  // Main process\n  if (\n    typeof process !== 'undefined' &&\n    typeof process.versions === 'object' &&\n    // eslint-disable-next-line\n    Boolean(process.versions['electron'])\n  ) {\n    return true;\n  }\n  // Detect the user agent when the `nodeIntegration` option is set to true\n  const realUserAgent =\n    typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n  return false;\n}\n","import checkIfBrowser from '../lib/is-browser';\n\nexport {self, window, global, document, process, console} from '../lib/globals';\n\n// Extract injected version from package.json (injected by babel plugin)\n// @ts-expect-error\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\n\nexport const isBrowser = checkIfBrowser();\n","// probe.gl, MIT license\n\n/* eslint-disable no-console */\nimport {VERSION, isBrowser} from '@probe.gl/env';\nimport {LocalStorage} from './utils/local-storage';\nimport {formatImage, formatTime, leftPad} from './utils/formatters';\nimport {addColor} from './utils/color';\nimport {autobind} from './utils/autobind';\nimport assert from './utils/assert';\nimport {getHiResTimestamp} from './utils/hi-res-timestamp';\n\n// Instrumentation in other packages may override console methods, so preserve them here\nconst originalConsole = {\n  debug: isBrowser ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\n\ntype Table = Record<string, any>;\n\ntype LogFunction = () => void;\n\ntype LogOptions = {\n  method?;\n  time?;\n  total?: number;\n  delta?: number;\n  tag?: string;\n  message?: string;\n  once?: boolean;\n  nothrottle?: boolean;\n  args?: any;\n};\n\ntype LogSettings = {\n  enabled?: boolean;\n  level?: number;\n  [key: string]: any;\n};\n\nconst DEFAULT_SETTINGS: Required<LogSettings> = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {} // eslint-disable-line @typescript-eslint/no-empty-function\n\nconst cache = {};\nconst ONCE = {once: true};\n\ntype LogConfiguration = {\n  enabled?: boolean;\n  level?: number;\n};\n\n/** A console wrapper */\n\nexport class Log {\n  static VERSION = VERSION;\n\n  id: string;\n  VERSION: string = VERSION;\n  _startTs: number = getHiResTimestamp();\n  _deltaTs: number = getHiResTimestamp();\n  _storage: LocalStorage<LogConfiguration>;\n  userData = {};\n\n  // TODO - fix support from throttling groups\n  LOG_THROTTLE_TIMEOUT: number = 0; // Time before throttled messages are logged again\n\n  constructor({id} = {id: ''}) {\n    this.id = id;\n    this.userData = {};\n    this._storage = new LocalStorage<LogConfiguration>(`__probe-${this.id}__`, DEFAULT_SETTINGS);\n\n    this.timeStamp(`${this.id} started`);\n\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel: number) {\n    this.setLevel(newLevel);\n  }\n\n  get level(): number {\n    return this.getLevel();\n  }\n\n  isEnabled(): boolean {\n    return this._storage.config.enabled;\n  }\n\n  getLevel(): number {\n    return this._storage.config.level;\n  }\n\n  /** @return milliseconds, with fractions */\n  getTotal(): number {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  /** @return milliseconds, with fractions */\n  getDelta(): number {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  /** @deprecated use logLevel */\n  set priority(newPriority: number) {\n    this.level = newPriority;\n  }\n\n  /** @deprecated use logLevel */\n  get priority(): number {\n    return this.level;\n  }\n\n  /** @deprecated use logLevel */\n  getPriority(): number {\n    return this.level;\n  }\n\n  // Configure\n\n  enable(enabled: boolean = true): this {\n    this._storage.setConfiguration({enabled});\n    return this;\n  }\n\n  setLevel(level: number): this {\n    this._storage.setConfiguration({level});\n    return this;\n  }\n\n  /** return the current status of the setting */\n  get(setting: string): any {\n    return this._storage.config[setting];\n  }\n\n  // update the status of the setting\n  set(setting: string, value: any): void {\n    this._storage.setConfiguration({[setting]: value});\n  }\n\n  /** Logs the current settings as a table */\n  settings(): void {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  // Unconditional logging\n\n  assert(condition: unknown, message?: string): asserts condition {\n    assert(condition, message);\n  }\n\n  /** Warn, but only once, no console flooding */\n  warn(message: string, ...args): LogFunction;\n  warn(message: string): LogFunction {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  /** Print an error */\n  error(message: string, ...args): LogFunction;\n  error(message: string): LogFunction {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  /** Print a deprecation warning */\n  deprecated(oldUsage: string, newUsage: string): LogFunction {\n    return this.warn(`\\`${oldUsage}\\` is deprecated and will be removed \\\nin a later version. Use \\`${newUsage}\\` instead`);\n  }\n\n  /** Print a removal warning */\n  removed(oldUsage: string, newUsage: string): LogFunction {\n    return this.error(`\\`${oldUsage}\\` has been removed. Use \\`${newUsage}\\` instead`);\n  }\n\n  // Conditional logging\n\n  /** Log to a group */\n  probe(logLevel, message?, ...args): LogFunction;\n  probe(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  /** Log a debug message */\n  log(logLevel, message?, ...args): LogFunction;\n  log(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  /** Log a normal message */\n  info(logLevel, message?, ...args): LogFunction;\n  info(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  /** Log a normal message, but only once, no console flooding */\n  once(logLevel, message?, ...args): LogFunction;\n  once(logLevel, message?, ...args) {\n    return this._getLogFunction(\n      logLevel,\n      message,\n      originalConsole.debug || originalConsole.info,\n      arguments,\n      ONCE\n    );\n  }\n\n  /** Logs an object as a table */\n  table(logLevel, table?, columns?): LogFunction {\n    if (table) {\n      // @ts-expect-error Not clear how this works, columns being passed as arguments\n      return this._getLogFunction(logLevel, table, console.table || noop, columns && [columns], {\n        tag: getTableHeader(table)\n      });\n    }\n    return noop;\n  }\n\n  /** logs an image under Chrome */\n  image({logLevel, priority, image, message = '', scale = 1}): LogFunction {\n    if (!this._shouldLog(logLevel || priority)) {\n      return noop;\n    }\n    return isBrowser\n      ? logImageInBrowser({image, message, scale})\n      : logImageInNode({image, message, scale});\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(\n      logLevel,\n      message,\n      console.timeEnd ? console.timeEnd : console.info\n    );\n  }\n\n  timeStamp(logLevel, message?) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message, opts = {collapsed: false}) {\n    const options = normalizeArguments({logLevel, message, opts});\n    const {collapsed} = opts;\n    // @ts-expect-error\n    options.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n\n    return this._getLogFunction(options);\n  }\n\n  groupCollapsed(logLevel, message, opts = {}) {\n    return this.group(logLevel, message, Object.assign({}, opts, {collapsed: true}));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  // EXPERIMENTAL\n\n  withGroup(logLevel: number, message: string, func: Function): void {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace(): void {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  // PRIVATE METHODS\n\n  /** Deduces log level from a variety of arguments */\n  _shouldLog(logLevel: unknown): boolean {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(\n    logLevel: unknown,\n    message?: unknown,\n    method?: Function,\n    args?: IArguments,\n    opts?: LogOptions\n  ): LogFunction {\n    if (this._shouldLog(logLevel)) {\n      // normalized opts + timings\n      opts = normalizeArguments({logLevel, message, args, opts});\n      method = method || opts.method;\n      assert(method);\n\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      // reset delta timer\n      this._deltaTs = getHiResTimestamp();\n\n      const tag = opts.tag || opts.message;\n\n      if (opts.once) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      // TODO - Make throttling work with groups\n      // if (opts.nothrottle || !throttle(tag, this.LOG_THROTTLE_TIMEOUT)) {\n      //   return noop;\n      // }\n\n      message = decorateMessage(this.id, opts.message, opts);\n\n      // Bind console function so that it can be called after being returned\n      return method.bind(console, message, ...opts.args);\n    }\n    return noop;\n  }\n}\n\n/**\n * Get logLevel from first argument:\n * - log(logLevel, message, args) => logLevel\n * - log(message, args) => 0\n * - log({logLevel, ...}, message, args) => logLevel\n * - log({logLevel, message, args}) => logLevel\n */\nfunction normalizeLogLevel(logLevel: unknown): number {\n  if (!logLevel) {\n    return 0;\n  }\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      // Backward compatibility\n      // TODO - deprecate `priority`\n      // @ts-expect-error\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n  // 'log level must be a number'\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n\n  return resolvedLevel;\n}\n\n/**\n * \"Normalizes\" the various argument patterns into an object with known types\n * - log(logLevel, message, args) => {logLevel, message, args}\n * - log(message, args) => {logLevel: 0, message, args}\n * - log({logLevel, ...}, message, args) => {logLevel, message, args}\n * - log({logLevel, message, args}) => {logLevel, message, args}\n */\nexport function normalizeArguments(opts: {\n  logLevel;\n  message;\n  collapsed?: boolean;\n  args?: IArguments;\n  opts?;\n}): {\n  logLevel: number;\n  message: string;\n  args: any[];\n} {\n  const {logLevel, message} = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n\n  // We use `arguments` instead of rest parameters (...args) because IE\n  // does not support the syntax. Rest parameters is transpiled to code with\n  // perf impact. Doing it here instead avoids constructing args when logging is\n  // disabled.\n  // TODO - remove when/if IE support is dropped\n  const args: any[] = opts.args ? Array.from(opts.args) : [];\n  // args should only contain arguments that appear after `message`\n  // eslint-disable-next-line no-empty\n  while (args.length && args.shift() !== message) {}\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  // Resolve functions into strings by calling them\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n  const messageType = typeof opts.message;\n  // 'log message must be a string' or object\n  assert(messageType === 'string' || messageType === 'object');\n\n  // original opts + normalized opts + opts arg + fixed up message\n  return Object.assign(opts, {args}, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? `${id}: ${time}  ${message}` : `${id}: ${message}`;\n    message = addColor(message, opts.color, opts.background);\n  }\n  return message;\n}\n\n/** @deprecated Function removed */\nfunction logImageInNode({image, message = '', scale = 1}) {\n  console.warn('removed');\n  return noop;\n}\n\nfunction logImageInBrowser({image, message = '', scale = 1}) {\n  if (typeof image === 'string') {\n    const img = new Image();\n    img.onload = () => {\n      const args = formatImage(img, message, scale);\n      console.log(...args);\n    };\n    img.src = image;\n    return noop;\n  }\n  const element = image.nodeName || '';\n  if (element.toLowerCase() === 'img') {\n    console.log(...formatImage(image, message, scale));\n    return noop;\n  }\n  if (element.toLowerCase() === 'canvas') {\n    const img = new Image();\n    img.onload = () => console.log(...formatImage(img, message, scale));\n    img.src = image.toDataURL();\n    return noop;\n  }\n  return noop;\n}\n\nfunction getTableHeader(table: Table): string {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n  return 'empty';\n}\n","export default function assert(condition: unknown, message?: string): asserts condition {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n","// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/**\n * Binds the \"this\" argument of all functions on a class instance to the instance\n * @param obj - class instance (typically a react component)\n */\nexport function autobind(obj: object, predefined = ['constructor']): void {\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n  for (const key of propNames) {\n    if (typeof obj[key] === 'function') {\n      if (!predefined.find(name => key === name)) {\n        obj[key] = obj[key].bind(obj);\n      }\n    }\n  }\n}\n","import {isBrowser} from '@probe.gl/env';\n\nexport enum COLOR {\n  BLACK = 30,\n  RED = 31,\n  GREEN = 32,\n  YELLOW = 33,\n  BLUE = 34,\n  MAGENTA = 35,\n  CYAN = 36,\n  WHITE = 37,\n\n  BRIGHT_BLACK = 90,\n  BRIGHT_RED = 91,\n  BRIGHT_GREEN = 92,\n  BRIGHT_YELLOW = 93,\n  BRIGHT_BLUE = 94,\n  BRIGHT_MAGENTA = 95,\n  BRIGHT_CYAN = 96,\n  BRIGHT_WHITE = 97\n}\n\nfunction getColor(color): number {\n  return typeof color === 'string' ? COLOR[color.toUpperCase()] || COLOR.WHITE : color;\n}\n\nexport function addColor(string, color, background?): string {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      color = getColor(color);\n      string = `\\u001b[${color}m${string}\\u001b[39m`;\n    }\n    if (background) {\n      // background colors values are +10\n      color = getColor(background);\n      string = `\\u001b[${background + 10}m${string}\\u001b[49m`;\n    }\n  }\n  return string;\n}\n","// TODO: Currently unused, keeping in case we want it later for log formatting\nexport function formatTime(ms: number): string {\n  let formatted;\n  if (ms < 10) {\n    formatted = `${ms.toFixed(2)}ms`;\n  } else if (ms < 100) {\n    formatted = `${ms.toFixed(1)}ms`;\n  } else if (ms < 1000) {\n    formatted = `${ms.toFixed(0)}ms`;\n  } else {\n    formatted = `${(ms / 1000).toFixed(2)}s`;\n  }\n  return formatted;\n}\n\nexport function leftPad(string: string, length: number = 8): string {\n  const padLength = Math.max(length - string.length, 0);\n  return `${' '.repeat(padLength)}${string}`;\n}\n\nexport function rightPad(string: string, length: number = 8): string {\n  const padLength = Math.max(length - string.length, 0);\n  return `${string}${' '.repeat(padLength)}`;\n}\n\nexport function formatValue(v: unknown, opts: {isInteger?: boolean} = {}): string {\n  const EPSILON = 1e-16;\n  const {isInteger = false} = opts;\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, opts);\n  }\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n  // @ts-expect-error\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n  if (isInteger) {\n    // @ts-expect-error\n    return v.toFixed(0);\n  }\n  // @ts-expect-error\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    // @ts-expect-error\n    return v.toFixed(0);\n  }\n  // @ts-expect-error\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\n/** Helper to formatValue */\nfunction formatArrayValue(v, opts) {\n  const {maxElts = 16, size = 1} = opts;\n  let string = '[';\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += `,${i % size === 0 ? ' ' : ''}`;\n    }\n    string += formatValue(v[i], opts);\n  }\n  const terminator = v.length > maxElts ? '...' : ']';\n  return `${string}${terminator}`;\n}\n\n/** Inspired by https://github.com/hughsk/console-image (MIT license) */\nexport function formatImage(image, message, scale, maxWidth = 600) {\n  const imageUrl = image.src.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n\n  if (image.width > maxWidth) {\n    scale = Math.min(scale, maxWidth / image.width);\n  }\n\n  const width = image.width * scale;\n  const height = image.height * scale;\n\n  const style = [\n    'font-size:1px;',\n    `padding:${Math.floor(height / 2)}px ${Math.floor(width / 2)}px;`,\n    `line-height:${height}px;`,\n    `background:url(${imageUrl});`,\n    `background-size:${width}px ${height}px;`,\n    'color:transparent;'\n  ].join('');\n\n  return [`${message} %c+`, style];\n}\n","// probe.gl, MIT license\n\nimport {window, process, isBrowser} from '@probe.gl/env';\n\n/** Get best timer available. */\nexport function getHiResTimestamp() {\n  let timestamp;\n  if (isBrowser && 'performance' in window) {\n    timestamp = window?.performance?.now?.();\n  } else if ('hrtime' in process) {\n    // @ts-ignore\n    const timeParts = process?.hrtime?.();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n","// probe.gl, MIT license\n\nfunction getStorage(type): Storage {\n  try {\n    // @ts-expect-error\n    const storage: Storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\n// Store keys in local storage via simple interface\nexport class LocalStorage<Configuration extends {}> {\n  storage: Storage;\n  id: string;\n  config: Required<Configuration>;\n\n  constructor(id: string, defaultConfig: Required<Configuration>, type = 'sessionStorage') {\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = defaultConfig;\n    this._loadConfiguration();\n  }\n\n  getConfiguration(): Required<Configuration> {\n    return this.config;\n  }\n\n  setConfiguration(configuration: Configuration): void {\n    Object.assign(this.config, configuration);\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n  }\n\n  // Get config from persistent store, if available\n  _loadConfiguration() {\n    let configuration = {};\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n    Object.assign(this.config, configuration);\n    return this;\n  }\n}\n","export {default as Stats} from './lib/stats';\nexport {default as Stat} from './lib/stat';\n\n// UTILITIES\nexport {default as _getHiResTimestamp} from './utils/hi-res-timestamp';\n","import getHiResTimestamp from '../utils/hi-res-timestamp';\n\nexport default class Stat {\n  readonly name: string;\n  readonly type: string;\n  sampleSize: number = 1;\n  time: number;\n  count: number;\n  samples: number;\n  lastTiming: number;\n  lastSampleTime: number;\n  lastSampleCount: number;\n\n  _count: number = 0;\n  _time: number = 0;\n  _samples: number = 0;\n  _startTime: number = 0;\n  _timerPending: boolean = false;\n\n  constructor(name: string, type?: string) {\n    this.name = name;\n    this.type = type;\n    this.reset();\n  }\n\n  setSampleSize(samples: number): this {\n    this.sampleSize = samples;\n    return this;\n  }\n\n  /** Call to increment count (+1) */\n  incrementCount(): this {\n    this.addCount(1);\n\n    return this;\n  }\n\n  /** Call to decrement count (-1) */\n  decrementCount(): this {\n    this.subtractCount(1);\n\n    return this;\n  }\n\n  /** Increase count */\n  addCount(value: number): this {\n    this._count += value;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Decrease count */\n  subtractCount(value: number): this {\n    this._count -= value;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Add an arbitrary timing and bump the count */\n  addTime(time: number): this {\n    this._time += time;\n    this.lastTiming = time;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Start a timer */\n  timeStart(): this {\n    this._startTime = getHiResTimestamp();\n    this._timerPending = true;\n\n    return this;\n  }\n\n  /** End a timer. Adds to time and bumps the timing count. */\n  timeEnd(): this {\n    if (!this._timerPending) {\n      return this;\n    }\n    this.addTime(getHiResTimestamp() - this._startTime);\n    this._timerPending = false;\n    this._checkSampling();\n\n    return this;\n  }\n\n  getSampleAverageCount(): number {\n    return this.sampleSize > 0 ? this.lastSampleCount / this.sampleSize : 0;\n  }\n\n  /** Calculate average time / count for the previous window */\n  getSampleAverageTime(): number {\n    return this.sampleSize > 0 ? this.lastSampleTime / this.sampleSize : 0;\n  }\n\n  /** Calculate counts per second for the previous window */\n  getSampleHz(): number {\n    return this.lastSampleTime > 0 ? this.sampleSize / (this.lastSampleTime / 1000) : 0;\n  }\n\n  getAverageCount(): number {\n    return this.samples > 0 ? this.count / this.samples : 0;\n  }\n\n  /** Calculate average time / count */\n  getAverageTime(): number {\n    return this.samples > 0 ? this.time / this.samples : 0;\n  }\n\n  /** Calculate counts per second */\n  getHz(): number {\n    return this.time > 0 ? this.samples / (this.time / 1000) : 0;\n  }\n\n  reset(): this {\n    this.time = 0;\n    this.count = 0;\n    this.samples = 0;\n    this.lastTiming = 0;\n    this.lastSampleTime = 0;\n    this.lastSampleCount = 0;\n    this._count = 0;\n    this._time = 0;\n    this._samples = 0;\n    this._startTime = 0;\n    this._timerPending = false;\n\n    return this;\n  }\n\n  _checkSampling(): void {\n    if (this._samples === this.sampleSize) {\n      this.lastSampleTime = this._time;\n      this.lastSampleCount = this._count;\n      this.count += this._count;\n      this.time += this._time;\n      this.samples += this._samples;\n      this._time = 0;\n      this._count = 0;\n      this._samples = 0;\n    }\n  }\n}\n","import Stat from './stat';\n\n/** A \"bag\" of `Stat` objects, can be visualized using `StatsWidget` */\nexport default class Stats {\n  readonly id: string;\n  readonly stats: Record<string, Stat> = {};\n\n  constructor(options: {id: string; stats?: Stats | Stat[] | {name: string; type?: string}[]}) {\n    this.id = options.id;\n    this.stats = {};\n\n    this._initializeStats(options.stats);\n\n    Object.seal(this);\n  }\n\n  /** Acquire a stat. Create if it doesn't exist. */\n  get(name: string, type: string = 'count'): Stat {\n    return this._getOrCreate({name, type});\n  }\n\n  get size(): number {\n    return Object.keys(this.stats).length;\n  }\n\n  /** Reset all stats */\n  reset(): this {\n    for (const key in this.stats) {\n      this.stats[key].reset();\n    }\n\n    return this;\n  }\n\n  forEach(fn: (stat: Stat) => void): void {\n    for (const key in this.stats) {\n      fn(this.stats[key]);\n    }\n  }\n\n  getTable(): Record<\n    string,\n    {\n      time: number;\n      count: number;\n      average: number;\n      hz: number;\n    }\n    > {\n    const table = {};\n    this.forEach(stat => {\n      table[stat.name] = {\n        time: stat.time || 0,\n        count: stat.count || 0,\n        average: stat.getAverageTime() || 0,\n        hz: stat.getHz() || 0\n      };\n    });\n\n    return table;\n  }\n\n  _initializeStats(stats: Stats | Stat[] | {name: string; type?: string}[] = []): void {\n    stats.forEach(stat => this._getOrCreate(stat));\n  }\n\n  _getOrCreate(stat): Stat {\n    if (!stat || !stat.name) {\n      return null;\n    }\n\n    const {name, type} = stat;\n    if (!this.stats[name]) {\n      if (stat instanceof Stat) {\n        this.stats[name] = stat;\n      } else {\n        this.stats[name] = new Stat(name, type);\n      }\n    }\n    return this.stats[name];\n  }\n}\n","// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nexport default function getHiResTimestamp(): number {\n  let timestamp;\n  // Get best timer available.\n  if (typeof window !== 'undefined' && window.performance) {\n    timestamp = window.performance.now();\n  } else if (typeof process !== 'undefined' && process.hrtime) {\n    const timeParts = process.hrtime();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n"],"names":["DEFAULT_CHUNK_SIZE","makeArrayBufferIterator","arrayBuffer","options","arguments","length","undefined","chunkSize","byteOffset","byteLength","chunkByteLength","Math","min","chunk","ArrayBuffer","sourceArray","Uint8Array","chunkArray","set","makeBlobIterator","blob","offset","size","end","slice","makeStringIterator","makeStreamIterator","isBlob","isReadableStream","isResponse","makeIterator","data","response","body","Error","isBrowser","toArrayBuffer","stream","makeBrowserStreamIterator","makeNodeStreamIterator","reader","getReader","nextBatchPromise","currentBatchPromise","read","_streamReadAhead","done","value","error","releaseLock","string","textEncoder","TextEncoder","chunkLength","encode","isBoolean","x","isFunction","isObject","isPureObject","constructor","isPromise","then","isIterable","Symbol","iterator","isAsyncIterable","asyncIterator","isIterator","next","Response","text","json","isFile","File","Blob","isBuffer","isWritableDOMStream","abort","getWriter","isReadableDOMStream","ReadableStream","tee","cancel","isWritableNodeStream","write","writable","isReadableNodeStream","pipe","readable","isWritableStream","isLoaderObject","getFetchFunction","parse","load","url","loaders","context","Array","isArray","fetch","assert","validateWorkerVersion","parseWithWorker","canParseWithWorker","normalizeOptions","getArrayBufferOrStringFromData","getLoaderContext","getLoadersFromContext","getResourceUrl","selectLoader","typedLoaders","candidateLoaders","loader","parseWithLoader","ok","redirected","status","statusText","type","headers","Object","fromEntries","entries","parseTextSync","dataType","parseText","parseSync","concat","id","normalizeLoader","getGlobalLoaderState","getGlobalLoaderRegistry","state","loaderRegistry","registerLoaders","normalizedLoader","find","registeredLoader","unshift","getRegisteredLoaders","_unregisterLoaders","compareArrayBuffers","path","log","getResourceMIMEType","stripQueryString","EXT_PATTERN","validHTTPResponse","selectLoaderSync","nothrow","getNoValidLoaderMessage","ignoreRegisteredLoaders","push","normalizeLoaders","selectLoaderInternal","testUrl","reason","mimeType","findLoaderByMIMEType","findLoaderByUrl","findLoaderByInitialBytes","getFirstCharacters","fallbackMimeType","_loader","name","message","filename","firstCharacters","match","exec","extension","findLoaderByExtension","toLowerCase","loaderExtension","extensions","mimeTypes","includes","testDataAgainstText","isView","testDataAgainstBinary","buffer","testText","tests","some","test","startsWith","testBinary","magic","getMagicString","dataView","DataView","i","String","fromCharCode","getUint8","resolvePath","makeResponse","fetchFile","fetchOptions","concatenateArrayBuffersAsync","checkResponse","ERR_DATA","getArrayBufferOrStringFromDataSync","binary","textDecoder","TextDecoder","decode","isArrayBuffer","getAsyncIterableFromData","getIterableFromData","getReadableStream","oneChunk","getGlobalLoaderOptions","globalOptions","extractQueryString","parentContext","newContext","baseUrl","queryString","dirname","contextLoaders","Log","probeLog","NullLog","info","warn","ConsoleLog","_defineProperty","console","_len","args","_key","bind","_len2","_key2","_len3","_key3","_len4","_key4","hasExtensions","_loader2","_loader3","DEFAULT_LOADER_OPTIONS","CDN","worker","maxConcurrency","maxMobileConcurrency","reuseWorkers","_nodeWorkers","_workerType","limit","_limitMB","batchSize","batchDebounceMs","metadata","transforms","REMOVED_LOADER_OPTIONS","throws","uri","method","mode","credentials","cache","redirect","referrer","referrerPolicy","integrity","keepalive","signal","globalThis","_state","setGlobalOptions","normalizeOptionsInternal","validateOptions","validateOptionsObject","idOptions","loaderOptions","deprecatedOptions","defaultOptions","loaderName","prefix","key","isSubOptions","isBaseUriOption","isWorkerUrlOption","suggestion","findSimilarOption","optionKey","lowerCaseOptionKey","bestSuggestion","lowerCaseKey","isPartialMatch","loaderDefaultOptions","mergedOptions","addUrlOptions","mergeNestedFields","baseUri","DATA_URL_PATTERN","MIME_TYPE_PATTERN","parseMIMEType","mimeString","matches","parseMIMETypeFromURL","resource","contentTypeHeader","get","noQueryUrl","getResourceContentLength","contentLength","initialDataUrl","getInitialDataUrl","defineProperty","getResponseError","checkResponseSync","contentType","INITIAL_DATA_LENGTH","blobSlice","Promise","resolve","FileReader","onload","event","_event$target","target","result","readAsDataURL","base64","arrayBufferToBase64","bytes","btoa","QUERY_STRING_PATTERN","replace","global_","self_","self","window","global","window_","document_","document","process_","process","console_","navigator_","navigator","isElectron","isNode","browser","isBrowserMainThread","mockUserAgent","versions","Boolean","realUserAgent","userAgent","indexOf","checkIfBrowser","VERSION","__VERSION__","LocalStorage","formatImage","formatTime","leftPad","addColor","autobind","getHiResTimestamp","originalConsole","debug","DEFAULT_LOG_CONFIGURATION","enabled","level","noop","ONCE","once","userData","_storage","timeStamp","seal","newLevel","setLevel","getLevel","isEnabled","config","getTotal","Number","_startTs","toPrecision","getDelta","_deltaTs","priority","newPriority","getPriority","enable","setConfiguration","setting","settings","table","condition","_getLogFunction","deprecated","oldUsage","newUsage","removed","probe","logLevel","time","columns","tag","getTableHeader","image","scale","_shouldLog","logImageInBrowser","logImageInNode","timeEnd","group","opts","collapsed","normalizeArguments","groupCollapsed","assign","groupEnd","withGroup","func","trace","normalizeLogLevel","total","delta","decorateMessage","resolvedLevel","isFinite","from","shift","messageType","color","background","img","Image","src","element","nodeName","toDataURL","title","obj","predefined","proto","getPrototypeOf","propNames","getOwnPropertyNames","object","COLOR","BACKGROUND_INCREMENT","getColor","toUpperCase","WHITE","colorCode","ms","formatted","toFixed","padLength","max","repeat","rightPad","formatValue","v","EPSILON","isInteger","formatArrayValue","abs","decimal","maxElts","terminator","maxWidth","imageUrl","width","height","style","floor","join","timestamp","performance","now","timeParts","hrtime","Date","getStorage","storage","setItem","removeItem","e","defaultConfig","_loadConfiguration","getConfiguration","configuration","serialized","JSON","stringify","serializedConfiguration","getItem","arrayBuffer1","arrayBuffer2","array1","array2","concatenateArrayBuffers","sources","sourceArrays","map","source2","reduce","typedArray","concatenateTypedArrays","typedArrays","arrays","TypedArrayConstructor","sumLength","acc","array","sliceArrayBuffer","subArray","subarray","arrayCopy","node","toBuffer","uint8Array","_toArrayBuffer","globals","isWorker","importScripts","version","nodeVersion","parseFloat","forEach","visitor","return","arrayBuffers","concatenateStringsAsync","strings","binaryData","pathPrefix","fileAliases","setPathPrefix","getPathPrefix","addAliases","aliases","alias","replacement","getCWD","_window$location","cwd","pathname","location","lastIndexOf","slashIndex","substr","parts","separator","part","index","RegExp","paths","_i","resolvedPath","resolvedAbsolute","charCodeAt","SLASH","normalizeStringPosix","DOT","allowAboveRoot","res","lastSlash","dots","code","isAboveRoot","start","j","WorkerFarm","getWorkerURL","isSupported","parseOnMainThread","workerFarm","getWorkerFarm","workerPool","getWorkerPool","job","startJob","onMessage","postMessage","input","payload","isMobile","orientation","DEFAULT_VERSION","Worker","terminate","NodeWorker","NodeWorkerType","parentPort","NPM_TAG","getWorkerName","warning","workerOptions","workerFile","workerUrl","module","versionTag","coreVersion","workerVersion","parseVersion","split","major","minor","WorkerPool","WorkerThread","DEFAULT_PROPS","onDebug","props","_workerFarm","setProps","Map","workerPools","destroy","values","_getWorkerPoolProps","source","WorkerJob","jobName","workerThread","reject","_resolve","_reject","isRunning","idleQueue","isDestroyed","onError","startPromise","onStart","jobQueue","_startQueuedJob","_getAvailableWorker","queuedJob","backlog","returnWorkerToQueue","shouldDestroyWorker","count","_getMaxConcurrency","getLoadableWorkerURL","getTransferList","NOOP","_createBrowserWorker","_createNodeWorker","terminated","transferList","_getErrorFromErrorEvent","lineno","colno","_loadableURL","onmessage","onerror","onmessageerror","absolute","eval","on","workerURLCache","workerURL","getLoadableWorkerURLFromURL","getLoadableWorkerURLFromSource","workerSource","buildScriptSource","URL","createObjectURL","recursive","transfers","transfersSet","Set","isTransferable","add","MessagePort","ImageBitmap","OffscreenCanvas","getTransferListForWriter","clone","keys","uid","DRAW_MODE","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN","Geometry","drawMode","attributes","indices","vertexCount","_setAttributes","_calculateVertexCount","getVertexCount","getAttributes","_print","attributeName","attribute","isIndexed","Infinity","constant","Buffer","GLTF_TO_LUMA_ATTRIBUTE_MAP","POSITION","NORMAL","COLOR_0","TEXCOORD_0","TEXCOORD_1","TEXCOORD_2","getBuffersFromGeometry","gl","geometry","buffers","remappedName","mapAttributeName","accessor","inferAttributeAccessor","Uint16Array","Uint32Array","attributeMap","category","isWebGL","ProgramManager","Program","VertexArray","clear","TransformFeedback","isObjectEmpty","getDebugTableForUniforms","getDebugTableForVertexArray","getDebugTableForProgramConfiguration","LOG_DRAW_PRIORITY","LOG_DRAW_TIMEOUT","ERR_MODEL_PARAMS","DRAW_PARAMS","Model","lastLogTime","animated","initialize","programManager","getDefaultProgramManager","_programManagerState","_managedProgram","program","vs","fs","modules","defines","inject","varyings","bufferMode","transpileToGLSL100","programProps","vertexArray","_programDirty","needsRedraw","_attributes","uniforms","pickable","_checkProgram","setUniforms","getModuleUniforms","moduleSettings","geometryBuffers","isInstanced","instanced","instanceCount","_setModelProps","delete","release","_deleteGeometryBuffers","getDrawMode","getInstanceCount","getProgram","setProgram","getUniforms","setDrawMode","setVertexCount","setInstanceCount","setGeometry","setAttributes","normalizedAttributes","getValue","updateModuleSettings","draw","framebuffer","transformFeedback","parameters","logPriority","_logDrawCallStart","drawParams","getDrawParams","indexType","indexOffset","vertexArrayInstanced","onBeforeRender","onAfterRender","didDraw","_logDrawCallEnd","transform","discard","feedbackBuffers","unbindModels","_setFeedbackBuffers","model","unbindBuffers","bindBuffers","render","_feedbackBuffers","needsUpdate","stateHash","_setAnimationProps","animationProps","setBuffers","logDrawTimeout","attributeTable","header","uniformTable","unusedTable","unusedCount","missingTable","missingCount","undefinedOnly","configTable","assembleShaders","luma","defaultProgramManager","_programCache","_getUniforms","_registeredModules","_hookFunctions","_defaultModules","_hashes","_hashCounter","_useCounts","addDefaultModule","m","removeDefaultModule","moduleName","filter","addShaderHook","hook","_getModuleList","vsHash","_getHash","fsHash","moduleHashes","sort","varyingHashes","defineKeys","injectKeys","defineHashes","injectHashes","hash","assembled","hookFunctions","appModules","seen","len","getIsBrowser","trackContextState","getDevicePixelRatio","isWebGL2","isPage","CONTEXT_DEFAULTS","webgl2","webgl1","throwOnError","manageState","canvas","createGLContext","targetCanvas","getCanvas","createBrowserContext","instrumentGLContext","logInfo","_instrumented","_version","getVersion","canvasSizeInfo","copyState","makeDebugContext","getContextDebugInfo","vendorMasked","getParameter","rendererMasked","ext","getExtension","vendorUnmasked","UNMASKED_VENDOR_WEBGL","rendererUnmasked","UNMASKED_RENDERER_WEBGL","vendor","renderer","shadingLanguageVersion","resizeGLContext","devicePixelRatio","useDevicePixels","setDevicePixelRatio","resize","errorMessage","onCreateError","statusMessage","addEventListener","getContext","removeEventListener","onContextLost","onContextRestored","isPageLoaded","readyState","getElementById","createElement","insertBefore","firstChild","webGL","driver","WebGL2RenderingContext","clientWidth","clientHeight","cachedSize","clampedPixelRatio","canvasWidth","canvasHeight","drawingBufferWidth","drawingBufferHeight","getWebGL2Context","assertWebGLContext","assertWebGL2Context","polyfillContext","getParameters","setParameters","resetParameters","withParameters","pushContextState","popContextState","cssToDeviceRatio","cssToDevicePixels","OES_element_index","WEBGL_draw_buffers","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","WEBGL_debug_renderer_info","GL_FRAGMENT_SHADER_DERIVATIVE_HINT","GL_DONT_CARE","GL_GPU_DISJOINT_EXT","GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT","GL_UNMASKED_VENDOR_WEBGL","GL_UNMASKED_RENDERER_WEBGL","getWebGL2ValueOrZero","WEBGL_PARAMETERS","GPU_DISJOINT_EXT","MAX_TEXTURE_MAX_ANISOTROPY_EXT","MAX_COLOR_ATTACHMENTS_WEBGL","MAX_DRAW_BUFFERS_WEBGL","getParameterPolyfill","originalGetParameter","pname","polyfillVertexArrayObject","WEBGL2_CONTEXT_POLYFILLS","WEBGL2_CONTEXT_OVERRIDES","polyfilled","initializeExtensions","installPolyfills","installOverrides","target2","EXTENSIONS","getSupportedExtensions","originalFunc","polyfill","polyfills","polyfillExtension","defaults","meta","suffix","extKey","OES_vertex_array_object","ANGLE_instanced_arrays","ERR_VAO_NOT_SUPPORTED","getExtensionData","createVertexArray","deleteVertexArray","bindVertexArray","isVertexArray","vertexAttribDivisor","divisor","drawElementsInstanced","drawArraysInstanced","drawBuffers","createQuery","deleteQuery","beginQuery","endQuery","getQuery","handle","getQueryObject","getQueryParameter","readBuffer","attachment","getVertexAttrib","getProgramParameter","getInternalformatParameter","format","Int32Array","getTexParameter","TEXTURE_MAX_ANISOTROPY_EXT","hint","glErrorShadow","msg","synthesizeGLError","err","opt_msg","wrapGLError","f","getError","apply","parseInt","WebGLVertexArrayObjectOES","isAlive","hasBeenBound","elementArrayBuffer","attribs","maxVertexAttribs","n","attrib","VertexAttrib","maxAttrib","normalized","stride","cached","recache","prototype","OESVertexArrayObject","original","enableVertexAttribArray","disableVertexAttribArray","bindBuffer","vertexAttribPointer","VERTEX_ARRAY_BINDING_OES","currentVertexArrayObject","defaultVertexArrayObject","vao","currentArrayBuffer","indx","instrumentExtension","reset_","contextWasLost","vertexArrayObjects","ii","bindVertexArrayOES","createVertexArrayOES","arrayObject","deleteVertexArrayOES","splice","isVertexArrayOES","oldVAO","newVAO","call","currentBinding","oldAttrib","bufferChanged","original_getSupportedExtensions","list","original_getExtension","__OESVertexArrayObject","GL_PARAMETER_DEFAULTS","GL_HOOKED_SETTERS","deepArrayEqual","installGetterOverride","functionName","originalGetterFunc","configurable","installSetterSpy","setter","originalSetterFunc","params","valueChanged","oldValue","_updateCache","installProgramSpy","originalUseProgram","useProgram","useProgramLuma","GLState","stateStack","pop","oldValues","GL_PARAMETER_SETTERS","GL_COMPOSITE_PARAMETER_SETTERS","GL_PARAMETER_GETTERS","compositeSetters","glConstant","compositeSetter","getter","parameterKeys","nocatch","Float32Array","disable","pixelStorei","drawFramebuffer","bindFramebuffer","readFramebuffer","blendColor","clearColor","colorMask","cullFace","clearDepth","depthFunc","depthRange","depthMask","frontFace","lineWidth","scissor","clearStencil","stencilMaskSeparate","viewport","blend","blendEquation","blendEquationSeparate","blendFunc","blendFuncSeparate","cull","depthTest","dither","derivativeHint","mipmapHint","polygonOffsetFill","polygonOffset","sampleCoverage","scissorTest","stencilTest","stencilMask","mask","backMask","stencilFunc","ref","backFunc","backRef","stencilFuncSeparate","stencilOp","sfail","dpfail","dppass","backSfail","backDpfail","backDppass","stencilOpSeparate","glEnum","stencilFuncFront","stencilFuncBack","stencilOpFront","stencilOpBack","update","capability","r","g","b","a","modeRGB","modeAlpha","dst","srcRGB","dstRGB","srcAlpha","dstAlpha","depth","s","zNear","zFar","face","factor","units","invert","y","fail","zfail","zpass","cssPixel","yInvert","ratio","scalePixels","windowRatio","pixel","scaleX","scaleY","t","xHigh","yHigh","round","isArrayX","isArrayY","ERR_CONTEXT","ERR_WEBGL","ERR_WEBGL2","WebGLRenderingContext","VERTEX_SHADER","FRAGMENT_SHADER","resolveModules","getPlatformShaderDefines","getVersionDefines","injectShader","DECLARATION_INJECT_MARKER","transpileShader","INJECT_SHADER_DECLARATIONS","SHADER_TYPE","FRAGMENT_SHADER_PROLOGUE","assembleShader","assembleGetUniforms","prologue","isVertex","sourceLines","glslVersion","versionLine","coreSource","allDefines","getDefines","assembledSource","getShaderName","getShaderType","getApplicationDefines","hookFunctionMap","normalizeHookFunctions","hookInjections","declInjections","mainInjections","injection","order","checkDeprecations","moduleSource","getModuleSource","injections","injectionType","getHookFunctions","moduleUniforms","injectShaderName","sourceText","define","hookName","hookFunction","signature","footer","trim","stage","TYPE_DEFINITIONS","number","validate","propType","parsePropTypes","propDefs","propTypes","propName","propDef","parsePropType","getTypeOf","MODULE_INJECTORS_VS","MODULE_INJECTORS_FS","MODULE_INJECTORS","REGEX_START_OF_MAIN","REGEX_END_OF_MAIN","fragments","injectStandardStubs","fragmentData","fragmentString","combineInjects","injects","getContextInfo","hasFeatures","canCompileGLGSExtension","FEATURES","debugInfo","gpuVendor","isFragment","versionDefines","GLSL_FRAG_DEPTH","GLSL_DERIVATIVES","GLSL_FRAG_DATA","behavior","GLSL_TEXTURE_LOD","ShaderModule","getShaderDependencies","instantiateModules","moduleMap","moduleDepth","getDependencyGraph","dependencies","TEST_EXPORTS","deprecations","vertexShader","fragmentShader","_parseDeprecationDefinitions","normalizeInjections","_defaultGetUniforms","shaderSource","def","regex","old","new","private","normalizeShaderModule","shaderModule","testVariable","qualifier","ES300_REPLACEMENTS","ES300_VERTEX_REPLACEMENTS","ES300_FRAGMENT_REPLACEMENTS","ES100_REPLACEMENTS","ES100_VERTEX_REPLACEMENTS","ES100_FRAGMENT_REPLACEMENTS","ES100_FRAGMENT_OUTPUT_NAME","ES300_FRAGMENT_OUTPUT_REGEX","targetGLSLVersion","convertShader","convertFragmentShaderTo300","convertFragmentShaderTo100","replacements","pattern","outputMatch","outputName","isOldIE","isMSIE","isTrident","GL_VENDOR","GL_RENDERER","GL_VERSION","GL_SHADING_LANGUAGE_VERSION","WEBGL_FEATURES","identifyGPUVendor","gpuInfo","compiledGlslExtensions","cap","feature","extensionName","shader","createShader","compileShader","canCompile","getShaderParameter","deleteShader","getFeature","features","every","getTypedArrayFromGLType","checkProps","DEFAULT_ACCESSOR_VALUES","integer","PROP_CHECKS","deprecatedProps","Accessor","getBytesPerElement","ArrayType","BYTES_PER_ELEMENT","getBytesPerVertex","accessors","_assign","freeze","toString","BYTES_PER_VERTEX","Resource","getGLTypeFromTypedArray","DEBUG_DATA_LENGTH","DEPRECATED_PROPS","PROP_CHECKS_INITIALIZE","removedProps","replacedProps","PROP_CHECKS_SET_PROPS","toStringTag","stubRemovedMethods","getElementCount","usage","debugData","setAccessor","_setData","_setByteLength","reallocate","bytesUsed","setData","subData","srcOffset","bufferSubData","_inferType","copyData","sourceBuffer","readOffset","writeOffset","copyBufferSubData","getData","dstData","srcByteOffset","dstOffset","clamped","sourceAvailableElementCount","_getAvailableElementCount","dstElementOffset","dstAvailableElementCount","dstElementCount","copyElementCount","getBufferSubData","bindBufferRange","bindBufferBase","unbind","isIndexedBuffer","getDebugData","changed","invalidateDebugData","_trackDeallocatedMemory","_getTarget","bufferData","_trackAllocatedMemory","sourceElementOffset","_createHandle","createBuffer","_deleteHandle","deleteBuffer","_getParameter","getBufferParameter","setByteLength","updateAccessor","GL_DEPTH_BUFFER_BIT","GL_STENCIL_BUFFER_BIT","GL_COLOR_BUFFER_BIT","GL_COLOR","GL_DEPTH","GL_STENCIL","GL_DEPTH_STENCIL","ERR_ARGUMENTS","stencil","clearFlags","clearBuffer","drawBuffer","clearBufferiv","clearBufferuiv","clearBufferfv","clearBufferfi","Framebuffer","Texture","flipRows","glFormatToComponents","glTypeToBytes","toFramebuffer","readPixelsToArray","sourceX","sourceY","sourceFormat","sourceAttachment","sourceWidth","sourceHeight","sourceType","deleteFramebuffer","getFramebuffer","attachments","getPixelArray","prevHandle","readPixels","readPixelsToBuffer","targetByteOffset","gl2","components","byteCount","copyToDataUrl","targetMaxHeight","MAX_SAFE_INTEGER","imageData","createImageData","putImageData","copyToImage","targetImage","dataUrl","copyToTexture","targetMipmaplevel","targetInternalFormat","targetX","targetY","targetZ","isSubCopy","texture","copyTexImage2D","copyTexSubImage2D","copyTexSubImage3D","blit","sourceX0","sourceY0","targetX0","targetY0","sourceX1","sourceY1","targetX1","targetY1","srcFramebuffer","deleteSrcFramebuffer","dstFramebuffer","deleteDstFramebuffer","prevDrawHandle","prevReadHandle","blitFramebuffer","pixelArray","Texture2D","Renderbuffer","getFeatures","getKey","ERR_MULTIPLE_RENDERTARGETS","colorBufferFloat","colorBufferHalfFloat","supported","getDefaultFramebuffer","defaultFramebuffer","MAX_COLOR_ATTACHMENTS","MAX_DRAW_BUFFERS","ownResources","check","_createDefaultAttachments","clearAttachments","checkStatus","resizeAttachments","attach","_setReadBuffer","_setDrawBuffers","attachmentPoint","newAttachments","descriptor","_unattach","_attachRenderbuffer","renderbuffer","layer","_attachTexture","getStatus","_getFrameBufferStatus","checkFramebufferStatus","invalidate","invalidateAll","invalidateFramebuffer","getAttachmentParameter","_getAttachmentParameterFallback","getFramebufferAttachmentParameter","getAttachmentParameters","ATTACHMENT_PARAMETERS","attachmentName","show","open","defaultAttachments","pixels","mipmaps","oldAttachment","framebufferRenderbuffer","framebufferTexture2D","bindTexture","framebufferTextureLayer","mapIndexToCubeMapFace","drawBuffersWEBGL","caps","WEBGL2","EXT_sRGB","createFramebuffer","_bindHandle","STATUS","FRAMEBUFFER_ATTACHMENT_PARAMETERS","decomposeCompositeGLType","ProgramConfiguration","attributeInfos","attributeInfosByName","attributeInfosByLocation","varyingInfos","varyingInfosByName","_readAttributesFromProgram","_readVaryingsFromProgram","getAttributeInfo","locationOrName","getAttributeLocation","attributeInfo","getAttributeAccessor","getVaryingInfo","getVaryingIndex","varying","getVaryingAccessor","getActiveAttrib","getAttribLocation","_addAttribute","getTransformFeedbackVarying","_addVarying","compositeType","_inferProperties","parseUniformName","getUniformSetter","VertexShader","FragmentShader","copyUniform","checkUniformValues","getPrimitiveDrawMode","LOG_PROGRAM_PERF_PRIORITY","GL_SEPARATE_ATTRIBS","V6_DEPRECATED_METHODS","_isCached","_setId","_textureUniforms","transformFeedbackVaryings","_compileAndLink","_readUniformLocationsFromLinkedProgram","samplers","fb","_areTexturesRenderable","bindForDraw","primitiveMode","begin","_bindTextures","isNaN","drawRangeElements","drawElements","drawArrays","_uniformSetters","uniformName","uniform","uniformSetter","textureUpdate","textureIndex","_textureIndexCounter","texturesRenderable","loaded","createProgram","deleteProgram","_getOptionsFromHandle","shaderHandles","getAttachedShaders","shaderHandle","programName","_getName","getName","attachShader","linkProgram","linked","getProgramInfoLog","validateProgram","validated","_uniformCount","getActiveUniform","getUniformLocation","l","getActiveUniforms","uniformIndices","getUniformBlockIndex","blockName","getActiveUniformBlockParameter","blockIndex","uniformBlockBinding","blockBinding","EXT_FLOAT_WEBGL2","bpp","RENDERBUFFER_FORMATS","isFormatSupported","formats","gl1","getSamplesForFormat","samples","bindRenderbuffer","renderbufferStorageMultisample","renderbufferStorage","createRenderbuffer","deleteRenderbuffer","_syncHandle","getRenderbufferParameter","lumaStats","getKeyValue","ERR_RESOURCE_METHOD_UNDEFINED","_bound","_handle","_addStats","deleteChildren","children","_removeStats","child","funcOrHandle","PARAMETERS","parameter","isWebgl2","parameterAvailable","webgl1Default","webgl2Default","defaultValue","setParameter","_setParameter","className","methodNames","_getOptsFromHandle","_context","stats","incrementCount","decrementCount","_trackAllocatedMemoryForContext","addCount","_trackDeallocatedMemoryForContext","subtractCount","parseGLSLCompilerError","ERR_SOURCE","Shader","getTypeName","shaderType","shaderName","_compile","getSource","getShaderSource","getTranslatedSource","getTranslatedShaderSource","compileStatus","infoLog","getShaderInfoLog","errors","warnings","loadImage","DATA_FORMAT_CHANNELS","TYPE_SIZES","Texture3D","unpackFlipY","setImageData","dataFormat","border","texImage3D","channels","channelSize","FACES","TextureCube","setCubeMapImageData","generateMipmap","subImage","mipmapLevel","_subImage","imageDataMap","resolvedFaces","all","facePixels","lodLevel","texImage2D","setImageDataForFace","resolvedImageData","TEXTURE_FORMATS","types","isLinearFilteringSupported","isPowerOfTwo","NPOT_MIN_FILTERS","WebGLBuffer","linearFiltering","textureUnit","isVideo","HTMLVideoElement","HAVE_METADATA","_video","recreate","pixelStore","compressed","_deduceParameters","activeTexture","_isNPOT","_updateForNPOT","video","lastTime","HAVE_CURRENT_DATA","currentTime","setSubImageData","_getDataType","compressedTextureSize","levelIndex","levelData","compressedTexImage2D","levelSize","ndarray","shape","compressedTexSubImage2D","texSubImage2D","copyFramebuffer","getActiveUnit","textureFormat","_deduceImageSize","ImageData","HTMLImageElement","naturalWidth","naturalHeight","HTMLCanvasElement","videoWidth","videoHeight","createTexture","deleteTexture","param","_getNPOTParam","texParameterf","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","unused","bindOnUse","_unbindBuffers","bufferName","setBuffer","bufferOrParams","_getVaryingIndex","byteSize","_getBufferParams","_bindBuffer","bindTransformFeedback","_bindBuffers","beginTransformFeedback","endTransformFeedback","_getVaryingInfo","bufferIndex","createTransformFeedback","deleteTransformFeedback","UNIFORM_SETTERS","getArraySetter","toFloatArray","setVectorUniform","toIntArray","setMatrixUniform","getSamplerSetter","toUIntArray","FLOAT_ARRAY","INT_ARRAY","UINT_ARRAY","toTypedArray","uniformLength","Type","UNIFORM_NAME_REGEXP","uniformMap","shouldCheck","checkUniformValue","checkUniformArray","dest","checkLength","uniform1i","toArray","cacheLength","arrayValue","getScratchArray","fillArray","getBrowser","ERR_ELEMENTS","VertexArrayObject","constantAttributeZero","getDefaultArray","defaultVertexArray","isDefaultArray","getMaxAttributes","MAX_ATTRIBUTES","setConstant","_setConstantFloatArray","_setConstantIntArray","_setConstantUintArray","bufferValue","setElementBuffer","elementBuffer","vertexAttribIPointer","disablingAttributeZero","getConstantBuffer","elementCount","constantValue","_normalizeConstantArrayValue","updateNeeded","_compareConstantArrayValues","v1","v2","vertexAttrib1fv","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttribI1iv","vertexAttribI2iv","vertexAttribI3iv","vertexAttribI4iv","vertexAttribI1uiv","vertexAttribI2uiv","vertexAttribI3uiv","vertexAttribI4uiv","elements","getVertexAttribOffset","ERR_ATTRIBUTE_TYPE","MULTI_LOCATION_ATTRIBUTE_REGEXP","DEPRECATIONS_V6","elementsAccessor","vertexArrayObject","reset","fill","clearDrawParams","_updateDrawParams","_setAttribute","appAccessor","_resolveLocationAndAccessor","_setConstantAttributes","valueAccessor","INVALID_RESULT","_getAttributeIndex","accessInfo","_getAttributeInfo","currentAccessor","multiLocation","locationOffset","_setConstantAttributeZero","_setConstantAttribute","indexCount","_updateDrawParamsForLocation","setElements","getCompositeGLType","glslDeclaration","getGLSLDeclaration","varyingInfo","typeAndName","SHADER_MODULE_UNIFORM_REGEXP","PROJECT_MODULE_UNIFORM_REGEXP","uniformLocations","uniformNames","addUniformToTable","isDefined","isUniformDefined","ELEMENT_ARRAY_BUFFER","getDebugTableRow","attributeLocation","rowHeader","verts","marker","LOG_UNSUPPORTED_FEATURE","hasFeature","isFeatureSupported","queryFeature","featureDefinition","VERTEX_ARRAY_OBJECT","TIMER_QUERY","INSTANCED_RENDERING","MULTIPLE_RENDER_TARGETS","ELEMENT_INDEX_UINT32","BLEND_EQUATION_MINMAX","FLOAT_BLEND","COLOR_ENCODING_SRGB","TEXTURE_DEPTH","TEXTURE_FLOAT","TEXTURE_HALF_FLOAT","TEXTURE_FILTER_LINEAR_FLOAT","TEXTURE_FILTER_LINEAR_HALF_FLOAT","TEXTURE_FILTER_ANISOTROPIC","COLOR_ATTACHMENT_RGBA32F","COLOR_ATTACHMENT_FLOAT","COLOR_ATTACHMENT_HALF_FLOAT","checkFloat32ColorAttachment","testTexture","testFb","getShaderTypeName","formatGLSLCompilerError","errLog","errorStrings","shaderDescription","errorString","segments","line","lines","addLineNumbers","formatErrors","column","substring","padLeft","delim","maxDigits","lineNumber","digits","defaultName","SHADER_NAME_REGEXP","GL_FRAGMENT_SHADER","GL_VERTEX_SHADER","Stats","STARTUP_MESSAGE","StatsManager","has","nodeIO","getScratchArrayBuffer","scratchArrayBuffer","copied","copyWithin","propChecks","replacementProp","newProps","loadFile","crossOrigin","instance","upgradeMessage","methodName","uidCounters","isEmpty","GL_BYTE","GL_UNSIGNED_BYTE","GL_SHORT","GL_UNSIGNED_SHORT","GL_POINTS","GL_LINES","GL_LINE_LOOP","GL_LINE_STRIP","GL_TRIANGLES","GL_TRIANGLE_STRIP","GL_TRIANGLE_FAN","GL_FLOAT","GL_FLOAT_VEC2","GL_FLOAT_VEC3","GL_FLOAT_VEC4","GL_INT","GL_INT_VEC2","GL_INT_VEC3","GL_INT_VEC4","GL_UNSIGNED_INT","GL_UNSIGNED_INT_VEC2","GL_UNSIGNED_INT_VEC3","GL_UNSIGNED_INT_VEC4","GL_BOOL","GL_BOOL_VEC2","GL_BOOL_VEC3","GL_BOOL_VEC4","GL_FLOAT_MAT2","GL_FLOAT_MAT3","GL_FLOAT_MAT4","GL_FLOAT_MAT2x3","GL_FLOAT_MAT2x4","GL_FLOAT_MAT3x2","GL_FLOAT_MAT3x4","GL_FLOAT_MAT4x2","GL_FLOAT_MAT4x3","COMPOSITE_GL_TYPES","getPrimitiveCount","primitiveCount","compositeGLType","typeAndSize","glType","compType","compComponents","getKeyType","cloneTextureFrom","refTexture","overrides","TextureType","textureOptions","ERR_TYPE_DEDUCTION","arrayOrType","Uint8ClampedArray","Int8Array","Int16Array","bytesPerPixel","temp","bytesPerRow","topOffset","bottomOffset","newWidth","newHeight","newData","c","RADIANS_TO_DEGREES","PI","DEGREES_TO_RADIANS","precision","printTypes","printDegrees","printRowMajor","configure","toRadians","degrees","radians","toDegrees","sin","angle","cos","tan","asin","acos","atan","clamp","lerp","ai","equals","epsilon","oldEpsilon","exactEquals","withEpsilon","oldPrecision","duplicateArray","chrome","safari","mozInnerScreenX","DEFAULT_SETTINGS","default","Stat","_getHiResTimestamp","setSampleSize","sampleSize","_count","_samples","_checkSampling","addTime","_time","lastTiming","timeStart","_startTime","_timerPending","getSampleAverageCount","lastSampleCount","getSampleAverageTime","lastSampleTime","getSampleHz","getAverageCount","getAverageTime","getHz","_initializeStats","_getOrCreate","fn","getTable","stat","average","hz"],"sourceRoot":""}